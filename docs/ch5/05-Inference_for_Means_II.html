<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Pulong Ma">

<title>5&nbsp; Inference for Multiple Mean Vectors – Introduction to Multivariate Data Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../ch6/06-PCA.html" rel="next">
<link href="../ch4/04-Inference_for_Means.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-626149efe8f5d16e1d391ba177679bf0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<script>
  window.MathJax = {
    loader: {
      load: ['[tex]/amsmath', '[tex]/amssymb', '[tex]/amsfonts'],
      '[tex]/color']
    },
    tex: {
      packages: { '[+]': ['amsmath', 'amssymb', 'amsfonts', 'color'] }
    }
  };
</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../custom.css">
<link rel="stylesheet" href="custom.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../ch5/05-Inference_for_Means_II.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Inference for Multiple Mean Vectors</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Introduction to Multivariate Data Analysis</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ch1/01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Multivariate Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ch2/02-graphs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Graphs and Data Visualization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ch3/03-MVN.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Multivariate Normal Distribution</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ch4/04-Inference_for_Means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Inference for Single Mean Vector</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ch5/05-Inference_for_Means_II.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Inference for Multiple Mean Vectors</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ch6/06-PCA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Principal Component Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ch7/07-FactorAnalysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Factor Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ch8/08-MDS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Multidimensional Scaling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ch9/09-ClusterAnalysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Cluster Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ch10/10-DecisionTrees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Decision Trees</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="1">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#two-sample-comparison" id="toc-two-sample-comparison" class="nav-link active" data-scroll-target="#two-sample-comparison"><span class="header-section-number">5.1</span> Two-Sample Comparison</a>
  <ul class="collapse">
  <li><a href="#example-two-soap-manufacturing-processes" id="toc-example-two-soap-manufacturing-processes" class="nav-link" data-scroll-target="#example-two-soap-manufacturing-processes"><span class="header-section-number">5.1.1</span> Example: Two Soap Manufacturing Processes</a></li>
  <li><a href="#state-the-hypotheses" id="toc-state-the-hypotheses" class="nav-link" data-scroll-target="#state-the-hypotheses"><span class="header-section-number">5.1.2</span> State the Hypotheses</a></li>
  <li><a href="#pool-covariance" id="toc-pool-covariance" class="nav-link" data-scroll-target="#pool-covariance"><span class="header-section-number">5.1.3</span> Pool Covariance</a></li>
  <li><a href="#hotellings-t2-statistic" id="toc-hotellings-t2-statistic" class="nav-link" data-scroll-target="#hotellings-t2-statistic"><span class="header-section-number">5.1.4</span> Hotelling’s <span class="math inline">T^2</span> Statistic</a></li>
  <li><a href="#decision" id="toc-decision" class="nav-link" data-scroll-target="#decision"><span class="header-section-number">5.1.5</span> Decision</a></li>
  <li><a href="#confidence-region" id="toc-confidence-region" class="nav-link" data-scroll-target="#confidence-region"><span class="header-section-number">5.1.6</span> Confidence Region</a></li>
  <li><a href="#simultaneous-cis" id="toc-simultaneous-cis" class="nav-link" data-scroll-target="#simultaneous-cis"><span class="header-section-number">5.1.7</span> Simultaneous CIs</a></li>
  <li><a href="#exercise-steel-tube-data" id="toc-exercise-steel-tube-data" class="nav-link" data-scroll-target="#exercise-steel-tube-data"><span class="header-section-number">5.1.8</span> Exercise: Steel Tube Data</a></li>
  </ul></li>
  <li><a href="#comparing-multiple-mean-vectors" id="toc-comparing-multiple-mean-vectors" class="nav-link" data-scroll-target="#comparing-multiple-mean-vectors"><span class="header-section-number">5.2</span> Comparing Multiple Mean Vectors</a>
  <ul class="collapse">
  <li><a href="#example-iris-data" id="toc-example-iris-data" class="nav-link" data-scroll-target="#example-iris-data"><span class="header-section-number">5.2.1</span> Example: Iris Data</a></li>
  <li><a href="#load-and-visualize-the-data" id="toc-load-and-visualize-the-data" class="nav-link" data-scroll-target="#load-and-visualize-the-data"><span class="header-section-number">5.2.2</span> Load and Visualize the Data</a></li>
  <li><a href="#state-the-hypotheses-1" id="toc-state-the-hypotheses-1" class="nav-link" data-scroll-target="#state-the-hypotheses-1"><span class="header-section-number">5.2.3</span> State the Hypotheses</a></li>
  <li><a href="#check-assumptions" id="toc-check-assumptions" class="nav-link" data-scroll-target="#check-assumptions"><span class="header-section-number">5.2.4</span> Check Assumptions</a></li>
  <li><a href="#one-way-manova" id="toc-one-way-manova" class="nav-link" data-scroll-target="#one-way-manova"><span class="header-section-number">5.2.5</span> One-Way MANOVA</a></li>
  <li><a href="#pairwse-comparison" id="toc-pairwse-comparison" class="nav-link" data-scroll-target="#pairwse-comparison"><span class="header-section-number">5.2.6</span> Pairwse Comparison</a></li>
  <li><a href="#exercise-college-student-study" id="toc-exercise-college-student-study" class="nav-link" data-scroll-target="#exercise-college-student-study"><span class="header-section-number">5.2.7</span> Exercise: College Student Study</a></li>
  </ul></li>
  <li><a href="#permulation-test" id="toc-permulation-test" class="nav-link" data-scroll-target="#permulation-test"><span class="header-section-number">5.3</span> Permulation Test</a>
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="header-section-number">5.3.1</span> Introduction</a></li>
  <li><a href="#the-steps-of-a-permutation-test" id="toc-the-steps-of-a-permutation-test" class="nav-link" data-scroll-target="#the-steps-of-a-permutation-test"><span class="header-section-number">5.3.2</span> The Steps of a Permutation Test</a></li>
  <li><a href="#example-two-sample-comparison" id="toc-example-two-sample-comparison" class="nav-link" data-scroll-target="#example-two-sample-comparison"><span class="header-section-number">5.3.3</span> Example: Two-Sample Comparison</a></li>
  <li><a href="#exercise-testing-a-correlation" id="toc-exercise-testing-a-correlation" class="nav-link" data-scroll-target="#exercise-testing-a-correlation"><span class="header-section-number">5.3.4</span> Exercise: Testing a Correlation</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Inference for Multiple Mean Vectors</span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Pulong Ma </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="two-sample-comparison" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="two-sample-comparison"><span class="header-section-number">5.1</span> Two-Sample Comparison</h2>
<p><strong>Data sources and measurements</strong></p>
<ul>
<li><strong>Where the data come from</strong>
<ul>
<li><em>Two independent samples</em>: Select <span class="math inline">n_1</span> units from population 1 and <span class="math inline">n_2</span> units from population 2 (samples are independent; <span class="math inline">n_1</span> and <span class="math inline">n_2</span> may differ).</li>
<li><em>Randomized experiment</em>: Randomly assign <span class="math inline">n_1</span> units to treatment 1 and <span class="math inline">n_2</span> units to treatment 2 (sample sizes need not be equal).</li>
</ul></li>
<li><strong>What we measure</strong><br>
For each unit, record the same set of <span class="math inline">p</span> variables (traits), forming a <span class="math inline">p</span>-dimensional measurement vector.</li>
</ul>
<div class="callout callout-style-default callout-important callout-titled" title="Key Assumptions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Assumptions
</div>
</div>
<div class="callout-body-container callout-body">
<p>The following assumptions are needed to make inferences about the difference between two population mean vectors <span class="math inline">\boldsymbol \mu_1 - \boldsymbol \mu_2</span>:</p>
<ol type="1">
<li><span class="math inline">\mathbf{x}_{1j} \sim N_p(\boldsymbol{\mu}_1, \Sigma_1)</span> independently for <span class="math inline">j=1,\dots,n_1</span>; and <span class="math inline">\mathbf{x}_{2k} \sim N_p(\boldsymbol{\mu}_2, \Sigma_2)</span> independently for <span class="math inline">k=1,\dots,n_2</span>.<br>
</li>
<li><span class="math inline">\Sigma_1=\Sigma_2=\Sigma</span>. (<strong>Homogeneity of Covariance</strong>)</li>
<li><span class="math inline">\mathbf{x}_{1j}</span>’s are independent of <span class="math inline">\mathbf{x}_{2j}</span>’s.</li>
</ol>
</div>
</div>
<section id="example-two-soap-manufacturing-processes" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="example-two-soap-manufacturing-processes"><span class="header-section-number">5.1.1</span> Example: Two Soap Manufacturing Processes</h3>
<p><strong>Background</strong>: A consumer goods company is developing a new method for producing soap. They want to determine whether the new process (Process 2) improves product quality compared to the current standard method (Process 1). Two key performance outcomes are of interest:</p>
<ul>
<li>Lather quality (<span class="math inline">x_1</span>):
<ul>
<li>A measure of how much and how long-lasting the foam is when the soap is used.</li>
<li>Measured on a continuous scale by laboratory technicians using a standardized test.</li>
</ul></li>
<li>Mildness (<span class="math inline">x_2</span>):
<ul>
<li>A subjective measure of how gentle the soap is on skin, evaluated by a panel of trained users.</li>
<li>Also measured on a continuous scale (e.g., skin irritation score, lower is better).</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="Experimental Setup">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Experimental Setup
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Design: A randomized controlled experiment.</li>
<li>Sample sizes:
<ul>
<li><span class="math inline">n_1 = 50</span> soaps produced using the current process (Process 1)</li>
<li><span class="math inline">n_2 = 50</span> soaps produced using the new process (Process 2)</li>
</ul></li>
<li>Measurements:
<ul>
<li>Each bar of soap is tested for both lather and mildness independently.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">=</span> <span class="dv">50</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">=</span> <span class="dv">50</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>xbar1 <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">8.3</span>, <span class="fl">4.1</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>S1 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">6</span>),<span class="at">byrow=</span><span class="cn">TRUE</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>xbar2 <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">10.2</span>, <span class="fl">3.9</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>S2 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>), <span class="at">byrow=</span><span class="cn">TRUE</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Research Questions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Research Questions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Is there evidence that the new process produces soaps with different overall quality, as measured by both lather and mildness?</p></li>
<li><p>If a difference exists, which outcome (lather or mildness) contributes more to that difference?</p></li>
</ul>
</div>
</div>
</section>
<section id="state-the-hypotheses" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="state-the-hypotheses"><span class="header-section-number">5.1.2</span> State the Hypotheses</h3>
<p>Let <span class="math inline">\boldsymbol \mu_1</span> and <span class="math inline">\boldsymbol \mu_2</span> be the population mean vectors for process 1 and process 2, respectively: <span class="math display">\begin{align*}
\boldsymbol \mu_1 = [\text{Mean Leather}_1, \text{Mean Mildness}_1]^\top,\\
\boldsymbol \mu_2 = [\text{Mean Leather}_2, \text{Mean Mildness}_2]^\top.
\end{align*}</span></p>
<div class="callout callout-style-default callout-note callout-titled" title="Hypotheses">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hypotheses
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math display">
H_0: \boldsymbol \mu_1 = \boldsymbol \mu_2 \quad \text{v.s.}\quad H_1: \boldsymbol \mu_1 \neq \boldsymbol \mu_2
</span></p>
</div>
</div>
</div>
</section>
<section id="pool-covariance" class="level3" data-number="5.1.3">
<h3 data-number="5.1.3" class="anchored" data-anchor-id="pool-covariance"><span class="header-section-number">5.1.3</span> Pool Covariance</h3>
<div class="callout callout-style-default callout-note callout-titled" title="Pool Covariance">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Pool Covariance
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Point estimate of <span class="math inline">\boldsymbol \mu_1 - \boldsymbol \mu_2</span> is <span class="math inline">\bar{\mathbf{x}}_1 - \bar{\mathbf{x}}_2</span>.</li>
<li>The population covariance matrix of <span class="math inline">\bar{\mathbf{x}}_1 - \bar{\mathbf{x}}_2</span> is <span class="math display">
\text{Cov}(\bar{\mathbf{x}}_1 - \bar{\mathbf{x}}_2) = \text{Cov}(\bar{\mathbf{x}}_1) + \text{Cov}(\bar{\mathbf{x}}_2) = \frac{1}{n_1}\Sigma + \frac{1}{n_2}\Sigma,
</span></li>
<li>The pooled estimate of the population covariance matrix is <span class="math display">
S_{\text{pool}} = \frac{(n_1 - 1)}{(n_1 + n_2 - 2)} S_1 + \frac{(n_2 - 1)}{(n_1 + n_2 - 2)} S_2
</span></li>
</ul>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>R Code: Pooled Covariance</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Delta <span class="ot">=</span> xbar1 <span class="sc">-</span> xbar2 </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>Sp <span class="ot">=</span> (n1<span class="dv">-1</span>)<span class="sc">/</span>(n1<span class="sc">+</span>n2<span class="dv">-2</span>)<span class="sc">*</span>S1 <span class="sc">+</span> (n2<span class="dv">-1</span>)<span class="sc">/</span>(n1<span class="sc">+</span>n2<span class="dv">-2</span>)<span class="sc">*</span>S2</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Sp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    2    1
[2,]    1    5</code></pre>
</div>
</div>
</section>
<section id="hotellings-t2-statistic" class="level3" data-number="5.1.4">
<h3 data-number="5.1.4" class="anchored" data-anchor-id="hotellings-t2-statistic"><span class="header-section-number">5.1.4</span> Hotelling’s <span class="math inline">T^2</span> Statistic</h3>
<div class="callout callout-style-default callout-note callout-titled" title="Hotelling's $T^2$ Statistic">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hotelling’s <span class="math inline">T^2</span> Statistic
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>The test statistic is the Hotelling’s <span class="math inline">T^2</span> statistic: <span class="math display">
T^2 = (\bar{\mathbf{x}}_1 - \bar{\mathbf{x}}_2 )^\top\left[\left(\frac{1}{n_1} + \frac{1}{n_2}\right) S_{\text{pool}}\right]^{-1}(\bar{\mathbf{x}}_1 - \bar{\mathbf{x}}_2)
</span></p>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>R Code: T2 Statistic</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>T2 <span class="ot">=</span> <span class="fu">drop</span>(<span class="fu">t</span>(Delta) <span class="sc">%*%</span> <span class="fu">solve</span>((<span class="dv">1</span><span class="sc">/</span>n1<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>n2) <span class="sc">*</span> Sp) <span class="sc">%*%</span> Delta)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(T2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 52.47222</code></pre>
</div>
</div>
</section>
<section id="decision" class="level3" data-number="5.1.5">
<h3 data-number="5.1.5" class="anchored" data-anchor-id="decision"><span class="header-section-number">5.1.5</span> Decision</h3>
<div class="callout callout-style-default callout-note callout-titled" title="Decision">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Decision
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>We reject <span class="math inline">H_0: \boldsymbol \mu_1 - \boldsymbol \mu_2 = 0</span> at level <span class="math inline">\alpha</span> using one of the following two approaches:</p>
<ul>
<li><p><strong>Critical Region</strong>: <span class="math inline">T^2 &gt; c^2</span>, where <span class="math display">
c^2:= \frac{(n_1 + n_2 -2)p}{(n_1 + n_2 - p - 1)}F_{(p, n_1 + n_2 -p -1), 1-\alpha}.
</span></p></li>
<li><p><strong>P-value</strong>: The p-value is less than <span class="math inline">\alpha</span>.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>c2 <span class="ot">=</span> (n1<span class="sc">+</span>n2<span class="dv">-2</span>)<span class="sc">*</span>p <span class="sc">/</span> (n1<span class="sc">+</span>n2<span class="sc">-</span>p<span class="dv">-1</span>) <span class="sc">*</span> <span class="fu">qf</span>(<span class="dv">1</span><span class="sc">-</span>alpha, p, n1<span class="sc">+</span>n2<span class="sc">-</span>p<span class="dv">-1</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>p_val <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pf</span>((T2 <span class="sc">*</span> (n1 <span class="sc">+</span> n2 <span class="sc">-</span> p <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">/</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                  (p <span class="sc">*</span> (n1 <span class="sc">+</span> n2 <span class="sc">-</span> <span class="dv">2</span>)), p, n1 <span class="sc">+</span> n2 <span class="sc">-</span> p <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"critical value:"</span>, c2, <span class="st">" with "</span>, <span class="st">"p-value:"</span>, p_val, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>critical value: 6.244089  with  p-value: 9.286081e-10 </code></pre>
</div>
</div>
<p><strong>Interpretation</strong>: Since <span class="math inline">T^2&gt;c^2</span>, we reject <span class="math inline">H_0</span> at <span class="math inline">\alpha=0.05</span> and conclude that the population mean measures on lather and mildness are statistically different, but at this point, we do not know which variable contributes to the difference.</p>
</div>
</div>
</div>
</section>
<section id="confidence-region" class="level3" data-number="5.1.6">
<h3 data-number="5.1.6" class="anchored" data-anchor-id="confidence-region"><span class="header-section-number">5.1.6</span> Confidence Region</h3>
<div class="callout callout-style-default callout-note callout-titled" title="Confidence Region">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Confidence Region
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>A <span class="math inline">100(1-\alpha)\%</span> confidence region for <span class="math inline">\boldsymbol \mu_1 - \boldsymbol \mu_2</span> is given by all values of <span class="math inline">\boldsymbol \mu_1 - \boldsymbol \mu_2</span> that satisfy <span class="math display">
(\bar{\mathbf{x}}_1 - \bar{\mathbf{x}}_2 - (\boldsymbol \mu_1-\boldsymbol \mu_2))'\left[\left(\frac{1}{n_1} + \frac{1}{n_2}\right) S_{\text{pool}}\right]^{-1}(\bar{\mathbf{x}}_1 - \bar{\mathbf{x}}_2 - (\boldsymbol \mu_1-\boldsymbol \mu_2)) \leq c^2.
</span> where <span class="math inline">c^2</span> is defined above.</p>
</div>
</div>
</div>
<ul>
<li>Eigenvalues and eigenvectors of the pooled covariance matrix are</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>R Code: Eigenvalues and Eigenvectors</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>eig_result <span class="ot">=</span> <span class="fu">eigen</span>(Sp)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>lambda1 <span class="ot">=</span> eig_result<span class="sc">$</span>values[<span class="dv">1</span>]</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(eig_result<span class="sc">$</span>values) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"lambda1"</span>, <span class="st">"lambda2"</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Eigen values are </span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(eig_result<span class="sc">$</span>values) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> lambda1  lambda2 
5.302776 1.697224 </code></pre>
</div>
<details class="code-fold">
<summary>R Code: Eigenvalues and Eigenvectors</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Eigenvectors are </span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(eig_result<span class="sc">$</span>vectors) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"eigenvector 1"</span>, <span class="st">"eigenvector 2"</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(eig_result<span class="sc">$</span>vectors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     eigenvector 1 eigenvector 2
[1,]     0.2897841    -0.9570920
[2,]     0.9570920     0.2897841</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>R Code: Axes Lengths</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># semi-major axis and  semi-minor axis: </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>axis<span class="ot">=</span><span class="fu">c</span>(<span class="fu">sqrt</span>(eig_result<span class="sc">$</span>values[<span class="dv">1</span>]) <span class="sc">*</span> <span class="fu">sqrt</span>((<span class="dv">1</span><span class="sc">/</span>n1<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>n2)<span class="sc">*</span>c2),</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">sqrt</span>(eig_result<span class="sc">$</span>values[<span class="dv">2</span>]) <span class="sc">*</span> <span class="fu">sqrt</span>((<span class="dv">1</span><span class="sc">/</span>n1<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>n2)<span class="sc">*</span>c2))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(axis) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"axis 1"</span>, <span class="st">"axis 2"</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(axis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   axis 1    axis 2 
1.1508432 0.6510797 </code></pre>
</div>
</div>
<ul>
<li>The 95% confidence ellipse for the difference between two population mean vectors
<ul>
<li>is centered at <span class="math inline">\bar{\mathbf{x}}_1 - \bar{\mathbf{x}}_2</span></li>
<li>extends <span class="math inline">\sqrt{\lambda_1} \sqrt{(1/n_1+1/n_2)c^2} = 1.15</span> and <span class="math inline">\sqrt{\lambda_2} \sqrt{(1/n_1+1/n_2)c^2} = 0.65</span> units in the first eigenvector and second eigenvector directions</li>
</ul></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="05-Inference_for_Means_II_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>95% Confidence Ellipse for Mean Difference</figcaption>
</figure>
</div>
</div>
</div>
<ul>
<li><strong>Interpretation</strong>: Because the origin <span class="math inline">\mathbf{0}</span> is not inside the ellipse, we conclude that the populations of soaps produced by the two processes are centered at different mean vectors. There appears to be no big difference in mildness means for soaps made by the two processes, but soaps made with the second process produce more lather on average.</li>
</ul>
</section>
<section id="simultaneous-cis" class="level3" data-number="5.1.7">
<h3 data-number="5.1.7" class="anchored" data-anchor-id="simultaneous-cis"><span class="header-section-number">5.1.7</span> Simultaneous CIs</h3>
<div class="callout callout-style-default callout-note callout-titled" title="Simultaneous CIs">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Simultaneous CIs
</div>
</div>
<div class="callout-body-container callout-body">
<p>As in one population case, we can obtain simultaneous confidence intervals for any linear combination of the components of <span class="math inline">\boldsymbol \mu_1 - \boldsymbol \mu_2</span>.</p>
<ul>
<li><p>Suppose we are interested in a set of <span class="math inline">p</span> simultaneous confidence intervals: <span class="math display">
\mathbf{a}'_j(\boldsymbol \mu_1 - \boldsymbol \mu_2) =
\begin{bmatrix}
0 &amp; 0 &amp; \cdots &amp; 1 &amp; \cdots &amp; 0
\end{bmatrix}
\begin{bmatrix}
\mu_{11} - \mu_{21} \\
\mu_{12} - \mu_{22} \\
\vdots \\
\mu_{1p} - \mu_{2p}
\end{bmatrix} = \mu_{1j} - \mu_{2j}
</span> where the vector <span class="math inline">\mathbf{a}_j</span> has zeros everywhere except for the one in the <span class="math inline">j</span>th position.</p></li>
<li><p>Typically, we would be interested in <span class="math inline">m</span> such comparisons.</p></li>
</ul>
<p><strong>Simultaneous <span class="math inline">T^2</span> CIs for <span class="math inline">\mu_{1j} - \mu_{2j}</span>:</strong></p>
<p><span class="math display">
(\bar{x}_{1j} - \bar{x}_{2j}) \pm
\sqrt{
\frac{(n_1 + n_2 - 2)p}{n_1 + n_2 - p - 1} \cdot F_{p,\; n_1 + n_2 - p - 1;\; 1 - \alpha}
}
\cdot
\sqrt{
\left( \frac{1}{n_1} + \frac{1}{n_2} \right) \cdot S_{\text{pool},\, jj}
}
</span> * This interval will simultaneously cover the true values of <span class="math inline">\mu_{1j} - \mu_{2j}</span> with confidence at least <span class="math inline">(1-\alpha)\times 100\%</span>.</p>
<p><strong>Simultaneous Bonferroni CIs for <span class="math inline">\mu_{1j} - \mu_{2j}</span>:</strong> <span class="math display">
(\bar{x}_{1j} - \bar{x}_{2j}) \pm t_{(n_1 + n_2 -2), 1-\alpha/(2m)} \sqrt{\left(\frac{1}{n_1} + \frac{1}{n_2}\right) S_{\text{pool}, jj}}
</span></p>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>R Code: T2 CIs</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>se_j <span class="ot">=</span> <span class="fu">sqrt</span>((<span class="dv">1</span><span class="sc">/</span>n1<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>n2)<span class="sc">*</span> <span class="fu">diag</span>(Sp))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># T2 CIs</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>cval_T2 <span class="ot">=</span> <span class="fu">sqrt</span>(c2)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Bonferroni CIs</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">2</span> <span class="co"># only two variables</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>cval_Bon <span class="ot">=</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>m), n1<span class="sc">+</span>n2<span class="dv">-2</span>) </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>ci_T2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Component =</span> <span class="fu">c</span>(<span class="st">"Lather"</span>, <span class="st">"Mildness"</span>),</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> Delta,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">HalfWidth =</span> cval_T2 <span class="sc">*</span> se_j,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lower =</span> Estimate <span class="sc">-</span> HalfWidth,</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Upper =</span> Estimate <span class="sc">+</span> HalfWidth</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ci_T2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  Component Estimate HalfWidth  Lower Upper
  &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 Lather      -1.90      0.707 -2.61  -1.19
2 Mildness     0.200     1.12  -0.918  1.32</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>R Code: Bonferroni CIs</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>ci_Bon <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Component =</span> <span class="fu">c</span>(<span class="st">"Lather"</span>, <span class="st">"Mildness"</span>),</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> Delta,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">HalfWidth =</span> cval_Bon <span class="sc">*</span> se_j,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lower =</span> Estimate <span class="sc">-</span> HalfWidth,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Upper =</span> Estimate <span class="sc">+</span> HalfWidth</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ci_Bon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  Component Estimate HalfWidth  Lower Upper
  &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 Lather      -1.90      0.644 -2.54  -1.26
2 Mildness     0.200     1.02  -0.818  1.22</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="05-Inference_for_Means_II_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>95% Confidence Ellipse with <span class="math inline">T^2</span> and Bonferroni CIs. Blue dashed line indicates the limits of <span class="math inline">T^2</span> CIs and darkgree dotted line indicates the limits of Bonferroni CIs.</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation</strong>: Based on simultaneous T2 CIs and Bonferroni CIs, the results confirm previous finding based on confidence ellipse that there appears to be no big difference in mildness means for soaps made by the two processes, but soaps made with the second process produce more lather on average. We also note that T2 CIs are wider than Bonferrorni CIs.</p>
<div class="callout callout-style-default callout-warning callout-titled" title="One-At-a-Time CI">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
One-At-a-Time CI
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Using the univariate approach, we can construct <span class="math inline">t</span>-intervals for each of mean differences, and obtain the so-called <strong><em>one-at-a-time</em></strong> <span class="math inline">t</span> intervals <span class="math display">
(\bar{x}_{1j} - \bar{x}_{2j}) \pm t_{(n_1 + n_2 -2), 1-\alpha/2} \sqrt{\left(\frac{1}{n_1} + \frac{1}{n_2}\right) S_{\text{pool}, jj}}.
</span> The one-at-a-time CI does not control the family-wise error at <span class="math inline">\alpha=0.05</span>. As shown previously, the key difference between the Bonferroni CI and the one-at-a-time CI is that Bonferroni CI controls the family-wise error by assigning <span class="math inline">\alpha/m</span> level to each interval when there are <span class="math inline">m</span> comparisons.</p>
</div>
</div>
</div>
</section>
<section id="exercise-steel-tube-data" class="level3" data-number="5.1.8">
<h3 data-number="5.1.8" class="anchored" data-anchor-id="exercise-steel-tube-data"><span class="header-section-number">5.1.8</span> Exercise: Steel Tube Data</h3>
<div class="callout callout-style-default callout-note callout-titled" title="Steel Tube Data">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Steel Tube Data
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Background</strong>: In steel manufacturing, the rolling temperature — the temperature at which steel is shaped into tubes — can affect the material’s strength profile. To study this, engineers measured the breaking strength (yield point (ksi)) and ultimate strength (ksi) of steel tubes produced at two different rolling temperatures, where 5 samples of steel are tested with low rolling temperature independently and 7 samples of steel are tested with high rolling temperature. The objective is to determine whether changing the rolling temperature results in a change in the strength profile (i.e., yield point and ultimate strength). Based on the following data, please solve the following problems:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>steel <span class="ot">=</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"steel.csv"</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">temp =</span> <span class="fu">as.factor</span>(temp))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">dim</span>(steel[steel<span class="sc">$</span>temp<span class="sc">==</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>])[<span class="dv">1</span>]</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">dim</span>(steel[steel<span class="sc">$</span>temp<span class="sc">==</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>])[<span class="dv">1</span>]</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">dim</span>(steel[steel<span class="sc">$</span>temp<span class="sc">==</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>])[<span class="dv">2</span>]</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(steel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["temp"],"name":[1],"type":["fct"],"align":["left"]},{"label":["yield"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["strength"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"33","3":"60"},{"1":"1","2":"36","3":"61"},{"1":"1","2":"35","3":"64"},{"1":"1","2":"38","3":"63"},{"1":"1","2":"40","3":"65"},{"1":"2","2":"35","3":"57"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</div>
<ul>
<li><strong>Step 1. Data visualization</strong></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>R Code: Long Format via <code>pivot_longer</code></summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">=</span> steel <span class="sc">%&gt;%</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>), </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to=</span><span class="st">"var"</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["temp"],"name":[1],"type":["fct"],"align":["left"]},{"label":["var"],"name":[2],"type":["chr"],"align":["left"]},{"label":["value"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"yield","3":"33"},{"1":"1","2":"strength","3":"60"},{"1":"1","2":"yield","3":"36"},{"1":"1","2":"strength","3":"61"},{"1":"1","2":"yield","3":"35"},{"1":"1","2":"strength","3":"64"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>R Code: One variable + multiple groups</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_long, <span class="fu">aes</span>(<span class="at">x=</span>temp, <span class="at">y=</span>value)) <span class="sc">+</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>var, <span class="at">nrow=</span><span class="dv">1</span>, </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales=</span><span class="st">"free_y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05-Inference_for_Means_II_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>R Code: One group + multiple variables</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(steel) <span class="sc">+</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>yield, <span class="at">y=</span>strength, <span class="at">col=</span>temp)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05-Inference_for_Means_II_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong><em>Question: What do the plots tell you?</em></strong></p>
<ul>
<li><strong>Step 2. State the research question(s) and define the null and alternative hypotheses using standard notations.</strong></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="View Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The research questions for this data can be stated as follows:</p>
<ul>
<li>Does the change in rolling temperature result in the change in strength profile of the steel - that is, does it affect either or both of yield point and ultimate strength?</li>
<li>If it does affect, which variable is more sensitive to the change in rolling temperature?</li>
</ul>
<p>Based on the research questions, our objectives are to examine the data and test the null hypothesis that the vectors of means for yield point and ultimate strength are the same for the two rolling temperatures used to produce this type of steel.</p>
<ul>
<li>Let <span class="math inline">x_1</span> denote the yield point and <span class="math inline">x_2</span> denote the ultimate strength.</li>
<li>Let <span class="math inline">\mathbf{x}_{1j}: =[x_{1j}, x_{2j}]^\top</span> denote the measured yield point and ultimate strength under low rolling temperature for <span class="math inline">j=1,\ldots, n_1</span>; and <span class="math inline">\mathbf{x}_{2j}: =[x_{1j}, x_{2j}]^\top</span> under high rolling temperature for <span class="math inline">j=1,\ldots, n_2</span>.</li>
<li>Let <span class="math inline">\boldsymbol \mu_1, \boldsymbol \mu_2</span> be the population mean vectors of yield point and ultimate strength under low and high rolling temperature respectively: <span class="math display">
\boldsymbol \mu_1: =[
\text{Mean Yield}_1, \text{Mean Strength}_1]^\top, \quad
\boldsymbol \mu_2: =[
\text{Mean Yield}_2, \text{Mean Strength}_2]^\top
</span> or more precisely, <span class="math inline">\boldsymbol \mu_1 = E(\mathbf{x}_{1j})</span> and <span class="math inline">\boldsymbol \mu_2 = E(\mathbf{x}_{2j})</span>.</li>
</ul>
<p>The null and alternative hypothesese are given as follows <span class="math display">
H_0: \boldsymbol \mu_1 = \boldsymbol \mu_2 \quad \text{v.s.}\quad
H_1: \boldsymbol \mu_1 \neq \boldsymbol \mu_2
</span></p>
</div>
</div>
</div>
<ul>
<li><strong>Step 3. Perform the statistical test.</strong></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="View Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Step 3(a): Compute summary statistics</strong></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Compute sample mean vector and sample</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">xbar1 =</span> <span class="fu">sapply</span>(steel[steel<span class="sc">$</span>temp<span class="sc">==</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>], mean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   yield strength 
    36.4     62.6 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  covariance matrix for each temperature</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">xvar1 =</span> <span class="fu">var</span>(steel[steel<span class="sc">$</span>temp<span class="sc">==</span><span class="dv">1</span> , <span class="sc">-</span><span class="dv">1</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         yield strength
yield      7.3      4.2
strength   4.2      4.3</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Compute sample mean vector and sample</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">xbar2 =</span> <span class="fu">sapply</span>(steel[steel<span class="sc">$</span>temp<span class="sc">==</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>], mean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   yield strength 
39.00000 60.42857 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  covariance matrix for each temperature</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">xvar2 =</span> <span class="fu">var</span>(steel[steel<span class="sc">$</span>temp<span class="sc">==</span><span class="dv">2</span> , <span class="sc">-</span><span class="dv">1</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            yield strength
yield    8.333333 6.666667
strength 6.666667 7.619048</code></pre>
</div>
</div>
<ul>
<li><strong>Step 3(b): Check Normality Assumption</strong></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check univariate normaltiy </span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>p){</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(steel[steel<span class="sc">$</span>temp <span class="sc">==</span> i, <span class="sc">-</span><span class="dv">1</span>], <span class="dv">2</span>, shapiro.test)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co"># check bivariate normaltiy</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>mvShapiroTest<span class="sc">::</span><span class="fu">mvShapiro.Test</span>(<span class="fu">as.matrix</span>(steel[ , <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Generalized Shapiro-Wilk test for Multivariate Normality by
    Villasenor-Alva and Gonzalez-Estrada

data:  as.matrix(steel[, 2:3])
MVW = 0.9584, p-value = 0.8718</code></pre>
</div>
</div>
<ul>
<li><strong>Step 3(c): Check Homogeneity Assumption</strong></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply Box's M-test to test the null hypothesis of homogeneous covariance matrices. </span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>biotools<span class="sc">::</span><span class="fu">boxM</span>(steel[ , <span class="sc">-</span><span class="dv">1</span>], steel<span class="sc">$</span>temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Box's M-test for Homogeneity of Covariance Matrices

data:  steel[, -1]
Chi-Sq (approx.) = 0.38077, df = 3, p-value = 0.9442</code></pre>
</div>
</div>
<ul>
<li><strong>Step 3(d): Two-Sample Hotelling’s <span class="math inline">T^2</span> Test</strong></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>T2result <span class="ot">&lt;-</span> DescTools<span class="sc">::</span><span class="fu">HotellingsT2Test</span>(steel[steel<span class="sc">$</span>temp <span class="sc">==</span> <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>], </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>             steel[steel<span class="sc">$</span>temp <span class="sc">==</span> <span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>T2result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Hotelling's two sample T2-test

data:  steel[steel$temp == 1, -1] and steel[steel$temp == 2, -1]
T.2 = 10.76, df1 = 2, df2 = 9, p-value = 0.004106
alternative hypothesis: true location difference is not equal to c(0,0)</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li><strong>Step 4. Construct the confidence region and interpret the results.</strong></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="View Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sample difference</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>Delta <span class="ot">=</span> xbar1 <span class="sc">-</span> xbar2</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># compute pooled covariance matrix </span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>Sp <span class="ot">&lt;-</span> ((n1<span class="dv">-1</span>)<span class="sc">*</span>xvar1 <span class="sc">+</span>(n2<span class="dv">-1</span>)<span class="sc">*</span>xvar2)<span class="sc">/</span>(n1<span class="sc">+</span>n2<span class="dv">-2</span>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co"># compute T2 statistic</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>T2 <span class="ot">=</span> <span class="fu">drop</span>(<span class="fu">t</span>(Delta)<span class="sc">%*%</span><span class="fu">solve</span>((<span class="dv">1</span><span class="sc">/</span>n1<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>n2) <span class="sc">*</span> Sp)<span class="sc">%*%</span>Delta)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(T2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 23.91171</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># critical value</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.05</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>c2 <span class="ot">=</span> (n1<span class="sc">+</span>n2<span class="dv">-2</span>)<span class="sc">*</span>p <span class="sc">/</span> (n1<span class="sc">+</span>n2<span class="sc">-</span>p<span class="dv">-1</span>) <span class="sc">*</span> <span class="fu">qf</span>(<span class="dv">1</span><span class="sc">-</span>alpha, p, n1<span class="sc">+</span>n2<span class="sc">-</span>p<span class="dv">-1</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># this is the covariance of Delta </span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>Sigma_ell <span class="ot">&lt;-</span>   (<span class="dv">1</span><span class="sc">/</span>n1 <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n2) <span class="sc">*</span> Sp</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(Sigma_ell)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> eig<span class="sc">$</span>vectors <span class="sc">%*%</span> <span class="fu">diag</span>(<span class="fu">sqrt</span>(eig<span class="sc">$</span>values)) <span class="sc">*</span> <span class="fu">sqrt</span>(c2)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="sc">*</span>pi, <span class="at">length.out =</span> <span class="dv">400</span>)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>pts <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">matrix</span>(Delta, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="fu">length</span>(theta)) <span class="sc">+</span> </span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>           A <span class="sc">%*%</span> <span class="fu">rbind</span>(<span class="fu">cos</span>(theta), <span class="fu">sin</span>(theta)))</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>df_ell <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pts)</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_ell) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Yield"</span>, <span class="st">"Strength"</span>)</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>center <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Yield =</span> Delta[<span class="dv">1</span>], <span class="at">Strength =</span> Delta[<span class="dv">2</span>])</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> df_ell, <span class="fu">aes</span>(Yield, Strength)) <span class="sc">+</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> center, <span class="fu">aes</span>(Yield, Strength), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Yield Difference"</span>, <span class="at">y=</span><span class="st">"Strength Difference"</span>)</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="05-Inference_for_Means_II_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>95% Confidence region for population mean difference <span class="math inline">\boldsymbol \mu_1 - \boldsymbol \mu_2</span></figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation</strong>:</p>
<p>The <span class="math inline">95\%</span> confidence ellipse for the difference between two population mean vectors</p>
<ul>
<li>is centered at -2.6, 2.17,</li>
<li>and extends 6.45 and 2.11 units in the first and second eigenvectors directions.</li>
</ul>
<p>Since the origin 0 does not fall into the <span class="math inline">95\%</span> confidence ellipse, we conclude that the change in rolling temperature indeed affect the strength profile significantly at <span class="math inline">\alpha=0.05</span>, which is consistent with the Hotelling’s <span class="math inline">T^2</span> test. However, at this point we do not know whether individual variable would contribute to this change along.</p>
</div>
</div>
</div>
<ul>
<li><strong>Step 5. Construct simultaneous <span class="math inline">T^2</span> and Bonferroni CIs and interpret the results.</strong></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="View Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># confidence level</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>level <span class="ot">&lt;-</span> <span class="fl">0.95</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>se_j <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(Sp) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span>n1 <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n2))</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute degrees of freedom and the multipliers</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> p</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2<span class="sc">-</span>p<span class="dv">-1</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2<span class="dv">-2</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>cval_T2 <span class="ot">&lt;-</span>  <span class="fu">sqrt</span>((n1<span class="sc">+</span>n2<span class="dv">-2</span>)<span class="sc">*</span>p<span class="sc">*</span><span class="fu">qf</span>(level,df1,df2)<span class="sc">/</span>(n1<span class="sc">+</span>n2<span class="sc">-</span>p<span class="dv">-1</span>))</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> p </span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>level2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span>level)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>m)</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>cval_Bon  <span class="ot">&lt;-</span> <span class="fu">qt</span>(level2, df3)</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>ci_T2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">Component =</span> <span class="fu">c</span>(<span class="st">"Yield"</span>, <span class="st">"Strength"</span>),</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> Delta,</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lower =</span> Estimate <span class="sc">-</span> cval_T2 <span class="sc">*</span> se_j,</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">Upper =</span> Estimate <span class="sc">+</span> cval_T2 <span class="sc">*</span> se_j</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"T2 CI:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>T2 CI:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ci_T2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  Component Estimate Lower Upper
  &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Yield        -2.6  -7.67  2.47
2 Strength      2.17 -2.35  6.69</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>ci_Bon <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Component =</span> <span class="fu">c</span>(<span class="st">"Yield"</span>, <span class="st">"Strength"</span>),</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> Delta,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lower =</span> Estimate <span class="sc">-</span> cval_Bon <span class="sc">*</span> se_j,</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Upper =</span> Estimate <span class="sc">+</span> cval_Bon <span class="sc">*</span> se_j</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Bonferroni CI:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Bonferroni CI:</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ci_Bon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  Component Estimate Lower Upper
  &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Yield        -2.6  -6.94  1.74
2 Strength      2.17 -1.70  6.04</code></pre>
</div>
</div>
<p><strong>Interpretation</strong>: The simultaneous <span class="math inline">T^2</span> CIs and Bonferroni CIs do include the origin for each population mean parameter. While we get two seemingly contradictory results, they are not wrong. The key reason is that the (joint) confidence region obtained above effectively takes into account the correlation between these two variables: yield point and ultimate strength. From the scatter plot between these two variables, we also notice that there is a strong positive correlation under both rolling temperature. Thus, it is possible that <span class="math inline">(0,0)</span> is outside the <span class="math inline">95\%</span> confidence ellipse but all individual intervals would contain 0, indicating non-significant difference for individual variables (as these variables are highly correlated.) A powerful and correct way for multivariate test is to use the Hotelling’s <span class="math inline">T^2</span> test or joint confidence region to detect a difference that the individual simultaneous intervals would miss.</p>
</div>
</div>
</div>
</section>
</section>
<section id="comparing-multiple-mean-vectors" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="comparing-multiple-mean-vectors"><span class="header-section-number">5.2</span> Comparing Multiple Mean Vectors</h2>
<p>In multivariate analysis, we often want to test whether several groups have the <strong>same mean vector</strong> for multiple variables. This is the multivariate extension of one-way ANOVA: <strong>Multivariate Analysis of Variance (MANOVA)</strong>. We can extend the comparison of mean vectors to <em><span class="math inline">g</span></em> different groups (or treatments) or populations for <span class="math inline">p</span> responses.</p>
<div class="callout callout-style-default callout-important callout-titled" title="Key Assumptions">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Assumptions
</div>
</div>
<div class="callout-body-container callout-body">
<p>The following assumptions are needed to make inferences about the difference between any two population mean vectors: <span class="math inline">\boldsymbol \mu_{\ell_1} - \boldsymbol \mu_{\ell_2}</span> for <span class="math inline">\ell_1\neq \ell_2</span>:</p>
<ol type="1">
<li><p>Each observation vector sampled from the <span class="math inline">\ell</span>-th population (or group) follows a multivariate normal distribution: for <span class="math inline">\ell=1,\ldots g</span>, <span class="math display">
\mathbf{x}_{\ell 1}, \mathbf{x}_{\ell 2}, \dots, \mathbf{x}_{\ell n_\ell} \overset{ind}{\sim} N_p(\boldsymbol{\mu}_\ell, {\Sigma}).
</span></p></li>
<li><p>Covariance matrices are homogeneous: <span class="math inline">\Sigma_\ell = \Sigma</span> for every population.</p></li>
<li><p>Observations from one population (or group) is independent of any observations from other populations.</p></li>
</ol>
</div>
</div>
<section id="example-iris-data" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="example-iris-data"><span class="header-section-number">5.2.1</span> Example: Iris Data</h3>
<p><strong>Background</strong></p>
<p>A botanist wants to determine if the three species of iris flowers (<em>setosa</em>, <em>versicolor</em>, and <em>virginica</em>) have different overall morphologies. Instead of just looking at one measurement, they want to compare the species based on a complete profile of <strong>all four</strong> available measurements: <code>Sepal.Length</code>, <code>Sepal.Width</code>, <code>Petal.Length</code>, and <code>Petal.Width</code> from the <code>iris</code> data.</p>
<p>Because we are comparing a <strong>vector of mean responses</strong> across <strong>more than two groups</strong>, this is a classic problem for <strong>Multivariate Analysis of Variance (MANOVA)</strong>.</p>
<ul>
<li><strong>Groups (<span class="math inline">g=3</span>):</strong> <code>setosa</code>, <code>versicolor</code>, <code>virginica</code></li>
<li><strong>Response Variables (<span class="math inline">p=4</span>):</strong> <code>Sepal.Length</code>, <code>Sepal.Width</code>, <code>Petal.Length</code>, <code>Petal.Width</code></li>
<li><strong>Research Question:</strong> Are the mean vectors of these four characteristics the same across all three species?</li>
</ul>
</section>
<section id="load-and-visualize-the-data" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="load-and-visualize-the-data"><span class="header-section-number">5.2.2</span> Load and Visualize the Data</h3>
<p>Before testing, it is crucial to visualize the data. A pairs plot is excellent for this, as it shows the relationship between all variables for each species.</p>
<div class="cell">
<details class="code-fold">
<summary>R Code: Between Group plots</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co">#head(iris)</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> iris</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>g <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">levels</span>(df<span class="sc">$</span>Species))</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">=</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), </span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to=</span><span class="st">"var"</span>)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">=</span> <span class="fu">ggplot</span>(df_long) <span class="sc">+</span> </span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>Species, <span class="at">y=</span>value), </span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">size=</span>.<span class="dv">8</span>, <span class="at">alpha=</span>.<span class="dv">8</span>) <span class="sc">+</span> </span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>var, <span class="at">scales=</span><span class="st">"free_y"</span>)</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(g1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05-Inference_for_Means_II_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation</strong>: These panels suggest that there is a moderate variation across different species (groups) for each of the variables. Within each species (group), the observations also indicates some variations.</p>
<div class="cell">
<details class="code-fold">
<summary>R Code: Between Group boxplots</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">=</span> <span class="fu">ggplot</span>(df_long, <span class="fu">aes</span>(<span class="at">x=</span>Species, <span class="at">y=</span>value)) <span class="sc">+</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">'skyblue'</span>) <span class="sc">+</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_jitter(width = 0.1) + </span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>var, <span class="at">scales=</span><span class="st">"free_y"</span>) <span class="sc">+</span> </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">""</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(g2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05-Inference_for_Means_II_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation</strong>: All the variables across different species roughly follow symmetric distributions, except for the <code>Petal.Width</code> from the Setosa, whose distribution seems to be highly skewed to the right.</p>
<div class="cell">
<details class="code-fold">
<summary>R Code: Pairwise Scatterplot</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a pairs plot, colored by Species</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  iris,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">color =</span> Species)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Pairs Plot of Iris Measurements by Species"</span>) <span class="sc">+</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05-Inference_for_Means_II_files/figure-html/data-prep-manova-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation</strong>: The plot shows some separation among the three species, especially for the petal measurements. There are strong linear associations between <code>Petal.Length</code> and <code>Petal.Width</code> among all the three species. In general, there is also a linear association between <code>Sepal.Length</code> and <code>Petal.Length</code>, between <code>Septal.Length</code> and <code>Petal.Width</code>.</p>
</section>
<section id="state-the-hypotheses-1" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="state-the-hypotheses-1"><span class="header-section-number">5.2.3</span> State the Hypotheses</h3>
<p>Formulate the null and alternative hypotheses for the MANOVA test.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Hypotheses">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hypotheses
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The null hypothesis states that the true mean vectors for the full morphology profile are identical for all three species. The alternative hypothesis states that at least two of the species have different mean vectors.</p>
<ul>
<li><p><strong>Null Hypothesis (<span class="math inline">H_0</span>):</strong> <span class="math display"> H_0: \boldsymbol{\mu}_{\text{setosa}} = \boldsymbol{\mu}_{\text{versicolor}} = \boldsymbol{\mu}_{\text{virginica}} </span></p></li>
<li><p><strong>Alternative Hypothesis (<span class="math inline">H_1</span>):</strong> <span class="math display"> H_1: \text{At least one } \boldsymbol{\mu}_{k} \neq \boldsymbol{\mu}_{\ell} \text{ for } k \neq \ell </span></p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="check-assumptions" class="level3" data-number="5.2.4">
<h3 data-number="5.2.4" class="anchored" data-anchor-id="check-assumptions"><span class="header-section-number">5.2.4</span> Check Assumptions</h3>
<p>MANOVA relies on two key assumptions: multivariate normality within each group and the homogeneity of their covariance matrices.</p>
<div class="cell">
<details class="code-fold">
<summary>R Code: Normality Checks</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check univariate normaltiy </span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Variable"</span>, </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Value"</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Group by both Species and the new Variable column</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species, Variable) <span class="sc">%&gt;%</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Run the shapiro.test for each group</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_value =</span> stats<span class="sc">::</span><span class="fu">shapiro.test</span>(Value)<span class="sc">$</span>p.value, </span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span> </span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Species"],"name":[1],"type":["fct"],"align":["left"]},{"label":["Variable"],"name":[2],"type":["chr"],"align":["left"]},{"label":["p_value"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"setosa","2":"Petal.Length","3":"5.481147e-02"},{"1":"setosa","2":"Petal.Width","3":"8.658573e-07"},{"1":"setosa","2":"Sepal.Length","3":"4.595132e-01"},{"1":"setosa","2":"Sepal.Width","3":"2.715264e-01"},{"1":"versicolor","2":"Petal.Length","3":"1.584778e-01"},{"1":"versicolor","2":"Petal.Width","3":"2.727780e-02"},{"1":"versicolor","2":"Sepal.Length","3":"4.647370e-01"},{"1":"versicolor","2":"Sepal.Width","3":"3.379951e-01"},{"1":"virginica","2":"Petal.Length","3":"1.097754e-01"},{"1":"virginica","2":"Petal.Width","3":"8.695419e-02"},{"1":"virginica","2":"Sepal.Length","3":"2.583147e-01"},{"1":"virginica","2":"Sepal.Width","3":"1.808960e-01"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details class="code-fold">
<summary>R Code: Normality Checks</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check multivariate normaltiy</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>mntest <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">levels</span>(iris<span class="sc">$</span>Species)){</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>mntest[i] <span class="ot">=</span> mvShapiroTest<span class="sc">::</span><span class="fu">mvShapiro.Test</span>(</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>(iris[iris<span class="sc">$</span>Species <span class="sc">==</span> i, <span class="sc">-</span><span class="dv">5</span>]))<span class="sc">$</span>p.value</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co"># p values: </span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mntest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    setosa versicolor  virginica 
 0.0120325  0.3182897  0.9652400 </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>R Code: Test Homogeneity of Covariance Matrices</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: Box's M-test is very sensitive, especially with larger datasets.</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>biotools<span class="sc">::</span><span class="fu">boxM</span>(iris[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], iris<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Box's M-test for Homogeneity of Covariance Matrices

data:  iris[, 1:4]
Chi-Sq (approx.) = 140.94, df = 20, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li><strong>Normality:</strong> The p-values for all three species are relatively large (&gt;0.01), indicating that the data within each group are roughly consistent with a multivariate normal distribution.</li>
<li><strong>Box’s M-Test:</strong> The p-value is very small (<code>p &lt; 0.001</code>), indicating that the assumption of equal covariance matrices is <strong>violated</strong>. However, MANOVA is generally robust to this violation when group sizes are equal (as they are here, <span class="math inline">n=50</span> for each), so we can proceed, but we should acknowledge this limitation in a formal report.</li>
</ul>
</section>
<section id="one-way-manova" class="level3" data-number="5.2.5">
<h3 data-number="5.2.5" class="anchored" data-anchor-id="one-way-manova"><span class="header-section-number">5.2.5</span> One-Way MANOVA</h3>
<p>We will now perform the MANOVA to formally test the null hypothesis. The most common test statistic is <strong>Wilk’s</strong> <span class="math inline">\Lambda</span>, which essentially compares the variability <em>within</em> groups to the <em>total</em> variability. Small values of Wilk’s <span class="math inline">\Lambda</span> suggest that the group means are different.</p>
<p>The one-way MANOVA model is given by: <span class="math display">
\mathbf{x}_{\ell j} = \boldsymbol{\mu} + \boldsymbol{\tau}_{\ell} + \boldsymbol{\epsilon}_{\ell j}, \quad \ell=1,\ldots, g; \quad j=1,\ldots, n_{\ell}
</span> where</p>
<ul>
<li><span class="math inline">\boldsymbol{\tau}_{\ell}</span> represents the treatment (group) effect with the constraint that <span class="math inline">\sum_{\ell=1}^{g} n_{\ell} \boldsymbol{\tau}_{\ell} = \mathbf{0}</span>,</li>
<li>the error terms are independently distributed as <span class="math inline">\boldsymbol{\epsilon}_{\ell j} \sim N_p(\mathbf{0}, {\Sigma})</span>,</li>
<li><span class="math inline">\boldsymbol \mu</span> is the overall (or grand) mean across all populations, and <span class="math inline">\boldsymbol \mu_{\ell} := \boldsymbol \mu + \boldsymbol{\tau}_{\ell}</span> is the group mean for the <span class="math inline">\ell</span>th population.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled" title="MANOVA Table">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
MANOVA Table
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 76%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th>Source of Variation</th>
<th>Matrix of Sums of Squares and Cross-Products (SSP)</th>
<th>Degrees of Freedom</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Treatment</td>
<td><span class="math inline">B = \sum_{\ell} n_\ell (\bar{\mathbf{x}}_\ell - \bar{\mathbf{x}})(\bar{\mathbf{x}}_\ell - \bar{\mathbf{x}})'</span></td>
<td><span class="math inline">g - 1</span></td>
</tr>
<tr class="even">
<td>Residual</td>
<td><span class="math inline">W = \sum_{\ell} \sum_{j} (\mathbf{x}_{\ell j} - \bar{\mathbf{x}}_\ell)(\mathbf{x}_{\ell j} - \bar{\mathbf{x}}_\ell)'</span></td>
<td><span class="math inline">n - g</span></td>
</tr>
<tr class="odd">
<td>Total (Corrected)</td>
<td><span class="math inline">B + W = \sum_{\ell} \sum_{j} (\mathbf{x}_{\ell j} - \bar{\mathbf{x}})(\mathbf{x}_{\ell j} - \bar{\mathbf{x}})'</span></td>
<td><span class="math inline">n - 1</span></td>
</tr>
</tbody>
</table>
<ul>
<li><p>The within-group SSP matrix, <span class="math inline">\mathbf{W}</span>, can be expressed as: <span class="math display">\begin{align*}
\mathbf{W} &amp;= \sum_{\ell = 1}^g \sum_{j = 1}^{n_\ell} (\mathbf{x}_{\ell j} - \bar{\mathbf{x}}_\ell)(\mathbf{x}_{\ell j} - \bar{\mathbf{x}}_\ell)' \\
&amp;= (n_1 - 1)S_1 + (n_2 - 1) S_2 + \cdots + (n_g - 1) S_g \\
&amp;= (n-g) S_{\text{pool}}
\end{align*}</span> where <span class="math inline">n = \sum_{\ell=1}^g n_\ell</span>.</p></li>
<li><p>The pooled covariance matrix is calculated as: <span class="math display">
S_{\text{pool}} = \sum_{\ell = 1}^g \left[\frac{(n_\ell - 1)}{\sum_{j=1}^g (n_j - 1)}\right] S_\ell.
</span></p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Wilk's $\Lambda$ Test Statistic">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Wilk’s <span class="math inline">\Lambda</span> Test Statistic
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><p>One test of the null hypothesis is carried out using a statistic called <em>Wilk’s</em> <span class="math inline">\Lambda</span> (a likelihood ratio test): <span class="math display">
\Lambda = \frac{|W|}{|B + W|}.
</span></p></li>
<li><p>If <span class="math inline">B</span> is “small” relative to W, then <span class="math inline">\Lambda</span> will be close to 1. Otherwise, <span class="math inline">\Lambda</span> will be small.</p></li>
<li><p>We reject the null hypothesis when <span class="math inline">\Lambda</span> is small.</p></li>
<li><p><strong>Exact Distribution of Wilk’s <span class="math inline">\Lambda</span></strong></p></li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 24%">
<col style="width: 21%">
<col style="width: 53%">
</colgroup>
<thead>
<tr class="header">
<th>No.&nbsp;of Variables (<span class="math inline">p</span>)</th>
<th>No.&nbsp;of Groups (<span class="math inline">g</span>)</th>
<th>Sampling Distribution for Multivariate Normal Data</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">p = 1</span></td>
<td><span class="math inline">g \geq 2</span></td>
<td><span class="math inline">\left(\frac{n - g}{g - 1}\right)\left(\frac{1 - \Lambda}{\Lambda}\right) \sim F_{g - 1,\ n - g}</span></td>
</tr>
<tr class="even">
<td><span class="math inline">p = 2</span></td>
<td><span class="math inline">g \geq 2</span></td>
<td><span class="math inline">\left(\frac{n - g - 1}{g - 1}\right)\left(\frac{1 - \sqrt{\Lambda}}{\sqrt{\Lambda}}\right) \sim F_{2(g - 1),\ 2(n - g - 1)}</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">p \geq 1</span></td>
<td><span class="math inline">g = 2</span></td>
<td><span class="math inline">\left(\frac{n - p - 1}{p}\right)\left(\frac{1 - \Lambda}{\Lambda}\right) \sim F_{p,\ n - p - 1}</span></td>
</tr>
<tr class="even">
<td><span class="math inline">p \geq 1</span></td>
<td><span class="math inline">g = 3</span></td>
<td><span class="math inline">\left(\frac{n - p - 2}{p}\right)\left(\frac{1 - \sqrt{\Lambda}}{\sqrt{\Lambda}}\right) \sim F_{2p,\ 2(n - p - 2)}</span></td>
</tr>
</tbody>
</table>
<ul>
<li><strong>F Approximation to the Sampling Distribution Wilk’s <span class="math inline">\Lambda</span></strong></li>
</ul>
<p>When the null hypothesis of equal population mean vectors is true, the distribution of the Wilks’ Lambda statistic can be approximated by an <span class="math inline">F</span>-distribution: <span class="math display">
  \frac{ 1 - \Lambda^{1/b}}{\Lambda^{1/b}} \cdot \frac{ ab - c}{p(g - 1)} \sim F_{p(g - 1),\ ab - c}
</span> where <span class="math display">\begin{align*}
  a &amp;= (n - g) - \frac{p - g + 2}{2} \\
  b &amp;= \sqrt{ \frac{p^2 (g - 1)^2 - 4}{p^2 + (g - 1)^2 - 5} } \\
  c &amp;= \frac{p(g - 1) - 2}{2}
\end{align*}</span></p>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>R Code: MANOVA Test</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The manova() function fits the model.</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The formula cbind(Y1, Y2, Y3, Y4) ~ Group tells R to use all four</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co"># measurements as the multivariate response vector.</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>manova_fit <span class="ot">&lt;-</span> <span class="fu">manova</span>(</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(Sepal.Length, Sepal.Width, </span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>        Petal.Length, Petal.Width) </span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span> Species, </span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> iris)</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="co"># The summary() function generates the output from the statistical test.</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="co"># We specify test = "Wilks" to get the result for Wilk's Lambda.</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Other options include "Pillai", "Hotelling-Lawley", and "Roy".</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(manova_fit, <span class="at">test =</span> <span class="st">"Wilks"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           Df    Wilks approx F num Df den Df    Pr(&gt;F)    
Species     2 0.023439   199.15      8    288 &lt; 2.2e-16 ***
Residuals 147                                              
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><strong>Interpret the MANOVA Results</strong></p>
<p>Based on the F-statistic and p-value from the test, what is your conclusion?</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Interpretation">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Interpretation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The p-value is reported as <code>&lt; 2.2e-16</code>, which is exceptionally small. We <strong>reject the null hypothesis at significance level 0.05</strong>.</p>
<p><strong>Conclusion:</strong> There is a statistically significant difference in the overall morphology (the mean vector of the four measurements) among the three iris species.</p>
</div>
</div>
</div>
</section>
<section id="pairwse-comparison" class="level3" data-number="5.2.6">
<h3 data-number="5.2.6" class="anchored" data-anchor-id="pairwse-comparison"><span class="header-section-number">5.2.6</span> Pairwse Comparison</h3>
<p>A significant MANOVA result tells us that a difference exists, but not <em>where</em> that difference lies. We need to perform follow-up tests to understand the result more deeply.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Method 1: Univariate ANOVA">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Method 1: Univariate ANOVA
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>A simple first step is to look at the results for each response variable individually to see which ones are contributing to the overall difference.</p>
<div class="cell">
<details class="code-fold">
<summary>R Code: Univariate Follow-up</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The summary.aov() function provides the results </span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for each dependent variable separately.</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(manova_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Response Sepal.Length :
             Df Sum Sq Mean Sq F value    Pr(&gt;F)    
Species       2 63.212  31.606  119.26 &lt; 2.2e-16 ***
Residuals   147 38.956   0.265                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

 Response Sepal.Width :
             Df Sum Sq Mean Sq F value    Pr(&gt;F)    
Species       2 11.345  5.6725   49.16 &lt; 2.2e-16 ***
Residuals   147 16.962  0.1154                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

 Response Petal.Length :
             Df Sum Sq Mean Sq F value    Pr(&gt;F)    
Species       2 437.10 218.551  1180.2 &lt; 2.2e-16 ***
Residuals   147  27.22   0.185                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

 Response Petal.Width :
             Df Sum Sq Mean Sq F value    Pr(&gt;F)    
Species       2 80.413  40.207  960.01 &lt; 2.2e-16 ***
Residuals   147  6.157   0.042                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong> The univariate ANOVAs show extremely small p-values for <strong>all four</strong> variables (<code>Sepal.Length</code>, <code>Sepal.Width</code>, <code>Petal.Length</code>, and <code>Petal.Width</code>). This indicates that the group means are significantly different for every measurement when considered one at a time.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Method 2: Pairwise Group Comparisons">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Method 2: Pairwise Group Comparisons
</div>
</div>
<div class="callout-body-container callout-body">
<p>To find out which specific <em>species</em> are different from each other, we could perform pairwise comparisons. This could involve running two-sample Hotelling’s T² tests for each pair (e.g., setosa vs.&nbsp;versicolor) with a Bonferroni correction to the alpha level to control for multiple comparisons. Given the clear separation in the plots, we can be confident that all three species are significantly different from one another on their overall morphology profile.</p>
<ul>
<li>If we wish to carry out all pairwise comparisons, there will be <span class="math inline">p g (g - 1)/2</span> of them.</li>
<li>To maintain a simultaneous type I error level of no more than <span class="math inline">\alpha</span> we can use <span class="math display">
t_{(n-g), 1-\frac{\alpha}{2m}} \quad \text{ where } \quad  m = \frac{pg(g-1)}{2}.
</span></li>
<li>Formulas for the simultaneous Bonferroni CIs are <span class="math display">
\left( \bar{x}_{ik} - \bar{x}_{i \ell} \right)  \ \pm \  t_{(n-g), 1-\frac{\alpha}{2m}} \sqrt{\left(\frac{1}{n_k} + \frac{1}{n_\ell}\right) S_{pool,ii}}
</span></li>
</ul>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>R Code: Bonferroni CIs</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> iris <span class="sc">%&gt;%</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Species) <span class="sc">%&gt;%</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(n, <span class="at">name =</span> Species)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="dv">4</span> <span class="co"># variables</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>g <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">levels</span>(iris<span class="sc">$</span>Species))</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>level <span class="ot">&lt;-</span> <span class="fl">0.95</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> p <span class="sc">*</span> g <span class="sc">*</span> (g <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>level2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> level) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> m)</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">sum</span>(n) <span class="sc">-</span> g</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>c_bon  <span class="ot">&lt;-</span> <span class="fu">qt</span>(level2, df)</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a><span class="co"># compute pooled covariance matrix</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>Sp <span class="ot">=</span> <span class="fu">summary</span>(manova_fit)<span class="sc">$</span>SS<span class="sc">$</span>Residuals <span class="sc">/</span> df</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>Sp_ii <span class="ot">=</span> <span class="fu">diag</span>(Sp)</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a><span class="co"># sample mean</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>xbar <span class="ot">=</span> iris <span class="sc">%&gt;%</span></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), mean)) <span class="sc">%&gt;%</span></span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Get group sample sizes (n_k) and means (x_bar_k)</span></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>iris_summaries <span class="ot">&lt;-</span> iris <span class="sc">%&gt;%</span></span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), </span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">list</span>(<span class="at">mean =</span> mean, <span class="at">n =</span> <span class="sc">~</span> <span class="fu">n</span>())), </span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>                   <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Get all unique pairs of species</span></span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>species_pairs <span class="ot">&lt;-</span> <span class="fu">combn</span>(<span class="fu">unique</span>(iris<span class="sc">$</span>Species), </span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">2</span>, <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Use purrr::map_df to loop through pairs </span></span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a>all_intervals <span class="ot">&lt;-</span> <span class="fu">map_df</span>(species_pairs, <span class="cf">function</span>(pair) {</span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a>  species1 <span class="ot">&lt;-</span> pair[<span class="dv">1</span>]</span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a>  species2 <span class="ot">&lt;-</span> pair[<span class="dv">2</span>]</span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get means and sample sizes for the two species being compared</span></span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a>  summary1 <span class="ot">&lt;-</span> iris_summaries <span class="sc">%&gt;%</span> </span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Species <span class="sc">==</span> species1)</span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a>  summary2 <span class="ot">&lt;-</span> iris_summaries <span class="sc">%&gt;%</span> </span>
<span id="cb59-45"><a href="#cb59-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Species <span class="sc">==</span> species2)</span>
<span id="cb59-46"><a href="#cb59-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-47"><a href="#cb59-47" aria-hidden="true" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> summary1<span class="sc">$</span>Sepal.Length_n</span>
<span id="cb59-48"><a href="#cb59-48" aria-hidden="true" tabindex="-1"></a>  n2 <span class="ot">&lt;-</span> summary2<span class="sc">$</span>Sepal.Length_n</span>
<span id="cb59-49"><a href="#cb59-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-50"><a href="#cb59-50" aria-hidden="true" tabindex="-1"></a>  mean_diffs <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(</span>
<span id="cb59-51"><a href="#cb59-51" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(summary1, </span>
<span id="cb59-52"><a href="#cb59-52" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">ends_with</span>(<span class="st">"_mean"</span>))) <span class="sc">-</span></span>
<span id="cb59-53"><a href="#cb59-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(</span>
<span id="cb59-54"><a href="#cb59-54" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(summary2, </span>
<span id="cb59-55"><a href="#cb59-55" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">ends_with</span>(<span class="st">"_mean"</span>)))</span>
<span id="cb59-56"><a href="#cb59-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-57"><a href="#cb59-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate margin of error for this pair</span></span>
<span id="cb59-58"><a href="#cb59-58" aria-hidden="true" tabindex="-1"></a>  margin_of_error <span class="ot">&lt;-</span> c_bon <span class="sc">*</span> </span>
<span id="cb59-59"><a href="#cb59-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sqrt</span>((<span class="dv">1</span> <span class="sc">/</span> n1 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> n2) <span class="sc">*</span> Sp_ii)</span>
<span id="cb59-60"><a href="#cb59-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-61"><a href="#cb59-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a tibble for this pair's results</span></span>
<span id="cb59-62"><a href="#cb59-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb59-63"><a href="#cb59-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">Comparison =</span> <span class="fu">paste</span>(species1, <span class="st">"vs."</span>, species2),</span>
<span id="cb59-64"><a href="#cb59-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> <span class="fu">names</span>(Sp_ii),</span>
<span id="cb59-65"><a href="#cb59-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Difference =</span> mean_diffs,</span>
<span id="cb59-66"><a href="#cb59-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">Lower_CI =</span> mean_diffs <span class="sc">-</span> margin_of_error,</span>
<span id="cb59-67"><a href="#cb59-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">Upper_CI =</span> mean_diffs <span class="sc">+</span> margin_of_error</span>
<span id="cb59-68"><a href="#cb59-68" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb59-69"><a href="#cb59-69" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb59-70"><a href="#cb59-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-71"><a href="#cb59-71" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb59-72"><a href="#cb59-72" aria-hidden="true" tabindex="-1"></a>  all_intervals, <span class="at">digits =</span> <span class="dv">3</span>, </span>
<span id="cb59-73"><a href="#cb59-73" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Simultaneous 95% Bonferroni Confidence Intervals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Simultaneous 95% Bonferroni Confidence Intervals</caption>
<colgroup>
<col style="width: 34%">
<col style="width: 18%">
<col style="width: 22%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Comparison</th>
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Mean_Difference</th>
<th style="text-align: right;">Lower_CI</th>
<th style="text-align: right;">Upper_CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">setosa vs.&nbsp;versicolor</td>
<td style="text-align: left;">Sepal.Length</td>
<td style="text-align: right;">-0.930</td>
<td style="text-align: right;">-1.230</td>
<td style="text-align: right;">-0.630</td>
</tr>
<tr class="even">
<td style="text-align: left;">setosa vs.&nbsp;versicolor</td>
<td style="text-align: left;">Sepal.Width</td>
<td style="text-align: right;">0.658</td>
<td style="text-align: right;">0.460</td>
<td style="text-align: right;">0.856</td>
</tr>
<tr class="odd">
<td style="text-align: left;">setosa vs.&nbsp;versicolor</td>
<td style="text-align: left;">Petal.Length</td>
<td style="text-align: right;">-2.798</td>
<td style="text-align: right;">-3.049</td>
<td style="text-align: right;">-2.547</td>
</tr>
<tr class="even">
<td style="text-align: left;">setosa vs.&nbsp;versicolor</td>
<td style="text-align: left;">Petal.Width</td>
<td style="text-align: right;">-1.080</td>
<td style="text-align: right;">-1.199</td>
<td style="text-align: right;">-0.961</td>
</tr>
<tr class="odd">
<td style="text-align: left;">setosa vs.&nbsp;virginica</td>
<td style="text-align: left;">Sepal.Length</td>
<td style="text-align: right;">-1.582</td>
<td style="text-align: right;">-1.882</td>
<td style="text-align: right;">-1.282</td>
</tr>
<tr class="even">
<td style="text-align: left;">setosa vs.&nbsp;virginica</td>
<td style="text-align: left;">Sepal.Width</td>
<td style="text-align: right;">0.454</td>
<td style="text-align: right;">0.256</td>
<td style="text-align: right;">0.652</td>
</tr>
<tr class="odd">
<td style="text-align: left;">setosa vs.&nbsp;virginica</td>
<td style="text-align: left;">Petal.Length</td>
<td style="text-align: right;">-4.090</td>
<td style="text-align: right;">-4.341</td>
<td style="text-align: right;">-3.839</td>
</tr>
<tr class="even">
<td style="text-align: left;">setosa vs.&nbsp;virginica</td>
<td style="text-align: left;">Petal.Width</td>
<td style="text-align: right;">-1.780</td>
<td style="text-align: right;">-1.899</td>
<td style="text-align: right;">-1.661</td>
</tr>
<tr class="odd">
<td style="text-align: left;">versicolor vs.&nbsp;virginica</td>
<td style="text-align: left;">Sepal.Length</td>
<td style="text-align: right;">-0.652</td>
<td style="text-align: right;">-0.952</td>
<td style="text-align: right;">-0.352</td>
</tr>
<tr class="even">
<td style="text-align: left;">versicolor vs.&nbsp;virginica</td>
<td style="text-align: left;">Sepal.Width</td>
<td style="text-align: right;">-0.204</td>
<td style="text-align: right;">-0.402</td>
<td style="text-align: right;">-0.006</td>
</tr>
<tr class="odd">
<td style="text-align: left;">versicolor vs.&nbsp;virginica</td>
<td style="text-align: left;">Petal.Length</td>
<td style="text-align: right;">-1.292</td>
<td style="text-align: right;">-1.543</td>
<td style="text-align: right;">-1.041</td>
</tr>
<tr class="even">
<td style="text-align: left;">versicolor vs.&nbsp;virginica</td>
<td style="text-align: left;">Petal.Width</td>
<td style="text-align: right;">-0.700</td>
<td style="text-align: right;">-0.819</td>
<td style="text-align: right;">-0.581</td>
</tr>
</tbody>
</table>
<p>Simultaneous 95% Bonferroni CIs. Intervals not crossing the dashed line (zero) are statistically significant.</p>
</div>
<details class="code-fold">
<summary>R Code: Bonferroni CIs</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(all_intervals,</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Mean_Difference, <span class="at">y =</span> Variable, </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> Variable)) <span class="sc">+</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> Lower_CI, <span class="at">xmax =</span> Upper_CI),</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">width =</span> <span class="fl">0.2</span>,</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>,</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> Comparison) <span class="sc">+</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Mean Difference"</span>,</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Variable"</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">60</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="05-Inference_for_Means_II_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Simultaneous 95% Bonferroni CIs. Intervals not crossing the dashed line (zero) are statistically significant.</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation</strong>: This visualization makes the conclusions from our analysis immediately obvious:</p>
<ul>
<li><strong>No intervals cross the zero line.</strong> Every single error bar for every comparison is clearly to the left or right of the vertical dashed line.</li>
<li>This provides powerful visual evidence that, after controlling for all 12 comparisons, <strong>all three iris species are significantly different from each other on all four measured variables</strong>. For example, in the <code>versicolor</code> v.s. <code>virginica</code> panel, the point for <code>Petal.Length</code> is around -1.3, and its confidence interval from approximately -1.6 to -1.0 is far from zero.</li>
<li>The simultaneous Bonferroni CIs confirm previous MANOVA test and provide more details on which variables are significantly different.</li>
</ul>
</section>
<section id="exercise-college-student-study" class="level3" data-number="5.2.7">
<h3 data-number="5.2.7" class="anchored" data-anchor-id="exercise-college-student-study"><span class="header-section-number">5.2.7</span> Exercise: College Student Study</h3>
<p><strong>Background</strong>: In a college student study, a sample of first-year university students was selected from three popular and critical fields of study. Each student was administered a standardized academic assessment battery upon entry. The goal is to see if the overall academic profile differs significantly among these groups. Perform detailed statistical analysis for the data below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>morel <span class="ot">=</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"morel.csv"</span>, </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">as.factor</span>(group))</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(morel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["group"],"name":[1],"type":["fct"],"align":["left"]},{"label":["aptitude"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["math"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["language"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["gen_know"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"23","3":"50","4":"59","5":"10"},{"1":"1","2":"70","3":"30","4":"79","5":"18"},{"1":"1","2":"25","3":"50","4":"86","5":"22"},{"1":"1","2":"0","3":"40","4":"67","5":"16"},{"1":"1","2":"0","3":"25","4":"70","5":"20"},{"1":"1","2":"20","3":"60","4":"78","5":"22"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<ol type="a">
<li>Data visualization</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="View Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>R Code: Data Visualization</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> morel </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>response_vars <span class="ot">=</span> <span class="fu">setdiff</span>(<span class="fu">colnames</span>(df), <span class="st">"group"</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">length</span>(response_vars)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>g <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">levels</span>(df<span class="sc">$</span>group))</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">=</span> df <span class="sc">%&gt;%</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>),</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to=</span><span class="st">"var"</span>)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_long, <span class="fu">aes</span>(<span class="at">x=</span>group, <span class="at">y=</span>value)) <span class="sc">+</span> </span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>var, <span class="at">scales=</span><span class="st">"free_y"</span>) <span class="sc">+</span> </span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05-Inference_for_Means_II_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>R Code: Data Visualization</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>GGally<span class="sc">::</span><span class="fu">ggpairs</span>(</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  df,</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="co"># The four test score variables</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">color =</span> group),</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">"cor"</span>),</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">"points"</span>)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Academic Score Profiles by Field of Study"</span>) <span class="sc">+</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05-Inference_for_Means_II_files/figure-html/unnamed-chunk-28-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The plot suggests there may be differences. For example, the distribution of <code>math</code> scores for Architecture students appears shifted compared to the other groups.</p>
</div>
</div>
</div>
<ol start="2" type="a">
<li>State the hypotheses using standard notations.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="View Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-24-contents" aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-24" class="callout-24-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The null hypothesis states that the true mean vectors of test scores are the same for all three student populations. The alternative states that at least two groups have different mean vectors.</p>
<ul>
<li><p><strong>Null Hypothesis (<span class="math inline">H_0</span>):</strong> <span class="math display"> H_0: \boldsymbol{\mu}_{\text{Technology}} = \boldsymbol{\mu}_{\text{Architecture}} = \boldsymbol{\mu}_{\text{Medical Tech}} </span></p></li>
<li><p><strong>Alternative Hypothesis (<span class="math inline">H_1</span>):</strong> <span class="math display"> H_1: \text{At least one } \boldsymbol{\mu}_{k} \neq \boldsymbol{\mu}_{\ell} \text{ for } k \neq \ell </span></p></li>
</ul>
</div>
</div>
</div>
<ol start="3" type="a">
<li>Check Assumptions</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="View Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-25-contents" aria-controls="callout-25" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-25" class="callout-25-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check univariate normaltiy </span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Variable"</span>, </span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Value"</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(group, Variable) <span class="sc">%&gt;%</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_value =</span> stats<span class="sc">::</span><span class="fu">shapiro.test</span>(Value)<span class="sc">$</span>p.value, </span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span> </span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["group"],"name":[1],"type":["fct"],"align":["left"]},{"label":["Variable"],"name":[2],"type":["chr"],"align":["left"]},{"label":["p_value"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"aptitude","3":"0.0102740329"},{"1":"1","2":"gen_know","3":"0.0001957149"},{"1":"1","2":"language","3":"0.8118458747"},{"1":"1","2":"math","3":"0.2220444243"},{"1":"2","2":"aptitude","3":"0.0082685736"},{"1":"2","2":"gen_know","3":"0.0192763773"},{"1":"2","2":"language","3":"0.1809162674"},{"1":"2","2":"math","3":"0.0156210509"},{"1":"3","2":"aptitude","3":"0.0073174061"},{"1":"3","2":"gen_know","3":"0.7264948756"},{"1":"3","2":"language","3":"0.2308159702"},{"1":"3","2":"math","3":"0.1649856904"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check multivariate normaltiy</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>mntest <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">levels</span>(df<span class="sc">$</span>group)){</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>mntest[i] <span class="ot">=</span> mvShapiroTest<span class="sc">::</span><span class="fu">mvShapiro.Test</span>(</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>(df[df<span class="sc">$</span>group <span class="sc">==</span> i, <span class="fu">colnames</span>(df) <span class="sc">!=</span><span class="st">"group"</span>]))<span class="sc">$</span>p.value</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="co"># p values: </span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mntest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         1          2          3 
0.00388046 0.00389287 0.01745476 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>biotools<span class="sc">::</span><span class="fu">boxM</span>(df[, <span class="fu">colnames</span>(df) <span class="sc">!=</span><span class="st">"group"</span>], df<span class="sc">$</span>group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Box's M-test for Homogeneity of Covariance Matrices

data:  df[, colnames(df) != "group"]
Chi-Sq (approx.) = 33.493, df = 20, p-value = 0.02977</code></pre>
</div>
</div>
</div>
</div>
</div>
<ol start="4" type="a">
<li>Perform the one-way MANOVA test</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="View Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-26-contents" aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-26" class="callout-26-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit one-way ANOVA to each of the response</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">=</span> <span class="fu">paste</span>(<span class="st">"cbind("</span>, </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">paste</span>(response_vars, <span class="at">collapse =</span> <span class="st">", "</span>), </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">") ~ group"</span>)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>fit.lm <span class="ot">=</span> <span class="fu">manova</span>(<span class="fu">as.formula</span>(formula), <span class="at">data =</span> df)</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="co"># fit MANOVA </span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>fit.manova <span class="ot">=</span> <span class="fu">manova</span>(fit.lm)</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.manova, <span class="at">test=</span><span class="st">"Wilks"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          Df   Wilks approx F num Df den Df    Pr(&gt;F)    
group      2 0.54345   6.7736      8    152 1.384e-07 ***
Residuals 79                                             
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><strong>Interpretation</strong>: The p-value is less than our significance level of <span class="math inline">\alpha = 0.05</span>. We therefore <strong>reject the null hypothesis</strong>. We conclude that there is a statistically significant difference in the mean academic profiles among the three groups of students (Technology, Architecture, and Medical Technology).</p>
</div>
</div>
</div>
<ol start="5" type="a">
<li>Follow-up analysis with pairwise comparisons</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="View Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-27-contents" aria-controls="callout-27" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-27" class="callout-27-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> df <span class="sc">%&gt;%</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(group) <span class="sc">%&gt;%</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(n, <span class="at">name =</span> group)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>level <span class="ot">=</span> <span class="fl">0.95</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> p <span class="sc">*</span> g <span class="sc">*</span> (g <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>level2 <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> level) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> m)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>dof <span class="ot">=</span> <span class="fu">sum</span>(n) <span class="sc">-</span> g</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>c_bon  <span class="ot">=</span> <span class="fu">qt</span>(level2, dof)</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a><span class="co"># compute pooled sample covariance</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>Sp <span class="ot">=</span> <span class="fu">summary</span>(fit.manova)<span class="sc">$</span>SS<span class="sc">$</span>Residuals <span class="sc">/</span> dof</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>Sp_ii <span class="ot">=</span> <span class="fu">diag</span>(Sp)</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>df_summaries <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(group) <span class="sc">%&gt;%</span></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="fu">list</span>(<span class="at">mean =</span> mean, <span class="at">n =</span> <span class="sc">~</span> <span class="fu">n</span>())), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Get all unique pairs</span></span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>group_pairs <span class="ot">&lt;-</span> <span class="fu">combn</span>(<span class="fu">unique</span>(df<span class="sc">$</span>group), <span class="dv">2</span>, <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>all_intervals <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_df</span>(group_pairs, <span class="cf">function</span>(pair) {</span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>  group1 <span class="ot">&lt;-</span> pair[<span class="dv">1</span>]</span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>  group2 <span class="ot">&lt;-</span> pair[<span class="dv">2</span>]</span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>  summary1 <span class="ot">&lt;-</span> df_summaries <span class="sc">%&gt;%</span> <span class="fu">filter</span>(group <span class="sc">==</span> group1)</span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a>  summary2 <span class="ot">&lt;-</span> df_summaries <span class="sc">%&gt;%</span> <span class="fu">filter</span>(group <span class="sc">==</span> group2)</span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-28"><a href="#cb71-28" aria-hidden="true" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> summary1<span class="sc">$</span>math_n</span>
<span id="cb71-29"><a href="#cb71-29" aria-hidden="true" tabindex="-1"></a>  n2 <span class="ot">&lt;-</span> summary2<span class="sc">$</span>math_n</span>
<span id="cb71-30"><a href="#cb71-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-31"><a href="#cb71-31" aria-hidden="true" tabindex="-1"></a>  mean_diffs <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(dplyr<span class="sc">::</span><span class="fu">select</span>(summary1, <span class="fu">ends_with</span>(<span class="st">"_mean"</span>))) <span class="sc">-</span></span>
<span id="cb71-32"><a href="#cb71-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(dplyr<span class="sc">::</span><span class="fu">select</span>(summary2, <span class="fu">ends_with</span>(<span class="st">"_mean"</span>)))</span>
<span id="cb71-33"><a href="#cb71-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-34"><a href="#cb71-34" aria-hidden="true" tabindex="-1"></a>  margin_of_error <span class="ot">&lt;-</span> c_bon <span class="sc">*</span> <span class="fu">sqrt</span>((<span class="dv">1</span> <span class="sc">/</span> n1 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> n2) <span class="sc">*</span> Sp_ii)</span>
<span id="cb71-35"><a href="#cb71-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-36"><a href="#cb71-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb71-37"><a href="#cb71-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">Comparison =</span> <span class="fu">paste</span>(group1, <span class="st">"vs."</span>, group2),</span>
<span id="cb71-38"><a href="#cb71-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variable =</span> <span class="fu">names</span>(Sp_ii),</span>
<span id="cb71-39"><a href="#cb71-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Difference =</span> mean_diffs,</span>
<span id="cb71-40"><a href="#cb71-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">Lower_CI =</span> mean_diffs <span class="sc">-</span> margin_of_error,</span>
<span id="cb71-41"><a href="#cb71-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">Upper_CI =</span> mean_diffs <span class="sc">+</span> margin_of_error</span>
<span id="cb71-42"><a href="#cb71-42" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb71-43"><a href="#cb71-43" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb71-44"><a href="#cb71-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-45"><a href="#cb71-45" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(all_intervals, <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">caption =</span> <span class="st">"Simultaneous 95% Bonferroni Confidence Intervals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Simultaneous 95% Bonferroni Confidence Intervals</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Comparison</th>
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Mean_Difference</th>
<th style="text-align: right;">Lower_CI</th>
<th style="text-align: right;">Upper_CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1 vs.&nbsp;2</td>
<td style="text-align: left;">aptitude</td>
<td style="text-align: right;">-28.158</td>
<td style="text-align: right;">-48.736</td>
<td style="text-align: right;">-7.580</td>
</tr>
<tr class="even">
<td style="text-align: left;">1 vs.&nbsp;2</td>
<td style="text-align: left;">math</td>
<td style="text-align: right;">-3.793</td>
<td style="text-align: right;">-14.388</td>
<td style="text-align: right;">6.802</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1 vs.&nbsp;2</td>
<td style="text-align: left;">language</td>
<td style="text-align: right;">-6.681</td>
<td style="text-align: right;">-12.732</td>
<td style="text-align: right;">-0.629</td>
</tr>
<tr class="even">
<td style="text-align: left;">1 vs.&nbsp;2</td>
<td style="text-align: left;">gen_know</td>
<td style="text-align: right;">-2.309</td>
<td style="text-align: right;">-9.669</td>
<td style="text-align: right;">5.051</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1 vs.&nbsp;3</td>
<td style="text-align: left;">aptitude</td>
<td style="text-align: right;">11.571</td>
<td style="text-align: right;">-11.938</td>
<td style="text-align: right;">35.081</td>
</tr>
<tr class="even">
<td style="text-align: left;">1 vs.&nbsp;3</td>
<td style="text-align: left;">math</td>
<td style="text-align: right;">9.296</td>
<td style="text-align: right;">-2.808</td>
<td style="text-align: right;">21.400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1 vs.&nbsp;3</td>
<td style="text-align: left;">language</td>
<td style="text-align: right;">2.466</td>
<td style="text-align: right;">-4.448</td>
<td style="text-align: right;">9.380</td>
</tr>
<tr class="even">
<td style="text-align: left;">1 vs.&nbsp;3</td>
<td style="text-align: left;">gen_know</td>
<td style="text-align: right;">-7.973</td>
<td style="text-align: right;">-16.382</td>
<td style="text-align: right;">0.436</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2 vs.&nbsp;3</td>
<td style="text-align: left;">aptitude</td>
<td style="text-align: right;">39.729</td>
<td style="text-align: right;">18.550</td>
<td style="text-align: right;">60.909</td>
</tr>
<tr class="even">
<td style="text-align: left;">2 vs.&nbsp;3</td>
<td style="text-align: left;">math</td>
<td style="text-align: right;">13.089</td>
<td style="text-align: right;">2.185</td>
<td style="text-align: right;">23.993</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2 vs.&nbsp;3</td>
<td style="text-align: left;">language</td>
<td style="text-align: right;">9.147</td>
<td style="text-align: right;">2.918</td>
<td style="text-align: right;">15.375</td>
</tr>
<tr class="even">
<td style="text-align: left;">2 vs.&nbsp;3</td>
<td style="text-align: left;">gen_know</td>
<td style="text-align: right;">-5.664</td>
<td style="text-align: right;">-13.239</td>
<td style="text-align: right;">1.911</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(all_intervals,</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Mean_Difference, <span class="at">y =</span> Variable, <span class="at">color =</span> Variable)) <span class="sc">+</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> Lower_CI, <span class="at">xmax =</span> Upper_CI),</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">width =</span> <span class="fl">0.2</span>,</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>,</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> Comparison) <span class="sc">+</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Simultaneous 95% Bonferroni CIs"</span>,</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Intervals not crossing the dashed line (zero) are statistically significant."</span>,</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Mean Difference"</span>,</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Measurement Variable"</span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05-Inference_for_Means_II_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="permulation-test" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="permulation-test"><span class="header-section-number">5.3</span> Permulation Test</h2>
<section id="introduction" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">5.3.1</span> Introduction</h3>
<p>A permutation test is a type of non-parametric statistical test. It is “distribution-free,” meaning it does not rely on assumptions that the data are drawn from a given probability distribution (like the normal distribution). This makes it an incredibly robust and versatile tool for hypothesis testing.</p>
<p><strong>When to Use a Permutation Test:</strong></p>
<ul>
<li>When your sample size is small.</li>
<li>When your data does not meet the assumptions of parametric tests (e.g., it’s not normally distributed).</li>
<li>When you are working with an unusual test statistic for which the theoretical distribution is unknown.</li>
</ul>
</section>
<section id="the-steps-of-a-permutation-test" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="the-steps-of-a-permutation-test"><span class="header-section-number">5.3.2</span> The Steps of a Permutation Test</h3>
<p>Every permutation test follows the same fundamental logic:</p>
<ol type="1">
<li><strong>Calculate the Observed Statistic:</strong> Compute the test statistic on your original, unshuffled data (e.g., the difference in means between two groups).</li>
<li><strong>Create a Null Distribution:</strong>
<ul>
<li>Pool all the data together.</li>
<li>Repeatedly (e.g., 10,000 times) shuffle the pooled data and randomly reassign it to groups of the original sizes.</li>
<li>For each shuffle, re-calculate the test statistic. The collection of these statistics forms the null distribution—the distribution of what your statistic looks like when the null hypothesis (of no effect) is true.</li>
</ul></li>
<li><strong>Calculate the p-value:</strong> The p-value is the proportion of statistics from the null distribution that are as extreme or more extreme than your originally observed statistic.</li>
</ol>
</section>
<section id="example-two-sample-comparison" class="level3" data-number="5.3.3">
<h3 data-number="5.3.3" class="anchored" data-anchor-id="example-two-sample-comparison"><span class="header-section-number">5.3.3</span> Example: Two-Sample Comparison</h3>
<p><strong>Background:</strong> We have data on the fuel efficiency (MPG) for a sample of 4-cylinder and 8-cylinder cars from the <code>mtcars</code> dataset. We want to test if there is a significant difference in the mean MPG between these two groups.</p>
<div class="cell">
<details class="code-fold">
<summary>R Code: Two-Sample Permutation Test</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the data</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>cars_data <span class="ot">&lt;-</span> mtcars <span class="sc">%&gt;%</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cyl <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(mpg, cyl)</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>group1 <span class="ot">&lt;-</span> cars_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(cyl <span class="sc">==</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(mpg)</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>group2 <span class="ot">&lt;-</span> cars_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(cyl <span class="sc">==</span> <span class="dv">8</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(mpg)</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">length</span>(group1)</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">length</span>(group2)</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the OBSERVED difference in means</span></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>observed_diff <span class="ot">&lt;-</span> <span class="fu">mean</span>(group1) <span class="sc">-</span> <span class="fu">mean</span>(group2)</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the Null Distribution</span></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4750</span>) <span class="co"># For reproducibility</span></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>n_permutations <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>permutation_diffs <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_permutations)</span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> <span class="fu">c</span>(group1, group2)</span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_permutations) {</span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Shuffle the data</span></span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a>  shuffled_data <span class="ot">&lt;-</span> <span class="fu">sample</span>(all_data)</span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assign to new sham groups</span></span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a>  new_group1 <span class="ot">&lt;-</span> shuffled_data[<span class="dv">1</span><span class="sc">:</span>n1]</span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a>  new_group2 <span class="ot">&lt;-</span> shuffled_data[(n1 <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(n1 <span class="sc">+</span> n2)]</span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate and store the difference for this permutation</span></span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true" tabindex="-1"></a>  permutation_diffs[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(new_group1) <span class="sc">-</span> <span class="fu">mean</span>(new_group2)</span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-35"><a href="#cb73-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-36"><a href="#cb73-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the p-value</span></span>
<span id="cb73-37"><a href="#cb73-37" aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">abs</span>(permutation_diffs) <span class="sc">&gt;=</span> </span>
<span id="cb73-38"><a href="#cb73-38" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">abs</span>(observed_diff)) <span class="sc">/</span> n_permutations</span>
<span id="cb73-39"><a href="#cb73-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-40"><a href="#cb73-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-41"><a href="#cb73-41" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">diffs =</span> permutation_diffs), </span>
<span id="cb73-42"><a href="#cb73-42" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> diffs)) <span class="sc">+</span></span>
<span id="cb73-43"><a href="#cb73-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), </span>
<span id="cb73-44"><a href="#cb73-44" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>, </span>
<span id="cb73-45"><a href="#cb73-45" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb73-46"><a href="#cb73-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb73-47"><a href="#cb73-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> observed_diff, </span>
<span id="cb73-48"><a href="#cb73-48" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb73-49"><a href="#cb73-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> observed_diff <span class="sc">-</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">0.1</span>, </span>
<span id="cb73-50"><a href="#cb73-50" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Observed Difference</span><span class="sc">\n</span><span class="st">p-value ="</span>, </span>
<span id="cb73-51"><a href="#cb73-51" aria-hidden="true" tabindex="-1"></a>                         p_value), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb73-52"><a href="#cb73-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb73-53"><a href="#cb73-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Permutation Test for MPG Difference (4-cyl vs. 8-cyl)"</span>,</span>
<span id="cb73-54"><a href="#cb73-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Difference in Mean MPG"</span>,</span>
<span id="cb73-55"><a href="#cb73-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb73-56"><a href="#cb73-56" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb73-57"><a href="#cb73-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05-Inference_for_Means_II_files/figure-html/two-sample-perm-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation:</strong> The observed difference (the red dashed line) is far out in the tail of the null distribution, and the p-value is effectively zero. This tells us that it is extremely unlikely to get a difference this large by random chance alone. We can confidently conclude that 4-cylinder cars have a significantly higher mean MPG than 8-cylinder cars.</p>
</section>
<section id="exercise-testing-a-correlation" class="level3" data-number="5.3.4">
<h3 data-number="5.3.4" class="anchored" data-anchor-id="exercise-testing-a-correlation"><span class="header-section-number">5.3.4</span> Exercise: Testing a Correlation</h3>
<p><strong>Background:</strong> Is there a significant correlation between a car’s weight (<code>wt</code>) and its fuel efficiency (<code>mpg</code>)? The null hypothesis is that the true correlation is zero.</p>
<p>The permutation logic is slightly different here: if there’s no relationship between weight and MPG, then we should be able to shuffle the order of one variable without affecting the correlation.</p>
<div class="cell">
<details class="code-fold">
<summary>R Code: Correlation Permutation Test</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the data</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>wt_data <span class="ot">&lt;-</span> mtcars<span class="sc">$</span>wt</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>mpg_data <span class="ot">&lt;-</span> mtcars<span class="sc">$</span>mpg</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the OBSERVED correlation</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>observed_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(wt_data, mpg_data)</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the Null Distribution</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>n_permutations <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>permutation_cors <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_permutations)</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_permutations) {</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Shuffle ONLY one of the variables</span></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>  shuffled_mpg <span class="ot">&lt;-</span> <span class="fu">sample</span>(mpg_data)</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate and store the correlation for this permutation</span></span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>  permutation_cors[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(wt_data, shuffled_mpg)</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the p-value</span></span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>p_value_cor <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">abs</span>(permutation_cors) <span class="sc">&gt;=</span> </span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">abs</span>(observed_cor)) <span class="sc">/</span> n_permutations</span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">cors =</span> permutation_cors), <span class="fu">aes</span>(<span class="at">x =</span> cors)) <span class="sc">+</span></span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">bins =</span> <span class="dv">30</span>, </span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"lightgreen"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"darkgreen"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> observed_cor, <span class="at">color =</span> <span class="st">"red"</span>, </span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb74-32"><a href="#cb74-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> observed_cor <span class="sc">+</span> <span class="fl">0.3</span>, <span class="at">y =</span> <span class="fl">1.5</span>, </span>
<span id="cb74-33"><a href="#cb74-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Observed Correlation ="</span>, </span>
<span id="cb74-34"><a href="#cb74-34" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">round</span>(observed_cor, <span class="dv">2</span>), </span>
<span id="cb74-35"><a href="#cb74-35" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"</span><span class="sc">\n</span><span class="st">p-value ="</span>, p_value_cor), </span>
<span id="cb74-36"><a href="#cb74-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb74-37"><a href="#cb74-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb74-38"><a href="#cb74-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Permutation Test for Correlation (MPG vs. Weight)"</span>,</span>
<span id="cb74-39"><a href="#cb74-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Correlation Coefficient"</span>,</span>
<span id="cb74-40"><a href="#cb74-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb74-41"><a href="#cb74-41" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb74-42"><a href="#cb74-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05-Inference_for_Means_II_files/figure-html/correlation-perm-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation:</strong> The observed correlation of -0.87 is an extreme outlier compared to the null distribution of correlations centered at zero. The p-value is effectively zero. We can conclude there is a highly significant negative correlation between a car’s weight and its fuel efficiency.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../ch4/04-Inference_for_Means.html" class="pagination-link" aria-label="Inference for Single Mean Vector">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Inference for Single Mean Vector</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../ch6/06-PCA.html" class="pagination-link" aria-label="Principal Component Analysis">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Principal Component Analysis</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>