<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Pulong Ma">

<title>Inference for Mean Vector – Introduction to Multivariate Statistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<script>
  window.MathJax = {
    loader: {
      load: ['[tex]/amsmath', '[tex]/amssymb', '[tex]/amsfonts'],
      '[tex]/color']
    },
    tex: {
      packages: { '[+]': ['amsmath', 'amssymb', 'amsfonts', 'color'] }
    }
  };
</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../custom.css">
<link rel="stylesheet" href="custom.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../ch4/04-Inference_for_Means.html">Module 4: Inference for Single Mean Vector</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Introduction to Multivariate Statistics</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ch1/01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 1: Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ch2/02-graphs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 2: Graphs and Data Visualization</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ch3/03-MVN.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 3: Multivariate Normal Distribution</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ch4/04-Inference_for_Means.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Module 4: Inference for Single Mean Vector</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ch5/05-Inference_for_Means_II.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 5: Inference for Multiple Mean Vectors</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ch6/06-PCA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 6: Principal Component Analysis</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="1">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#motivation" id="toc-motivation" class="nav-link active" data-scroll-target="#motivation"><span class="header-section-number">1</span> Motivation</a>
  <ul class="collapse">
  <li><a href="#why-not-just-run-two-t-tests" id="toc-why-not-just-run-two-t-tests" class="nav-link" data-scroll-target="#why-not-just-run-two-t-tests"><span class="header-section-number">1.1</span> Why Not Just Run Two t-tests?</a></li>
  <li><a href="#the-family-wise-error-rate-problem" id="toc-the-family-wise-error-rate-problem" class="nav-link" data-scroll-target="#the-family-wise-error-rate-problem"><span class="header-section-number">1.2</span> The Family-Wise Error Rate Problem</a></li>
  </ul></li>
  <li><a href="#review-of-univariate-inference" id="toc-review-of-univariate-inference" class="nav-link" data-scroll-target="#review-of-univariate-inference"><span class="header-section-number">2</span> Review of Univariate Inference</a></li>
  <li><a href="#generalizing-to-the-multivariate-case" id="toc-generalizing-to-the-multivariate-case" class="nav-link" data-scroll-target="#generalizing-to-the-multivariate-case"><span class="header-section-number">3</span> Generalizing to the Multivariate Case</a></li>
  <li><a href="#hotellings-t2-test" id="toc-hotellings-t2-test" class="nav-link" data-scroll-target="#hotellings-t2-test"><span class="header-section-number">4</span> Hotelling’s <span class="math inline">T^2</span> Test</a>
  <ul class="collapse">
  <li><a href="#hotellings-t2-statistic" id="toc-hotellings-t2-statistic" class="nav-link" data-scroll-target="#hotellings-t2-statistic"><span class="header-section-number">4.1</span> Hotelling’s <span class="math inline">T^2</span> Statistic</a></li>
  <li><a href="#the-f-distribution-connection" id="toc-the-f-distribution-connection" class="nav-link" data-scroll-target="#the-f-distribution-connection"><span class="header-section-number">4.2</span> The <span class="math inline">F</span>-Distribution Connection</a></li>
  <li><a href="#assumptions" id="toc-assumptions" class="nav-link" data-scroll-target="#assumptions"><span class="header-section-number">4.3</span> Assumptions</a></li>
  <li><a href="#example-sweat-data" id="toc-example-sweat-data" class="nav-link" data-scroll-target="#example-sweat-data"><span class="header-section-number">4.4</span> Example: Sweat Data</a></li>
  <li><a href="#exercise-iris-data" id="toc-exercise-iris-data" class="nav-link" data-scroll-target="#exercise-iris-data"><span class="header-section-number">4.5</span> Exercise: <code>Iris</code> data</a></li>
  </ul></li>
  <li><a href="#confidence-regions-for-boldsymbolmu" id="toc-confidence-regions-for-boldsymbolmu" class="nav-link" data-scroll-target="#confidence-regions-for-boldsymbolmu"><span class="header-section-number">5</span> Confidence Regions for <span class="math inline">\boldsymbol{\mu}</span></a>
  <ul class="collapse">
  <li><a href="#plot-confidence-ellipse-p2" id="toc-plot-confidence-ellipse-p2" class="nav-link" data-scroll-target="#plot-confidence-ellipse-p2"><span class="header-section-number">5.1</span> Plot Confidence Ellipse (<span class="math inline">p=2</span>)</a></li>
  </ul></li>
  <li><a href="#simultaneous-confidence-intervals" id="toc-simultaneous-confidence-intervals" class="nav-link" data-scroll-target="#simultaneous-confidence-intervals"><span class="header-section-number">6</span> Simultaneous Confidence Intervals</a>
  <ul class="collapse">
  <li><a href="#t2-cis" id="toc-t2-cis" class="nav-link" data-scroll-target="#t2-cis"><span class="header-section-number">6.1</span> <span class="math inline">T^2</span> CIs</a></li>
  <li><a href="#bonferroni-cis" id="toc-bonferroni-cis" class="nav-link" data-scroll-target="#bonferroni-cis"><span class="header-section-number">6.2</span> Bonferroni CIs</a></li>
  <li><a href="#comparison-of-confidence-region-t2-ci-and-bonferroni-ci" id="toc-comparison-of-confidence-region-t2-ci-and-bonferroni-ci" class="nav-link" data-scroll-target="#comparison-of-confidence-region-t2-ci-and-bonferroni-ci"><span class="header-section-number">6.3</span> Comparison of Confidence Region, <span class="math inline">T^2</span> CI and Bonferroni CI</a></li>
  <li><a href="#example-microwave-oven-data" id="toc-example-microwave-oven-data" class="nav-link" data-scroll-target="#example-microwave-oven-data"><span class="header-section-number">6.4</span> Example: Microwave Oven Data</a></li>
  </ul></li>
  <li><a href="#sec-LinearCombinations" id="toc-sec-LinearCombinations" class="nav-link" data-scroll-target="#sec-LinearCombinations"><span class="header-section-number">7</span> Inference for Linear Combinations of Means</a>
  <ul class="collapse">
  <li><a href="#repeated-measures" id="toc-repeated-measures" class="nav-link" data-scroll-target="#repeated-measures"><span class="header-section-number">7.1</span> Repeated Measures</a></li>
  <li><a href="#hotellings-t2-test-for-contrasts" id="toc-hotellings-t2-test-for-contrasts" class="nav-link" data-scroll-target="#hotellings-t2-test-for-contrasts"><span class="header-section-number">7.2</span> Hotelling’s <span class="math inline">T^2</span> Test for Contrasts</a></li>
  <li><a href="#confidence-regions-for-linear-combinations-of-means" id="toc-confidence-regions-for-linear-combinations-of-means" class="nav-link" data-scroll-target="#confidence-regions-for-linear-combinations-of-means"><span class="header-section-number">7.3</span> Confidence Regions for Linear Combinations of Means</a></li>
  <li><a href="#simultaneous-cis-for-linear-combinations-of-means" id="toc-simultaneous-cis-for-linear-combinations-of-means" class="nav-link" data-scroll-target="#simultaneous-cis-for-linear-combinations-of-means"><span class="header-section-number">7.4</span> Simultaneous CIs for Linear Combinations of Means</a></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">8</span> Exercises</a>
  <ul class="collapse">
  <li><a href="#exercise-1-iris-data-contd" id="toc-exercise-1-iris-data-contd" class="nav-link" data-scroll-target="#exercise-1-iris-data-contd"><span class="header-section-number">8.1</span> Exercise 1: <code>iris</code> Data, Cont’d</a></li>
  <li><a href="#exercise-2-dogs-anesthetics-study-contd" id="toc-exercise-2-dogs-anesthetics-study-contd" class="nav-link" data-scroll-target="#exercise-2-dogs-anesthetics-study-contd"><span class="header-section-number">8.2</span> Exercise 2: Dogs Anesthetics Study, Cont’d</a></li>
  <li><a href="#exercise-3-baseball-player-data" id="toc-exercise-3-baseball-player-data" class="nav-link" data-scroll-target="#exercise-3-baseball-player-data"><span class="header-section-number">8.3</span> Exercise 3: Baseball Player Data</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Inference for Mean Vector</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Pulong Ma </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="motivation" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="motivation"><span class="header-section-number">1</span> Motivation</h2>
<p>Let’s look at the famous <code>iris</code> dataset. We’ll focus on the <code>setosa</code> species and two variables: <code>Sepal Length</code> and <code>Sepal Width</code>.</p>
<p>A biologist might ask: “Is the mean vector of sepal measurements for <code>setosa</code> flowers equal to a specific standard, say <span class="math inline">\boldsymbol{\mu}_0 = [5.1, 3.6]'</span>?”</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Iris Data">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Iris Data
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DescTools) <span class="co"># For one-sample T2 test</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ellipse)   <span class="co"># For plotting confidence ellipses</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Isolate the setosa data for the first two variables</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>setosa_data <span class="ot">&lt;-</span> iris[iris<span class="sc">$</span>Species <span class="sc">==</span> <span class="st">"setosa"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(setosa_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Sepal.Length"</span>, <span class="st">"Sepal.Width"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(setosa_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Sepal.Length"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Sepal.Width"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"5.1","2":"3.5","_rn_":"1"},{"1":"4.9","2":"3.0","_rn_":"2"},{"1":"4.7","2":"3.2","_rn_":"3"},{"1":"4.6","2":"3.1","_rn_":"4"},{"1":"5.0","2":"3.6","_rn_":"5"},{"1":"5.4","2":"3.9","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The hypothesized mean vector</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>mu_0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">3.6</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the data</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(setosa_data, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Sepal.Width)) <span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"purple"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> mu_0[<span class="dv">1</span>], <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> mu_0[<span class="dv">2</span>], <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"point"</span>, <span class="at">x =</span> mu_0[<span class="dv">1</span>], <span class="at">y =</span> mu_0[<span class="dv">2</span>], <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">shape =</span> <span class="dv">4</span>, <span class="at">stroke =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Sepal Measurements for Iris Setosa"</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Red crosshairs show the hypothesized mean vector [5.1, 3.6]"</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Sepal Length (cm)"</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Sepal Width (cm)"</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-Inference_for_Means_files/figure-html/setup-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<section id="why-not-just-run-two-t-tests" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="why-not-just-run-two-t-tests"><span class="header-section-number">1.1</span> Why Not Just Run Two t-tests?</h3>
<p>The “naive” approach is to test each variable separately.</p>
<ol type="1">
<li>Test <span class="math inline">H_0: \mu_{\text{Length}} = 5.1 \quad \text{v.s.} \quad H_1: \mu_{\text{Length}} \neq 5.1</span></li>
<li>Test <span class="math inline">H_0: \mu_{\text{Width}} = 3.6 \quad \text{v.s.} \quad H_1: \mu_{\text{Width}} \neq 3.6</span></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="R code: one-sample $t$ test">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
R code: one-sample <span class="math inline">t</span> test
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test 1: Sepal Length</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(setosa_data<span class="sc">$</span>Sepal.Length, <span class="at">mu =</span> mu_0[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  setosa_data$Sepal.Length
t = -1.8857, df = 49, p-value = 0.06527
alternative hypothesis: true mean is not equal to 5.1
95 percent confidence interval:
 4.905824 5.106176
sample estimates:
mean of x 
    5.006 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test 2: Sepal Width</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(setosa_data<span class="sc">$</span>Sepal.Width, <span class="at">mu =</span> mu_0[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  setosa_data$Sepal.Width
t = -3.2085, df = 49, p-value = 0.002354
alternative hypothesis: true mean is not equal to 3.6
95 percent confidence interval:
 3.320271 3.535729
sample estimates:
mean of x 
    3.428 </code></pre>
</div>
</div>
</div>
</div>
</div>
<p><strong>Individually, we would reject both null hypotheses at <span class="math inline">\alpha = 0.05</span>. But this is misleading!</strong></p>
<div class="callout callout-style-default callout-important callout-titled" title="Why do we need a multivariate test?">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why do we need a multivariate test?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p><strong>The univariate approach doesn’t answer the right question.</strong> The research question is about the <strong>mean vector</strong> <span class="math inline">\boldsymbol{\mu}</span>, not the individual means. The two t-tests do not provide a single measure of evidence (one p-value) against the single hypothesis <span class="math inline">H_0: \boldsymbol{\mu} = \boldsymbol{\mu}_0</span>.</p></li>
<li><p><strong>It ignores the data’s structure.</strong> Sepal length and petal length are correlated. Taller flowers tend to have longer petals. The separate t-tests treat the variables as independent, which they are not. This ignores crucial information about the joint variability (or covariance) of the data.</p></li>
<li><p><strong>It cannot quantify the joint uncertainty.</strong> The true “distance” of the sample mean vector from the hypothesized mean vector can only be properly measured by accounting for the covariance between variables. We need a method that can create a single <strong>confidence region</strong> (an ellipse) for the mean vector, which is impossible with two separate confidence intervals.</p></li>
</ol>
<p>The multivariate approach provides a single, unified test for a single, unified hypothesis, while properly accounting for the relationships between the variables.</p>
</div>
</div>
</div>
</section>
<section id="the-family-wise-error-rate-problem" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="the-family-wise-error-rate-problem"><span class="header-section-number">1.2</span> The Family-Wise Error Rate Problem</h3>
<p>If we conduct <span class="math inline">p</span> tests, each at a significance level <span class="math inline">\alpha</span>, the probability of making <em>at least one</em> Type I error (a false positive) skyrockets.</p>
<p><span class="math display">
\text{Pr}(\text{rejecting at least one} \, H_0: \mu_j = \mu_{0j} \, | \, \text{all}\, H_0\text{'s are true})= 1 - (1 - \alpha)^p </span></p>
<ul>
<li>For our <span class="math inline">p=2</span> case with <span class="math inline">\alpha=0.05</span>, the true error rate is <span class="math inline">1 - (1-0.05)^2 = 0.0975</span>, nearly double our intended <span class="math inline">\alpha</span>!</li>
<li>This approach is very conservative (i.e., tends to reject more null hypotheses than we should).</li>
<li><strong>More importantly, this univariate approach completely ignores the correlation between variables.</strong> Multivariate methods account for this correlation structure.</li>
</ul>
</section>
</section>
<section id="review-of-univariate-inference" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="review-of-univariate-inference"><span class="header-section-number">2</span> Review of Univariate Inference</h2>
<p>The one-sample <span class="math inline">t</span>-test answers a very common question: “Is the average of my sample significantly different from a known or claimed value?”</p>
<p>Before we go multivariate, let’s review the one-sample <span class="math inline">t</span>-test for a mean <span class="math inline">\mu</span>.</p>
<div class="callout callout-style-default callout-note callout-titled" title="$t$-Test">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="math inline">t</span>-Test
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Hypotheses:</strong> <span class="math inline">H_0: \mu = \mu_0</span> <span class="math inline">H_1: \mu \neq \mu_0</span></li>
<li><strong>Test Statistic:</strong> <span class="math display"> t = \frac{\bar{x} - \mu_0}{s/\sqrt{n}} \sim t_{n-1} </span></li>
<li><strong>Confidence Interval:</strong> A <span class="math inline">100(1-\alpha)\%</span> CI for <span class="math inline">\mu</span> is: <span class="math display"> \bar{x} \pm t_{n-1, 1-\alpha/2} \frac{s}{\sqrt{n}} </span></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Decision approach">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Decision approach
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>To make the decision, we could either use the rejection region approach or the p-value approach.</p>
<ul>
<li><p><strong>Rejection Region</strong></p></li>
<li><p>If <span class="math inline">|t|&gt; |t_{n-1,1-\alpha/2}|</span>, we should reject <span class="math inline">H_0</span> at significance level <span class="math inline">\alpha</span>; otherwise, we fail to reject <span class="math inline">H_0</span> at significance level <span class="math inline">\alpha</span> and conclude there is no sufficient evidence to detect the difference.</p></li>
<li><p><strong>P-Value</strong></p></li>
<li><p>The p-value is the probability of seeing a result as extreme as yours (or more extreme) if the claim (in null hypothesis) were actually true.</p></li>
<li><p>Small p-value (typically &lt; 0.05): This result is very unlikely to happen by random chance alone. We reject the null hypothesis (H_0) and conclude there’s a significant difference at level <span class="math inline">\alpha</span> (e.g., 0.05).</p></li>
<li><p>Large p-value (typically ≥ 0.05): This result is reasonably likely to happen by random chance. The difference you saw could just be noise. We fail to reject the null hypothesis at level <span class="math inline">\alpha</span> (e.g., 0.05). There is no sufficient evidence from the data to indicate the null hypothesis is wrong.</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Example: Coffee Roaster">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example: Coffee Roaster
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let’s test the coffee roaster’s claim. We buy 10 bags and weigh them with data given by . We want to test if the true mean weight is different from the claimed 12 ounces.</p>
<ul>
<li>Null hypothesis: <span class="math inline">H_0</span>: ______</li>
<li>Alternative hypothesis <span class="math inline">H_1</span>: ______</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Our sample data: weights of 10 coffee bags in ounces</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>coffee_weights <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">11.8</span>, <span class="fl">12.1</span>, <span class="fl">11.4</span>, <span class="fl">11.7</span>, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">12.0</span>, <span class="fl">11.6</span>, <span class="fl">11.8</span>, <span class="fl">12.2</span>, </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">11.5</span>, <span class="fl">11.8</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># The hypothesized mean from the null hypothesis</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the one-sample t-test</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="at">x =</span> coffee_weights, <span class="at">mu =</span> mu0)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(test_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  coffee_weights
t = -2.5959, df = 9, p-value = 0.02893
alternative hypothesis: true mean is not equal to 12
95 percent confidence interval:
 11.607 11.973
sample estimates:
mean of x 
    11.79 </code></pre>
</div>
</div>
<p><strong>Interpreting the output</strong>:</p>
<ol type="1">
<li><span class="math inline">t=</span>-2.596: The sample mean is 2.596 standard errors <em>below</em> the hypothesized mean. That’s a moderately strong signal.</li>
<li>Conclusion: Since the p-value = 0.029 is less than the significant level <span class="math inline">\alpha=0.05</span>, we reject the null hypothesis. We conclude that the true mean weight of the coffee bags is significantly different from 12 ounces at level <span class="math inline">\alpha=0.05</span>.</li>
<li>95 percent confidence interval: [11.61, 11.97]: We are 95% confident that the true mean weight of all bags from this roaster is between 11.61 and 11.97 ounces. Notice that this interval does not contain 12, which confirms our decision to reject the null hypothesis.</li>
</ol>
</div>
</div>
</div>
</section>
<section id="generalizing-to-the-multivariate-case" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="generalizing-to-the-multivariate-case"><span class="header-section-number">3</span> Generalizing to the Multivariate Case</h2>
<p>We upgrade our tools from scalars to vectors and matrices.</p>
<ul>
<li>The <strong>sample mean vector</strong> <span class="math inline">\bar{\mathbf{x}}</span> is a vector of the individual sample means. <span class="math display"> \bar{\mathbf{x}} = \begin{bmatrix} \bar{x}_1 \\ \vdots \\ \bar{x}_p \end{bmatrix} </span></li>
<li>The <strong>sample covariance matrix</strong> <span class="math inline">\mathbf{S}</span> contains the sample variances on its diagonal and the sample covariances on its off-diagonals. <span class="math display"> \mathbf{S} = \frac{1}{n-1} \sum_{j=1}^{n} (\mathbf{x}_j - \bar{\mathbf{x}})(\mathbf{x}_j - \bar{\mathbf{x}})^\top
  </span></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="R Code">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
R Code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample size</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(setosa_data)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of variables</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(setosa_data)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample mean vector</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>x_bar <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(setosa_data)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sample Mean Vector (x_bar):"</span>, x_bar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Sample Mean Vector (x_bar): 5.006 3.428</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample covariance matrix</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">cov</span>(setosa_data)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sample Covariance Matrix (S):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Sample Covariance Matrix (S):</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>S</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             Sepal.Length Sepal.Width
Sepal.Length   0.12424898  0.09921633
Sepal.Width    0.09921633  0.14368980</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="hotellings-t2-test" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="hotellings-t2-test"><span class="header-section-number">4</span> Hotelling’s <span class="math inline">T^2</span> Test</h2>
<p>This is the multivariate workhorse, analogous to the squared <span class="math inline">t</span>-statistic.</p>
<section id="hotellings-t2-statistic" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="hotellings-t2-statistic"><span class="header-section-number">4.1</span> Hotelling’s <span class="math inline">T^2</span> Statistic</h3>
<p>Hotelling’s <span class="math inline">T^2</span> statistic measures the “distance” between the sample mean vector <span class="math inline">\bar{\mathbf{x}}</span> and the hypothesized mean vector <span class="math inline">\boldsymbol{\mu}_0</span>, accounting for sample size and covariance.</p>
<p><span class="math display"> T^2 = n(\bar{\mathbf{x}} - \boldsymbol{\mu}_0)^\top \mathbf{S}^{-1} (\bar{\mathbf{x}} - \boldsymbol{\mu}_0) </span></p>
</section>
<section id="the-f-distribution-connection" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="the-f-distribution-connection"><span class="header-section-number">4.2</span> The <span class="math inline">F</span>-Distribution Connection</h3>
<p>The <span class="math inline">T^2</span> statistic is not directly used. Instead, it is rescaled to a familiar <span class="math inline">F</span>-statistic. Under <span class="math inline">H_0: \boldsymbol{\mu} = \boldsymbol{\mu}_0</span>,</p>
<p><span class="math display"> \frac{n-p}{p(n-1)} T^2 \, \overset{H_0}\sim\, F_{p, n-p} </span></p>
<p>We reject <span class="math inline">H_0</span> if our calculated F-statistic (or scaled <span class="math inline">T^2</span> statistic) is greater than the critical value <span class="math inline">F_{p, n-p, 1-\alpha}</span> at significance level <span class="math inline">\alpha</span>.</p>
</section>
<section id="assumptions" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="assumptions"><span class="header-section-number">4.3</span> Assumptions</h3>
<ol type="1">
<li>The observations <span class="math inline">\mathbf{x}_1, \dots, \mathbf{x}_n</span> are independently drawn from the same population distribution.</li>
<li>The population distribution is multivariate normal (MVN): <span class="math inline">\mathbf{x}_i \overset{iid}{\sim} N_p(\boldsymbol{\mu}, {\Sigma}), i=1,\ldots, n</span>.</li>
</ol>
</section>
<section id="example-sweat-data" class="level3" data-number="4.4">
<h3 data-number="4.4" class="anchored" data-anchor-id="example-sweat-data"><span class="header-section-number">4.4</span> Example: Sweat Data</h3>
<p>A study measured sweat rate, sodium content, and potassium content for 20 healthy females. Let’s test if the mean vector is <span class="math inline">\boldsymbol{\mu}_0 = [4, 50, 10]^\top</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sweat data</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>sweat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rate =</span> <span class="fu">c</span>(<span class="fl">3.7</span>, <span class="fl">5.7</span>, <span class="fl">3.8</span>, <span class="fl">3.2</span>, <span class="fl">3.1</span>, <span class="fl">4.6</span>, <span class="fl">6.2</span>, <span class="fl">3.4</span>, <span class="fl">4.1</span>, <span class="fl">5.5</span>, <span class="fl">6.5</span>, <span class="fl">4.5</span>, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>             <span class="fl">3.9</span>, <span class="fl">4.5</span>, <span class="fl">6.2</span>, <span class="fl">4.1</span>, <span class="fl">5.5</span>, <span class="fl">6.0</span>, <span class="fl">5.2</span>, <span class="fl">4.8</span>),</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sodium =</span> <span class="fu">c</span>(<span class="fl">48.5</span>, <span class="fl">65.1</span>, <span class="fl">47.2</span>, <span class="fl">31.1</span>, <span class="fl">59.8</span>, <span class="fl">37.8</span>, <span class="fl">52.8</span>, <span class="fl">43.2</span>, <span class="fl">45.1</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>               <span class="fl">50.3</span>, <span class="fl">58.3</span>, <span class="fl">40.2</span>, <span class="fl">38.9</span>, <span class="fl">48.8</span>, <span class="fl">60.1</span>, <span class="fl">44.5</span>, <span class="fl">55.5</span>, <span class="fl">59.9</span>, </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>               <span class="fl">57.7</span>, <span class="fl">51.0</span>),</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Potassium =</span> <span class="fu">c</span>(<span class="fl">9.3</span>, <span class="fl">11.1</span>, <span class="fl">9.6</span>, <span class="fl">9.8</span>, <span class="fl">8.0</span>, <span class="fl">10.9</span>, <span class="fl">12.2</span>, <span class="fl">8.5</span>, <span class="fl">9.2</span>, </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                  <span class="fl">10.4</span>, <span class="fl">11.2</span>, <span class="fl">9.7</span>, <span class="fl">8.8</span>, <span class="fl">10.1</span>, <span class="fl">12.3</span>, <span class="fl">9.5</span>, <span class="fl">11.3</span>, <span class="fl">12.0</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                  <span class="fl">10.8</span>, <span class="fl">10.5</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>mu0_sweat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">50</span>, <span class="dv">10</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(sweat) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Step 1: Normality Check">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Step 1: Normality Check
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Q-Q plot</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through the first 3 column names and create a plot for each</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col_name <span class="cf">in</span> <span class="fu">colnames</span>(sweat)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]) {</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqnorm</span>(sweat[[col_name]], <span class="at">main =</span> col_name)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqline</span>(sweat[[col_name]], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-Inference_for_Means_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute Shapiro-Wilk statistic to test normality for each variable</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(<span class="fu">colnames</span>(sweat[ ,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]), <span class="cf">function</span>(x) {</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>               <span class="fu">shapiro.test</span>(sweat[[x]]) } )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          x1                            x2                           
statistic 0.9483909                     0.9757974                    
p.value   0.3433242                     0.8692117                    
method    "Shapiro-Wilk normality test" "Shapiro-Wilk normality test"
data.name "sweat[[x]]"                  "sweat[[x]]"                 
          x3                           
statistic 0.9759253                    
p.value   0.8714673                    
method    "Shapiro-Wilk normality test"
data.name "sweat[[x]]"                 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Perform multivariate normality test</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvShapiroTest)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mvShapiro.Test</span>(<span class="fu">as.matrix</span>(sweat[ , <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Generalized Shapiro-Wilk test for Multivariate Normality by
    Villasenor-Alva and Gonzalez-Estrada

data:  as.matrix(sweat[, 1:3])
MVW = 0.96404, p-value = 0.7893</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Step 2: Calculate Sample Statistics">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Step 2: Calculate Sample Statistics
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manual Calculation</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>n_sweat <span class="ot">&lt;-</span> <span class="fu">nrow</span>(sweat)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>p_sweat <span class="ot">&lt;-</span> <span class="fu">ncol</span>(sweat)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>x_bar_sweat <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(sweat)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>S_sweat <span class="ot">&lt;-</span> <span class="fu">cov</span>(sweat)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>S_inv_sweat <span class="ot">&lt;-</span> <span class="fu">solve</span>(S_sweat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Step 3: Compute Hotelling's $T^2$ Statistic">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Step 3: Compute Hotelling’s <span class="math inline">T^2</span> Statistic
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># manual calculation </span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>diff_vec <span class="ot">&lt;-</span> x_bar_sweat <span class="sc">-</span> mu0_sweat</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>T2_manual <span class="ot">&lt;-</span> n_sweat <span class="sc">*</span> <span class="fu">t</span>(diff_vec) <span class="sc">%*%</span> S_inv_sweat <span class="sc">%*%</span> diff_vec</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Manually calculated T-squared:"</span>, <span class="fu">as.numeric</span>(T2_manual), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Manually calculated T-squared: 43.50518 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Convert to F-statistic or scaled T-square statistic </span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>F_stat <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(T2_manual) <span class="sc">*</span> (n_sweat <span class="sc">-</span> p_sweat) <span class="sc">/</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  (p_sweat <span class="sc">*</span> (n_sweat <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Calculated F-statistic:"</span>, F_stat, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Calculated F-statistic: 12.97523 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Find critical value</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>F_crit <span class="ot">&lt;-</span> <span class="fu">qf</span>(<span class="dv">1</span> <span class="sc">-</span> alpha, p_sweat, n_sweat <span class="sc">-</span> p_sweat)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Critical F-value:"</span>, F_crit, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Critical F-value: 3.196777 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Decision:"</span>, </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(F_stat <span class="sc">&gt;</span> F_crit, <span class="st">"Reject H0"</span>, <span class="st">"Do not reject H0"</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Decision: Reject H0 </code></pre>
</div>
</div>
<p><strong>Conclusion:</strong> Since our F-statistic (12.98) is much larger than the critical F-value (3.197), we <strong>reject the null hypothesis</strong> at level <span class="math inline">\alpha=0.05</span>. The mean sweat composition is significantly different from <span class="math inline">[4, 50, 10]^\top</span>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Hotelling's $T^2$ Test">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hotelling’s <span class="math inline">T^2</span> Test
</div>
</div>
<div class="callout-body-container callout-body">
<p>The manual calculations in <strong>Step 2-3</strong> above can be completed using R package <code>DescTools</code> after normality check. If the data follows a multivariate normal distribution, then we can perform the Hotelling’s <span class="math inline">T^2</span> test; if the normality assumption is violated, the conclusion is misleading and this limitation should be acknowledged.</p>
<div class="cell">
<details class="code-fold">
<summary>R code for Hotelling’s T2 test</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("DescTools")</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DescTools)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>ht_sweat <span class="ot">&lt;-</span> <span class="fu">HotellingsT2Test</span>(<span class="at">x=</span>sweat, <span class="at">mu =</span> mu0_sweat)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ht_sweat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Hotelling's one sample T2-test

data:  sweat
T.2 = 12.975, df1 = 3, df2 = 17, p-value = 0.0001177
alternative hypothesis: true location is not equal to c(4,50,10)</code></pre>
</div>
</div>
<p><strong>Note</strong>: At this point we do not know which of the two hypothesized mean values is not supported by the data.</p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled" title="R Function `HotellingsT2Test`">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
R Function <code>HotellingsT2Test</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>When the function <code>HotellingsT2Test</code> in the R package <code>DescTools</code> is used to perform the test, its output reports the <strong>scaled</strong> <span class="math inline">T^2</span> statistic (or <span class="math inline">F</span> statistic) named <em>T.2</em> (which is 12.975 in this example). This scaled <span class="math inline">T^2</span> statistic should not be confused with the <span class="math inline">T^2</span> statistic as the scaled <span class="math inline">T^2</span> statistic is <span class="math inline">\frac{n-p}{p(n-1)}T^2</span>.</p>
</div>
</div>
</section>
<section id="exercise-iris-data" class="level3" data-number="4.5">
<h3 data-number="4.5" class="anchored" data-anchor-id="exercise-iris-data"><span class="header-section-number">4.5</span> Exercise: <code>Iris</code> data</h3>
<p><strong>Background</strong></p>
<p>Ronald Fisher’s <code>iris</code> dataset is a cornerstone of statistical analysis. Imagine a historical botanical guide from the 1930s describes the “type specimen” for the <em>Iris setosa</em> species as having a mean <strong>Sepal Length</strong> of <strong>5.1 cm</strong> and a mean <strong>Sepal Width</strong> of <strong>3.6 cm</strong>.</p>
<p>Your task is to determine if the sample of 50 <em>Iris setosa</em> flowers from Fisher’s dataset is consistent with this historical description. You will use a Hotelling’s T² test with a significance level of <span class="math inline">\alpha = 0.05</span>.</p>
<p><strong>1. State the Hypotheses</strong></p>
<p>Write the <strong>null hypothesis (<span class="math inline">H_0</span>)</strong> and the <strong>alternative hypothesis (<span class="math inline">H_1</span>)</strong> for this test. Let <span class="math inline">\boldsymbol{\mu}</span> represent the true mean vector of <code>[Sepal.Length, Sepal.Width]</code>.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="View Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The hypotheses are formulated as:</p>
<ul>
<li><p><strong>Null Hypothesis (<span class="math inline">H_0</span>)</strong>: The true mean sepal measurements are equal to the historical description. <span class="math display">H_0: \boldsymbol{\mu} = \begin{bmatrix} 5.1 \\ 3.6 \end{bmatrix}</span></p></li>
<li><p><strong>Alternative Hypothesis (<span class="math inline">H_1</span>)</strong>: The true mean sepal measurements are not equal to the historical description. <span class="math display">H_1: \boldsymbol{\mu} \neq \begin{bmatrix} 5.1 \\ 3.6 \end{bmatrix}</span></p></li>
</ul>
</div>
</div>
</div>
<p><strong>2. Prepare and Visualize the Data</strong></p>
<p>Load the necessary R packages. From the built-in <code>iris</code> dataset, create a final data frame containing only the <code>Sepal.Length</code> and <code>Sepal.Width</code> for the <code>setosa</code> species.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="View Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>R Code: Data Preparation</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the packages needed for the entire analysis</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the final data frame for analysis</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>setosa_data <span class="ot">&lt;-</span> iris <span class="sc">%&gt;%</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Species <span class="sc">==</span> <span class="st">"setosa"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Sepal.Length, Sepal.Width)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> setosa_data</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the first few rows of the prepared data</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Sepal.Length"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Sepal.Width"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"5.1","2":"3.5","_rn_":"1"},{"1":"4.9","2":"3.0","_rn_":"2"},{"1":"4.7","2":"3.2","_rn_":"3"},{"1":"4.6","2":"3.1","_rn_":"4"},{"1":"5.0","2":"3.6","_rn_":"5"},{"1":"5.4","2":"3.9","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details class="code-fold">
<summary>R Code: Data Preparation</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-Inference_for_Means_files/figure-html/data-prep-iris-final-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p><strong>3. Perform the Statistical Test</strong></p>
<p>Run a one-sample Hotelling’s T<span class="math inline">^2</span> test on your prepared data using the historical description as your hypothesized mean vector.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="View Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>R Code: Hotelling’s T-squared Test</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the hypothesized mean vector from the historical guide</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>hypothesized_mean <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">3.6</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the test</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>test_result <span class="ot">&lt;-</span> DescTools<span class="sc">::</span><span class="fu">HotellingsT2Test</span>(</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> setosa_data, </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">mu =</span> hypothesized_mean)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(test_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Hotelling's one sample T2-test

data:  setosa_data
T.2 = 5.3116, df1 = 2, df2 = 48, p-value = 0.008244
alternative hypothesis: true location is not equal to c(5.1,3.6)</code></pre>
</div>
</div>
</div>
</div>
</div>
<p><strong>4. Interpret the Results</strong></p>
<p>What is the p-value from your test? Based on this and <span class="math inline">\alpha = 0.05</span>, do you reject or fail to reject the null hypothesis? State your conclusion in the context of the problem.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="View Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The p-value is 0.008244. Since this p-value is less than our significance level of <span class="math inline">\alpha = 0.05</span>, we <strong>should reject the null hypothesis at level 0.05</strong>.</p>
<p><strong>Conclusion:</strong> There is enough statistical evidence to conclude that the mean sepal measurements of the <code>setosa</code> flowers in Fisher’s dataset are different from the historical description. The benchmark of 5.1 cm length and 4.2 cm width is not a plausible value for the true mean of this sample.</p>
</div>
</div>
</div>
<p><strong>5. Visualize Your Conclusion</strong></p>
<p>Create a scatter plot of <code>Sepal.Width</code> v.s. <code>Sepal.Length</code>. On the plot, mark the sample mean, the hypothesized mean, and add the 95% confidence ellipse. Explain how it supports your conclusion.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="View Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>R Code: Visualization</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the sample mean and sample covariance </span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>x_bar <span class="ot">=</span> <span class="fu">colMeans</span>(df)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>S <span class="ot">=</span> <span class="fu">cov</span>(df)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate points for the 95% confidence ellipse</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>Fvalue <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (n <span class="sc">-</span> p) <span class="sc">*</span> <span class="fu">qf</span>(<span class="dv">1</span> <span class="sc">-</span> alpha, p, n <span class="sc">-</span> p))</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>confidence_ellipse <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ellipse<span class="sc">::</span><span class="fu">ellipse</span>(</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  S,</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">centre =</span> x_bar,</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">level =</span> <span class="fl">0.95</span>,</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">t =</span> Fvalue <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Sepal.Width)) <span class="sc">+</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"purple"</span>,</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> confidence_ellipse,</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Sepal.Width),</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span>,</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"point"</span>,</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> x_bar[<span class="dv">1</span>],</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> x_bar[<span class="dv">2</span>],</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span>,</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">"text"</span>,</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> x_bar[<span class="dv">1</span>],</span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> x_bar[<span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.03</span>,</span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Sample Mean"</span>,</span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span></span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">"point"</span>,</span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> hypothesized_mean[<span class="dv">1</span>],</span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> hypothesized_mean[<span class="dv">2</span>],</span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">4</span>,</span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">stroke =</span> <span class="fl">1.5</span></span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">"text"</span>,</span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> hypothesized_mean[<span class="dv">1</span>],</span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> hypothesized_mean[<span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.03</span>,</span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Historical Description"</span>,</span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span></span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Iris Setosa Sepal Measurements"</span>,</span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Hotelling's T² test vs. Historical Description"</span>,</span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Sepal Length (cm)"</span>,</span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Sepal Width (cm)"</span></span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-Inference_for_Means_files/figure-html/visualize-result-iris-final-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Comparison of the Iris setosa sample to a historical description.</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Visual Interpretation:</strong> The plot confirms the test result. The red cross (the historical description) lies <strong>outside</strong> the blue 95% confidence ellipse. Since the hypothesized value is outside the confidence region of plausible values for the true mean, it visually supports our conclusion to reject the null hypothesis.</p>
</div>
</div>
</div>
</section>
</section>
<section id="confidence-regions-for-boldsymbolmu" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="confidence-regions-for-boldsymbolmu"><span class="header-section-number">5</span> Confidence Regions for <span class="math inline">\boldsymbol{\mu}</span></h2>
<p>A confidence interval for a single mean becomes a <strong>confidence region</strong> (an ellipse for <span class="math inline">p=2</span>, an ellipsoid for <span class="math inline">p&gt;2</span>) for a mean vector. This confidence region is also known as <strong>joint confidence</strong>.</p>
<p>A <span class="math inline">100(1-\alpha)\%</span> confidence region for <span class="math inline">\boldsymbol{\mu}</span> is the set of all vectors <span class="math inline">\boldsymbol \mu</span> satisfying: <span class="math display"> n(\bar{\mathbf{x}} - \boldsymbol{\mu})^\top {S}^{-1} (\bar{\mathbf{x}} - \boldsymbol{\mu}) \le \frac{p(n-1)}{n-p} F_{p, n-p, 1-\alpha} </span></p>
<div class="callout callout-style-default callout-note callout-titled" title="Confidence Region">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Confidence Region
</div>
</div>
<div class="callout-body-container callout-body">
<p>The confidence region forms an ellipsoid. Its shape and orientation are determined by the eigenvalues and eigenvectors of the sample covariance matrix <span class="math inline">{S}</span>.</p>
<ul>
<li>The center of the ellipsoid is <span class="math inline">\bar{\mathbf{x}}</span>.</li>
<li>The distance from the center of the ellipsoid to the edge of the ellipsoid along the <span class="math inline">i</span>-th axis is <span class="math display">
\pm \sqrt{\lambda_i} \sqrt{\frac{(n-1)p}{n(n-p)}F_{(p, n-p), 1-\alpha}}.
</span></li>
<li>The directions of the eigenvectors and sizes of the eigenvalues depend on
<ul>
<li>the relative sizes of the variances of the measured variables</li>
<li>the sizes of the correlations between pairs of variables</li>
</ul></li>
</ul>
</div>
</div>
<section id="plot-confidence-ellipse-p2" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="plot-confidence-ellipse-p2"><span class="header-section-number">5.1</span> Plot Confidence Ellipse (<span class="math inline">p=2</span>)</h3>
<p>Let’s plot the 95% confidence ellipse for our <code>setosa</code> variable</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-Inference_for_Means_files/figure-html/plot-ellipse-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>95% confidence ellipse for the true mean vector of Setosa sepal measurements. The sample mean is the blue dot, and the hypothesized mean is the red cross.</figcaption>
</figure>
</div>
</div>
</div>
<p>Our hypothesized mean (red cross) falls outside the 95% confidence ellipse, which is consistent with rejecting the null hypothesis in the Hotelling’s <span class="math inline">T^2</span> test.</p>
</section>
</section>
<section id="simultaneous-confidence-intervals" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="simultaneous-confidence-intervals"><span class="header-section-number">6</span> Simultaneous Confidence Intervals</h2>
<p>If we reject <span class="math inline">H_0</span>, we want to know <em>which</em> variables contributed to the rejection. We need CIs that hold simultaneously for all <span class="math inline">p</span> variables with confidence level at least <span class="math inline">1-\alpha</span>.</p>
<section id="t2-cis" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="t2-cis"><span class="header-section-number">6.1</span> <span class="math inline">T^2</span> CIs</h3>
<p>The <span class="math inline">T^2</span> confidence intervals are derived from the Hotelling’s <span class="math inline">T^2</span> statistic. For each component <span class="math inline">\mu_i</span>: <span class="math display"> \bar{x}_i \pm \sqrt{\frac{p(n-1)}{n-p} F_{p, n-p, 1-\alpha}} \sqrt{\frac{s_{ii}}{n}} </span> where <span class="math inline">s_{ii}</span> is the <span class="math inline">(i,i)</span>-th entry of <span class="math inline">{S}</span>.</p>
</section>
<section id="bonferroni-cis" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="bonferroni-cis"><span class="header-section-number">6.2</span> Bonferroni CIs</h3>
<p>Another way to construct individual confidence intervals for each <span class="math inline">\mu_i</span> is to use the <span class="math inline">t</span>-interval, but the combined set of individual <span class="math inline">t</span> intervals result in a simulatenous confidence level that is <strong><em>less than</em></strong> than the normal level <span class="math inline">1-\alpha</span>.</p>
<p>To avoid this limitation, one can use the so-called Bonferroni confidence intervals: <span class="math display"> \bar{x}_i \pm t_{n-1, 1- \alpha/(2p)} \sqrt{\frac{s_{ii}}{n}} </span> where <span class="math inline">p</span> is the number of variables to be estimated.</p>
<div class="callout callout-style-default callout-note callout-titled" title="One-At-a-Time $t$ CI">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
One-At-a-Time <span class="math inline">t</span> CI
</div>
</div>
<div class="callout-body-container callout-body">
<p>Using the univariate approach, we can construct <span class="math inline">t</span>-intervals for each of mean differences, and obtain the so-called <strong><em>one-at-a-time</em></strong> <span class="math inline">t</span> intervals: <span class="math display">
\bar{x}_i \pm t_{n-1, 1- \alpha/2} \sqrt{\frac{s_{ii}}{n}}
</span> The one-at-a-time CI does not control the family-wise error at <span class="math inline">\alpha</span> or the confidence level at least at the nominal level <span class="math inline">1-\alpha</span>. Bonferroni CI corrects the one-at-a-time CI and produces a set of CIs that jointly have the confidence level at least <span class="math inline">1-\alpha</span>.</p>
</div>
</div>
</section>
<section id="comparison-of-confidence-region-t2-ci-and-bonferroni-ci" class="level3" data-number="6.3">
<h3 data-number="6.3" class="anchored" data-anchor-id="comparison-of-confidence-region-t2-ci-and-bonferroni-ci"><span class="header-section-number">6.3</span> Comparison of Confidence Region, <span class="math inline">T^2</span> CI and Bonferroni CI</h3>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-Inference_for_Means_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>95% joint confidence region (ellipse) with rectangles for T-squared intervals (red shaped area) and Bonferroni simultaneous intervals (purple shaped area).</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="example-microwave-oven-data" class="level3" data-number="6.4">
<h3 data-number="6.4" class="anchored" data-anchor-id="example-microwave-oven-data"><span class="header-section-number">6.4</span> Example: Microwave Oven Data</h3>
<p>Manufacturers of a microwave oven are concerned about radiation emission. They measure radiation with the door closed and open from <span class="math inline">n=12</span> ovens. Test if the mean radiation levels are <span class="math inline">\boldsymbol{\mu}_0 = [0.15, 0.20]'</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate some plausible data</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4750</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>oven_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Closed =</span> <span class="fu">rnorm</span>(<span class="dv">12</span>, <span class="at">mean =</span> <span class="fl">0.25</span>, <span class="at">sd =</span> <span class="fl">0.08</span>),</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Open =</span> <span class="fu">rnorm</span>(<span class="dv">12</span>, <span class="at">mean =</span> <span class="fl">0.30</span>, <span class="at">sd =</span> <span class="fl">0.10</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">=</span> oven_data</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="State The Hypotheses">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
State The Hypotheses
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\boldsymbol \mu = (\mu_1, \mu_2)^\top</span> represents the mean radiation levels corresponding to door closed and door open conditions. The historical standard or hypothesized mean vector is <span class="math inline">\boldsymbol \mu_0</span>. The hypotheses are <span class="math display">
H_0: \boldsymbol \mu  = \boldsymbol \mu_0 \quad \text{v.s.} \quad H_1: \boldsymbol \mu \neq \boldsymbol \mu_0
</span></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Compute Test Statistic">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Compute Test Statistic
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If we do a manual calculation, we need to compute the Hotelling’s <span class="math inline">T^2</span> test</p>
<div class="cell">
<details class="code-fold">
<summary>R Code: T<span class="math inline">^2</span> Statistic</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>xbar <span class="ot">=</span> <span class="fu">colMeans</span>(dat)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>S <span class="ot">=</span> <span class="fu">cov</span>(<span class="fu">as.matrix</span>(dat))</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">nrow</span>(dat)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">ncol</span>(dat)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>T2 <span class="ot">=</span> n<span class="sc">*</span><span class="fu">t</span>(xbar<span class="sc">-</span>mu0)<span class="sc">%*%</span><span class="fu">solve</span>(S)<span class="sc">%*%</span>(xbar<span class="sc">-</span>mu0)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>scaledT2 <span class="ot">=</span> (n<span class="sc">-</span>p)<span class="sc">/</span>(p<span class="sc">*</span>(n<span class="dv">-1</span>))<span class="sc">*</span><span class="fu">drop</span>(T2)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>F_crit <span class="ot">=</span>  <span class="fu">qf</span>(<span class="fl">0.95</span>, p, n<span class="sc">-</span>p)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(scaledT2<span class="sc">&gt;</span>F_crit){</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">" scaled T2="</span>, <span class="fu">signif</span>(scaledT2,<span class="dv">3</span>)),<span class="st">"&gt;"</span>, </span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"F critical value="</span>, <span class="fu">signif</span>(F_crit,<span class="dv">3</span>)), </span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>      <span class="st">", thus we reject H0 at level 0.05"</span>)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>}<span class="cf">else</span>{</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">" scaled T2="</span>, <span class="fu">signif</span>(scaledT2,<span class="dv">3</span>)),<span class="st">"&lt;"</span>, </span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"F critical value="</span>, <span class="fu">signif</span>(F_crit,<span class="dv">3</span>)), </span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">", thus we fail to reject H0 at level 0.05"</span>)</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> scaled T2=13.5 &gt; F critical value=4.1 , thus we reject H0 at level 0.05</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>R Code: Use <code>HotellingsT2Test</code></summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, run the T2 test</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>T2result <span class="ot">&lt;-</span> <span class="fu">HotellingsT2Test</span>(<span class="at">x=</span>dat, <span class="at">mu =</span> mu0)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(T2result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Hotelling's one sample T2-test

data:  dat
T.2 = 13.464, df1 = 2, df2 = 10, p-value = 0.001456
alternative hypothesis: true location is not equal to c(0.15,0.2)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Simultaneous $T^2$ CIs">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Simultaneous <span class="math inline">T^2</span> CIs
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>R Code: Simultaneous T2 CIs</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The p-value is tiny, so we reject H0. Let's find out why.</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>s_ii <span class="ot">&lt;-</span> <span class="fu">diag</span>(S)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># T2-based intervals</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>T2_multiplier <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (n <span class="sc">-</span> p) <span class="sc">*</span> F_crit)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>T2_margins <span class="ot">&lt;-</span> T2_multiplier <span class="sc">*</span> <span class="fu">sqrt</span>(s_ii <span class="sc">/</span> n)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>T2_intervals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> <span class="fu">names</span>(oven_data),</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lower =</span> xbar <span class="sc">-</span> T2_margins,</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Upper =</span> xbar <span class="sc">+</span> T2_margins</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"95% T-squared Simultaneous CIs:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "95% T-squared Simultaneous CIs:"</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>       Variable     Lower     Upper
Closed   Closed 0.1829773 0.2941655
Open       Open 0.1688177 0.3802530</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Simultaneous Bonferroni CIs">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Simultaneous Bonferroni CIs
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>R Code: Simultaneous Bonferroni CIs</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bonferroni-based intervals</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>bonf_multiplier <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span> <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> p), <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>bonf_margins <span class="ot">&lt;-</span> bonf_multiplier <span class="sc">*</span> <span class="fu">sqrt</span>(s_ii <span class="sc">/</span> n)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>bonf_intervals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> <span class="fu">names</span>(dat),</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lower =</span> xbar <span class="sc">-</span> bonf_margins,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Upper =</span> xbar <span class="sc">+</span> bonf_margins</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"95% Bonferroni Simultaneous CIs:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "95% Bonferroni Simultaneous CIs:"</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>       Variable     Lower     Upper
Closed   Closed 0.1905876 0.2865551
Open       Open 0.1832896 0.3657812</code></pre>
</div>
</div>
<p><strong>Conclusion:</strong> Both methods produce very similar intervals. Neither the interval for “Closed” nor “Open” contains its hypothesized mean (0.15 and 0.20, respectively). Therefore, we conclude that <em>both</em> mean radiation levels are significantly higher than the specified standards. Note that the Bonferroni CIs are slightly narrower (more precise), which is often the case.</p>
</div>
</div>
</div>
</section>
</section>
<section id="sec-LinearCombinations" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="sec-LinearCombinations"><span class="header-section-number">7</span> Inference for Linear Combinations of Means</h2>
<p>In many scientific applications, one is interested in making statistical inference for a linear combination of the mean components (also called <em>mean contrast</em>) based on multivariate data. In such applications, we can test hypotheses about any linear combination of the mean components, <span class="math inline">H_0: \mathbf{c}'\boldsymbol{\mu} = c_0</span>. One can still apply previous methods to perform the test. This is useful for testing things like “Is the average of all means equal to 5?” or “Is the difference between mean 1 and mean 2 equal to zero?”</p>
<div class="callout callout-style-default callout-note callout-titled" title="Dogs Anesthetics Study (J. &amp; W. 2007)">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Dogs Anesthetics Study (J. &amp; W. 2007)
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Background</strong></p>
<p>A study was conducted on a sample of 19 dogs to evaluate the effect of CO2 pressure and the anesthetic halothane on heart rate. Each dog was then administered carbon dioxide CO2 at each of two pressure levels. Next, halothane (H) was added and then administration of CO2 was repeated. There was a washout period (several weeks) between the use of one anesthetic and the use of another anesthetic. The response variable is the time in milliseconds between heartbeats. The data were obtained by measuring the response under four treatment combinations: (1) high CO2 pressure, (2) low CO2 pressure, (3) high pressure + halothane, and (4) low pressure + halothane.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>dogdat <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"dogs.dat"</span>,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">col.names=</span><span class="fu">c</span>(<span class="st">"dog"</span>, <span class="st">"HighCO2"</span>, <span class="st">"LowCO2"</span>, </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"HighCO2H"</span>, <span class="st">"LowCO2H"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"HighCO2"</span>, <span class="st">"LowCO2"</span>, </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">"HighCO2H"</span>, <span class="st">"LowCO2H"</span>), as.numeric))</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dogdat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["dog"],"name":[1],"type":["int"],"align":["right"]},{"label":["HighCO2"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["LowCO2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["HighCO2H"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["LowCO2H"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"426","3":"609","4":"556","5":"600","_rn_":"1"},{"1":"2","2":"253","3":"236","4":"392","5":"395","_rn_":"2"},{"1":"3","2":"359","3":"433","4":"349","5":"357","_rn_":"3"},{"1":"4","2":"432","3":"431","4":"522","5":"600","_rn_":"4"},{"1":"5","2":"405","3":"426","4":"513","5":"513","_rn_":"5"},{"1":"6","2":"324","3":"438","4":"507","5":"539","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Experimental Setup">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Experimental Setup
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Design: <span class="math inline">p=4</span> treatments are assigned to the same experimental unit. In total, there are <span class="math inline">n= 19</span> experimental units.</li>
<li>Objective: our interest is to formally assess whether there is significant difference between the two corresponding mean responses.</li>
<li>Mean responses: Let <span class="math inline">\mu_j</span> denote the mean response under treatment <span class="math inline">j</span>, where <span class="math inline">j=1,\ldots, 4</span>. <span class="math inline">\boldsymbol \mu = (\mu_1, \ldots, \mu_p)^\top</span> is a vector of mean responses over all <span class="math inline">p</span> treatments (high CO2, low CO2, high CO2 + halothane, low CO2 + halothane).</li>
<li>Data: Let <span class="math inline">\mathbf{x}_i=(x_{i1}, x_{i2}, \ldots, x_{ip})^\top</span> denote the response variable for the <span class="math inline">i</span>-th experimental unit under all the <span class="math inline">p</span> treatments, where <span class="math inline">i=1, \ldots, n</span>.</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Research Questions">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-26-contents" aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Research Questions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-26" class="callout-26-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>As we want to assess whether there is significant difference between the two corresponding mean responses, we are interested in testing three specific effects simultaneously:</p>
<ol type="1">
<li>Is there a main effect of halothane?</li>
<li>Is there a main effect of CO2?</li>
<li>Is there an interaction effect?</li>
</ol>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Step 1: Prepare and Visualize the Data">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-27-contents" aria-controls="callout-27" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Step 1: Prepare and Visualize the Data
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-27" class="callout-27-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">as.matrix</span>(dogdat[ ,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  Display a scatterplot matrix</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>GGally<span class="sc">::</span><span class="fu">ggpairs</span>(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-Inference_for_Means_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation</strong>: The smoothed histograms on the diagonal of the scatterplot matrix show unimodal distributions, but the responses to the high CO2 anesthetic appear to be skewed left and tails of the distributions appear to be truncated relative to normal distributions. The scatter plots show nearly elliptically shaped data clouds, however, with approximately straight line trends. Consequently, the pairwise correlations appear to provide a good description of the associations between the responses to the four anesthetics.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-Inference_for_Means_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation</strong>: The boxplots indicate that variation in times between heartbeats across the 19 dogs appear to be about the same for all for anesthetics. The distributions are roughly symmetric for all four anesthetics, but the distribution of times between heartbeats may be skewed left when the high level of CO2 is used without halothane. The boxplots also indicate the mean times between heartbeats tend to be higher when halothane is used, regardless of the level of CO2, so halothane may slow heart rates in dogs. There does not appear to be much difference in the distributions of times between heartbeats for low and high levels of CO2 when halothane is used. There is also not much difference between the distributions of times between heartbeats for the high and low levels of CO2 when halothane is not used, although times between heartbeats tend to be lower when the high level of CO2 is used. The higher level of CO2 may speed up heart rates in dogs, but the Halothane effect appears to have a much larger than the CO2 effect.</p>
</div>
</div>
</div>
<section id="repeated-measures" class="level3" data-number="7.1">
<h3 data-number="7.1" class="anchored" data-anchor-id="repeated-measures"><span class="header-section-number">7.1</span> Repeated Measures</h3>
<p>A <strong>repeated measures</strong> study is a research design where the same participants are measured multiple times under different conditions or over a period of time</p>
<p><strong>Key characteristics</strong></p>
<ul>
<li>Same participants across conditions or time points</li>
<li>Measurements may be taken:
<ul>
<li>Across treatments (within-subjects design) – e.g., each participant tries all drug dosages.</li>
<li>Over time (longitudinal design) – e.g., measuring blood pressure weekly for 8 weeks.</li>
</ul></li>
<li>Correlation between measurements</li>
</ul>
<p><strong>Advantages</strong></p>
<ul>
<li>Controls for individual differences → reduces variability and increases statistical power.</li>
<li>Fewer participants needed compared to a between-subjects design for the same precision.</li>
<li>Ability to track changes within individuals over time or across conditions.</li>
</ul>
<p><strong>Common Examples</strong></p>
<ul>
<li><strong>Before-and-After Studies</strong>: This is the classic setup. You measure a group’s cholesterol levels (before), put them on a new diet for three months, and measure their levels again (after).</li>
<li><strong>Comparing Multiple Treatments</strong>: Each participant is given several different drugs (with a washout period in between), and their reaction to each drug is measured. The dog anesthetic example from our previous conversation is a perfect case of this.</li>
<li><strong>Longitudinal Studies</strong>: A researcher tracks the same group of children and measures their reading ability at ages 6, 8, and 10 to see how it develops over time.</li>
</ul>
<p><strong>Key Challenge: Dependent Data</strong></p>
<p>When the same subject is measured on <span class="math inline">p</span> different occasions or under <span class="math inline">p</span> different conditions, the measurements are <strong>not independent</strong>. A person’s score at time 1 is related to their score at time 2. Because of this dependency, we cannot directly apply previous methods on the data. However, we can still analyze this data by creating <strong>difference vectors</strong> and performing a one-sample Hotelling’s <span class="math inline">T^2</span> test on these differences.</p>
</section>
<section id="hotellings-t2-test-for-contrasts" class="level3" data-number="7.2">
<h3 data-number="7.2" class="anchored" data-anchor-id="hotellings-t2-test-for-contrasts"><span class="header-section-number">7.2</span> Hotelling’s <span class="math inline">T^2</span> Test for Contrasts</h3>
<div class="callout callout-style-default callout-tip callout-titled" title="Step 2: State Hypotheses">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-28-contents" aria-controls="callout-28" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Step 2: State Hypotheses
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-28" class="callout-28-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The research questions can be formulated as a hypothesis testing problem to test treatment effects simultaneously:</p>
<ol type="1">
<li>Halothane Effect: The overall effect of halothane, averaging across CO2 pressure levels: <span class="math inline">(\mu_3+\mu_4)/2 - (\mu_1+\mu_2)/2</span>.</li>
<li>CO2 Pressure Effect: The overall effect of CO2 pressure, averaging across halothane levels: <span class="math inline">(\mu_1+\mu_3)/2 - (\mu_2+\mu_4)/2</span></li>
<li>Interaction Effect: Whether the effect of CO2 pressure depends on the presence of halothane: <span class="math inline">(\mu_1-\mu_2)-(\mu_3-\mu_4)</span></li>
</ol>
<ul>
<li><strong>Null hypothesis</strong>: The no treatment effect can be written as testing <span class="math inline">H_0: C \boldsymbol \mu =\mathbf{0}</span> for a <span class="math inline">q\times p</span> <strong>contrast matrix</strong> <span class="math inline">C</span>.
<ul>
<li><span class="math inline">q</span> is the number of contrasts. In this example, <span class="math inline">q=3</span>.<br>
</li>
</ul></li>
<li><strong>Alternative hypothesis</strong>: <span class="math inline">H_1: C\boldsymbol \mu\neq \mathbf{0}</span></li>
</ul>
<p><strong>Question: How to write down the <em>contrast matrix</em> for the null hypothesis?</strong></p>
<ul>
<li><strong>Exercise</strong>: If one is interested in testing the hypothesis that all four treatments have the same mean, then <span class="math display">\begin{equation*}
C=
\left[\begin{array}{rrrr}
-1 &amp; 1 &amp; 0 &amp; 0 \\ 0 &amp; -1 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; -1 &amp; 1
\end{array}\right]
\end{equation*}</span></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Step 3: Define the Contrast Matrix">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-29-contents" aria-controls="callout-29" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Step 3: Define the Contrast Matrix
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-29" class="callout-29-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The contrast matrix defined by the null hypotheses above is given by<br>
<span class="math display">\begin{equation*}
C=
\begin{bmatrix}
-.5 &amp; -.5 &amp; .5 &amp; .5 \\
.5 &amp; -.5 &amp; .5 &amp; -.5 \\
1 &amp; -1 &amp; -1 &amp; 1
\end{bmatrix}
\end{equation*}</span> because<br>
<span class="math display">
\begin{bmatrix}
(\mu_3 + \mu_4)/2 - (\mu_1 + \mu_2)/2 \\
(\mu_1 + \mu_3)/2 - (\mu_2 + \mu_4)/2 \\
(\mu_1 - \mu_2) - (\mu_3-\mu_4)
\end{bmatrix}
=
\begin{bmatrix}
-.5 &amp; -.5 &amp; .5 &amp; .5 \\
.5 &amp; -.5 &amp; .5 &amp; -.5 \\
1 &amp; -1 &amp; -1 &amp; 1
\end{bmatrix}
\begin{bmatrix}
\mu_1 \\
\mu_2 \\
\mu_3 \\
\mu_4 \end{bmatrix}
= {C} \boldsymbol{\mu}
</span></p>
<ul>
<li>It is important to note that <span class="math inline">C</span> has dimension <span class="math inline">q\times p</span>, where <span class="math inline">q=p-1</span> is the number of contrasts.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>C<span class="ot">&lt;-</span><span class="fu">matrix</span>( <span class="fu">c</span>(.<span class="dv">5</span>, <span class="sc">-</span>.<span class="dv">5</span>, .<span class="dv">5</span>, <span class="sc">-</span>.<span class="dv">5</span>, <span class="sc">-</span>.<span class="dv">5</span>, <span class="sc">-</span>.<span class="dv">5</span>, .<span class="dv">5</span>, .<span class="dv">5</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>), </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol=</span><span class="dv">4</span>, <span class="at">byrow=</span>T)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>C</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]  0.5 -0.5  0.5 -0.5
[2,] -0.5 -0.5  0.5  0.5
[3,] -1.0  1.0  1.0 -1.0</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Step 4: Transform the Data Using the Contrast Matrix">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-30-contents" aria-controls="callout-30" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Step 4: Transform the Data Using the Contrast Matrix
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-30" class="callout-30-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>For each dog, apply the contrasts defined in matrix C to their four measurements. This converts the original 4 variables into 3 new contrast variables, which will be the subject of our test.</p>
<p>We use matrix multiplication to transform our <span class="math inline">19
\times 4</span> data matrix into a <span class="math inline">19
\times 3</span> matrix of contrast scores. The formula is <span class="math inline">Y = X  C^\top</span>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform the original data into contrast data</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span>  X <span class="sc">%*%</span> <span class="fu">t</span>(C)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename columns for clarity</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Y) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Halothane_Effect"</span>, <span class="st">"CO2_Effect"</span>, <span class="st">"Interaction_Effect"</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     Halothane_Effect CO2_Effect Interaction_Effect
[1,]           -113.5       60.5                139
[2,]              7.0      149.0                -20
[3,]            -41.0      -43.0                 66
[4,]            -38.5      129.5                -79
[5,]            -10.5       97.5                 21
[6,]            -73.0      142.0                 82</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>GGally<span class="sc">::</span><span class="fu">ggpairs</span>(Y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-Inference_for_Means_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Step 5: Check Assumptions">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-31-contents" aria-controls="callout-31" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Step 5: Check Assumptions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-31" class="callout-31-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),<span class="at">pch=</span><span class="dv">1</span>)     </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqnorm</span>(Y[,i],  <span class="at">main=</span><span class="st">"Normal Q-Q Plot"</span>) </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqline</span>(Y[,i], <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(Y,<span class="dv">2</span>,shapiro.test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$Halothane_Effect

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.97195, p-value = 0.8146


$CO2_Effect

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.80247, p-value = 0.001242


$Interaction_Effect

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.96055, p-value = 0.5834</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>mvShapiroTest<span class="sc">::</span><span class="fu">mvShapiro.Test</span>(Y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Generalized Shapiro-Wilk test for Multivariate Normality by
    Villasenor-Alva and Gonzalez-Estrada

data:  Y
MVW = 0.92376, p-value = 0.05625</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-Inference_for_Means_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Conclusion</strong>: The contrast data indeed approximately follow a multivariate normal distribution as indicated by the multivariate Shapiro-Wilk test even though the original data do not follow a multivariate normal distribution.</p>
<p><strong>Note</strong>: In practice, if the multivariate normality assumption is violated based on the Shapiro-Wilk test, one needs to address this issue before applying the Hotelling’s <span class="math inline">T^2</span> test. Alternatively, one can use a <em>nonparametric method</em> (e.g., <em>Friedman</em> test).</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Step 6: Hotelling's $T^2$ Test">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-32-contents" aria-controls="callout-32" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Step 6: Hotelling’s <span class="math inline">T^2</span> Test
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-32" class="callout-32-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>To test <span class="math inline">H_0: C\boldsymbol \mu = 0</span>, we can again use <span class="math inline">T^2</span> statistic: <span class="math display">
T^2 = n(C\bar{\mathbf{x}} - \mathbf{0})^\top (CS^{-1}C^\top)^{-1} (C\bar{\mathbf{x}} - \mathbf{0})
</span></li>
<li>The null hypothesis is rejected at significance level <span class="math inline">\alpha</span> if <span class="math display">
T^2 \geq \frac{(n-1)(p-1)}{(n-p+1)} F_{p-1, n-p+1, 1-\alpha}
</span> where the numerator degrees of freedom are <span class="math inline">p-1</span> instead of <span class="math inline">p</span> because the null hypotheses puts only <span class="math inline">p-1</span> constraints on the mean responses.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the hypothesized mean vector (a zero vector)</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the one-sample test on the contrast data</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>test_result <span class="ot">=</span> DescTools<span class="sc">::</span><span class="fu">HotellingsT2Test</span>(Y, <span class="at">mu=</span>mu0)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(test_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Hotelling's one sample T2-test

data:  Y
T.2 = 34.375, df1 = 3, df2 = 16, p-value = 3.318e-07
alternative hypothesis: true location is not equal to c(0,0,0)</code></pre>
</div>
</div>
<p><strong>Conclusion</strong>: We clearly reject the null at significance level <span class="math inline">\alpha=0.05</span>, so the question now becomes whether there is a difference between CO2 pressure, between halothane levels or perhaps there is no main effect of treatment but there is still an interaction. <strong>This question can be answered by looking at confidence intervals</strong>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Paired $t$-Test">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-33-contents" aria-controls="callout-33" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Paired <span class="math inline">t</span>-Test
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-33" class="callout-33-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>A <strong>paired t-test</strong> is a special, simplified case of the Hotelling’s T² test on contrasts. The powerful, general framework of the F-test on contrasts simplifies to become the familiar paired t-test when you are making only one comparison between two measurements.</p>
<p><strong>The Paired t-Test: A Simple Contrast</strong></p>
<p>A paired t-test is designed to answer one question: “Is there a significant difference between two matched measurements (e.g., before vs.&nbsp;after)?”</p>
<ul>
<li><strong>The Data:</strong> You have two measurements for each subject, <span class="math inline">X_1</span> and <span class="math inline">X_2</span>.</li>
<li><strong>The Method:</strong> For each subject, you calculate a single <strong>difference score</strong>, <span class="math inline">d = X_1 - X_2</span>. You then perform a one-sample t-test on these difference scores to see if their mean is significantly different from 0.</li>
<li><strong>The null hypothesis:</strong> <span class="math inline">H_0: \mu_d = 0</span>, which is the same as <span class="math inline">H_0: \mu_1 - \mu_2 = 0</span>.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="confidence-regions-for-linear-combinations-of-means" class="level3" data-number="7.3">
<h3 data-number="7.3" class="anchored" data-anchor-id="confidence-regions-for-linear-combinations-of-means"><span class="header-section-number">7.3</span> Confidence Regions for Linear Combinations of Means</h3>
<p>A <span class="math inline">100(1-\alpha)\%</span> confidence region for any linear combination of population means, say <span class="math inline">C \boldsymbol{\mu}</span>, is the set of all vectors <span class="math inline">\boldsymbol \mu</span> satisfying: <span class="math display">
n(C\bar{\mathbf{x}} - C\boldsymbol{\mu})^\top (CSC^\top)^{-1} (C\bar{\mathbf{x}} - C\boldsymbol{\mu}) \le \frac{(p-1)(n-1)}{n-p+1} F_{p-1, n-p+1, 1-\alpha}
</span></p>
</section>
<section id="simultaneous-cis-for-linear-combinations-of-means" class="level3" data-number="7.4">
<h3 data-number="7.4" class="anchored" data-anchor-id="simultaneous-cis-for-linear-combinations-of-means"><span class="header-section-number">7.4</span> Simultaneous CIs for Linear Combinations of Means</h3>
<p>After performing a multivariate test, we are often interested in more complex comparisons than just single means. We might want to test a <strong>linear combination</strong> of the population means, which takes the general form:</p>
<p><span class="math display"> \mathbf{c}'\boldsymbol{\mu} = c_1\mu_1 + c_2\mu_2 + \dots + c_p\mu_p </span></p>
<p>We can construct simultaneous confidence intervals for a set of <code>m</code> such combinations, where the <code>k</code>-th combination is defined by the coefficient vector <span class="math inline">\mathbf{c}_k = [c_{k1}, c_{k2}, \dots, c_{kp}]'</span>.</p>
<p>The point estimate for any linear combination <span class="math inline">\mathbf{c}_k'\boldsymbol{\mu}</span> is given by <span class="math inline">\mathbf{c}_k'\bar{\mathbf{x}} = \sum_{j=1}^p c_{jk} \mu_j</span>, and the estimated variance is <span class="math inline">\frac{\mathbf{c}_k'{S}\mathbf{c}_k}{n}</span>. The margin of error is then determined by one of the following methods.</p>
<div class="callout callout-style-default callout-note callout-titled" title="$T^2$ CI">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="math inline">T^2</span> CI
</div>
</div>
<div class="callout-body-container callout-body">
<p>This method derives its critical value from the F-distribution associated with Hotelling’s <span class="math inline">T^2</span> test. The confidence intervals are valid simultaneously for <em>any and all</em> possible linear combinations.</p>
<p>A <span class="math inline">100(1-\alpha)\%</span> simultaneous confidence intervals are given by:</p>
<p><span class="math display">
\mathbf{c}_k'\bar{\mathbf{x}} \pm \sqrt{\frac{(p-1)(n-1)}{n-p+1} F_{p-1, n-p+1, 1-\alpha}} \sqrt{\frac{\mathbf{c}_k'{S}\mathbf{c}_k}{n}} \quad \text{for } k=1, 2, \dots, m
</span></p>
<p>In the dog anesthetics study, the <span class="math inline">T^2</span> CIs can be computed as follows.</p>
<div class="cell">
<details class="code-fold">
<summary>R Code: T<span class="math inline">^2</span> CIs</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>ybar <span class="ot">=</span> <span class="fu">colMeans</span>(Y)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>Sy <span class="ot">=</span> <span class="fu">cov</span>(Y)  <span class="co"># this is the same as C%*%cov(X)%*%t(C) </span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>F_crit <span class="ot">=</span> <span class="fu">qf</span>(<span class="dv">1</span><span class="fl">-0.05</span>, p<span class="dv">-1</span>, n<span class="sc">-</span>p)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>cval_T2 <span class="ot">=</span> <span class="fu">sqrt</span>((p<span class="dv">-1</span>)<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>(n<span class="sc">-</span>p<span class="sc">+</span><span class="dv">1</span>) <span class="sc">*</span> F_crit) </span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>S_kk <span class="ot">=</span> <span class="fu">diag</span>(Sy)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>ci_T2 <span class="ot">=</span> <span class="fu">tibble</span>(</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Component =</span> <span class="fu">names</span>(ybar),</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> ybar,</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lower =</span> Estimate <span class="sc">-</span> cval_T2 <span class="sc">*</span> <span class="fu">sqrt</span>(S_kk<span class="sc">/</span>n), </span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Upper =</span> Estimate <span class="sc">+</span> cval_T2 <span class="sc">*</span> <span class="fu">sqrt</span>(S_kk<span class="sc">/</span>n)</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ci_T2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  Component          Estimate Lower  Upper
  &lt;chr&gt;                 &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 Halothane_Effect      -30.0 -53.2  -6.84
2 CO2_Effect            105.   73.4 136.  
3 Interaction_Effect     12.8 -43.1  68.7 </code></pre>
</div>
</div>
<p><strong>Interpretation</strong>:</p>
<ul>
<li>The <span class="math inline">T^2</span> CI for the Halothane effect is shifted below zero, indicating that the mean time between heartbeats is likely to be between -53.2 and -6.84 milliseconds shorter when Halothane is used than that when Halothane is not used, averaging across the CO2 pressure levels.</li>
<li>The <span class="math inline">T^2</span> CI for the CO2 effect is far above 0, indicating that the mean time between heartbeats is likely to be between 73.4 and 136 milliseconds longer at high CO2 pressure than that at low CO2 pressure, averaging across the halothane effect.<br>
</li>
<li>The <span class="math inline">T^2</span> CI for the interaction effect contains 0, indicating
<ul>
<li>the effect of using halothane on the mean time between heartbeats is about the same for the two levels of CO2 pressure;</li>
<li>the effect of changing from low to high pressure of CO2 is about the same when halothane is used as when halothane is not used.</li>
</ul></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Bonferroni CI">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Bonferroni CI
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <span class="math inline">100(1-\alpha)\%</span> simultaneous Bonferroni confidence intervals are given by:</p>
<p><span class="math display"> \mathbf{c}_k'\bar{\mathbf{x}} \pm t_{n-1, 1-\alpha/(2m)} \sqrt{\frac{\mathbf{c}_k'{S}\mathbf{c}_k}{n}} \quad \text{for } k=1, 2, \dots, m </span> * Note the critical value is a t-statistic adjusted by <code>m</code>, the number of intervals being constructed. * It also controls the familywise error rate at <span class="math inline">\alpha</span>.</p>
<p>In the dog anesthetics study, the Bonferroni CIs can be computed as follows.</p>
<div class="cell">
<details class="code-fold">
<summary>R Code: Bonferroni CIs</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">3</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>cval_Bon <span class="ot">=</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="fl">-0.05</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>m), n<span class="dv">-1</span>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>ci_Bon <span class="ot">=</span> <span class="fu">tibble</span>(</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Component =</span> <span class="fu">names</span>(ybar),</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> ybar,</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lower =</span> Estimate <span class="sc">-</span> cval_Bon <span class="sc">*</span> <span class="fu">sqrt</span>(S_kk<span class="sc">/</span>n), </span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Upper =</span> Estimate <span class="sc">+</span> cval_Bon <span class="sc">*</span> <span class="fu">sqrt</span>(S_kk<span class="sc">/</span>n)</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ci_Bon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  Component          Estimate Lower   Upper
  &lt;chr&gt;                 &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
1 Halothane_Effect      -30.0 -59.4  -0.686
2 CO2_Effect            105.   65.1 144.   
3 Interaction_Effect     12.8 -58.0  83.6  </code></pre>
</div>
</div>
<p><strong>Interpretation</strong>: While specific Bonferroni CI limits are slightly different than the limits of <span class="math inline">T^2</span> CIs, we can notice that same conclusions will be drawn for testing the Halothane effect, the CO2 effect and the interaction effect.</p>
</div>
</div>
</section>
</section>
<section id="exercises" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="exercises"><span class="header-section-number">8</span> Exercises</h2>
<section id="exercise-1-iris-data-contd" class="level3" data-number="8.1">
<h3 data-number="8.1" class="anchored" data-anchor-id="exercise-1-iris-data-contd"><span class="header-section-number">8.1</span> Exercise 1: <code>iris</code> Data, Cont’d</h3>
<p>Using the <code>iris</code> data, answer the following questions.</p>
<ol type="a">
<li>For the <code>versicolor</code> species, test if the mean vector for <code>Sepal.Length</code> and <code>Petal.Length</code> is equal to <span class="math inline">\boldsymbol{\mu}_0 = [6.0, 4.0]'</span>. Use <span class="math inline">\alpha=0.05</span>. If you reject the null hypothesis, construct 95% Bonferroni simultaneous CIs to determine which variable(s) differ from the hypothesized values.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="View Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-36-contents" aria-controls="callout-36" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-36" class="callout-36-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> iris[iris<span class="sc">$</span>Species <span class="sc">==</span> <span class="st">"versicolor"</span>, <span class="fu">c</span>(<span class="st">"Sepal.Length"</span>, <span class="st">"Petal.Length"</span>)]</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">6.0</span>, <span class="fl">4.0</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>ht <span class="ot">&lt;-</span> <span class="fu">HotellingsT2Test</span>(dat, <span class="at">mu =</span> mu0)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ht)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Hotelling's one sample T2-test

data:  dat
T.2 = 24.124, df1 = 2, df2 = 48, p-value = 5.602e-08
alternative hypothesis: true location is not equal to c(6,4)</code></pre>
</div>
</div>
<p><strong>Conclusion:</strong> The p-value is much less than 0.05. We reject <span class="math inline">H_0</span> at significance level <span class="math inline">\alpha=0.05</span> and conclude that the mean sepal length and the mean petal length is different from the the hypothesized values. To understand which variable would contribute to such difference, we look at the individual CIs below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Construct Bonferroni intervals since we rejected H0</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(dat)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(dat)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>xbar <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(dat)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">cov</span>(dat)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>s_ii <span class="ot">&lt;-</span> <span class="fu">diag</span>(S)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>cval_bon <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span> <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> p), <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>bonf_margins <span class="ot">&lt;-</span> cval_bon <span class="sc">*</span> <span class="fu">sqrt</span>(s_ii <span class="sc">/</span> n)</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>bonf_intervals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> <span class="fu">names</span>(dat),</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Hypothesized_Mean =</span> mu0,</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lower =</span> xbar <span class="sc">-</span> bonf_margins,</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Upper =</span> xbar <span class="sc">+</span> bonf_margins</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"95% Bonferroni Simultaneous CIs:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "95% Bonferroni Simultaneous CIs:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(bonf_intervals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 Variable Hypothesized_Mean    Lower    Upper
Sepal.Length Sepal.Length                 6 5.767202 6.104798
Petal.Length Petal.Length                 4 4.106330 4.413670</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong> The CI for Sepal.Length (5.77 to 6.10) contains the hypothesized mean of 6.0. However, the CI for Petal.Length (4.11 to 4.41) does NOT contain its hypothesized mean of 4.0. Therefore, we conclude the overall mean vector is different because the mean Petal Length is significantly greater than 4.0.</p>
</div>
</div>
</div>
<ol start="2" type="a">
<li>For the <code>setosa</code> species, construct simultaneous 95% confidence intervals for two linear combinations (<span class="math inline">m=2</span>):</li>
</ol>
<ul>
<li><strong>Difference:</strong> <span class="math inline">\mu_{Sepal.Length} - \mu_{Sepal.Width}</span></li>
<li><strong>Sum:</strong> <span class="math inline">\mu_{Sepal.Length} + \mu_{Sepal.Width}</span></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="View Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-37-contents" aria-controls="callout-37" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-37" class="callout-37-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>R Code: CI Calculation</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> iris <span class="sc">%&gt;%</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Species <span class="sc">==</span> <span class="st">"setosa"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Sepal.Length, Sepal.Width)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data)</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(data)</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>sample_mean <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(data)</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">cov</span>(data)</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the linear combinations (m=2)</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a><span class="co"># c1 will be for the Difference, c2 for the Sum</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>c1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>c2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine into a list for easy iteration</span></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>combinations <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Difference =</span> c1, <span class="at">Sum =</span> c2)</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">length</span>(combinations)</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate intervals for each method</span></span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>  c_k <span class="ot">&lt;-</span> combinations[[i]]</span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>  combo_name <span class="ot">&lt;-</span> <span class="fu">names</span>(combinations)[i]</span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a>  point_estimate <span class="ot">&lt;-</span> <span class="fu">t</span>(c_k) <span class="sc">%*%</span> sample_mean</span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>  std_error <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((<span class="fu">t</span>(c_k) <span class="sc">%*%</span> S <span class="sc">%*%</span> c_k) <span class="sc">/</span> n)</span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># T-squared Method</span></span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a>  T2_crit <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((p <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (n <span class="sc">-</span> p)) <span class="sc">*</span> <span class="fu">qf</span>(<span class="dv">1</span> <span class="sc">-</span> alpha, p, n <span class="sc">-</span> p))</span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a>  T2_margin <span class="ot">&lt;-</span> T2_crit <span class="sc">*</span> std_error</span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bonferroni Method (adjust alpha by m)</span></span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a>  Bonf_crit <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> m), <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a>  Bonf_margin <span class="ot">&lt;-</span> Bonf_crit <span class="sc">*</span> std_error</span>
<span id="cb72-37"><a href="#cb72-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-38"><a href="#cb72-38" aria-hidden="true" tabindex="-1"></a>  results[[i]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb72-39"><a href="#cb72-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">Combination =</span> combo_name,</span>
<span id="cb72-40"><a href="#cb72-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">T2_Lower =</span> point_estimate <span class="sc">-</span> T2_margin,</span>
<span id="cb72-41"><a href="#cb72-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">T2_Upper =</span> point_estimate <span class="sc">+</span> T2_margin,</span>
<span id="cb72-42"><a href="#cb72-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">Bonf_Lower =</span> point_estimate <span class="sc">-</span> Bonf_margin,</span>
<span id="cb72-43"><a href="#cb72-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">Bonf_Upper =</span> point_estimate <span class="sc">+</span> Bonf_margin</span>
<span id="cb72-44"><a href="#cb72-44" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb72-45"><a href="#cb72-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-46"><a href="#cb72-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-47"><a href="#cb72-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine and print the results</span></span>
<span id="cb72-48"><a href="#cb72-48" aria-hidden="true" tabindex="-1"></a>final_table <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, results)</span>
<span id="cb72-49"><a href="#cb72-49" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(final_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Combination T2_Lower T2_Upper Bonf_Lower Bonf_Upper
1  Difference 1.482838 1.673162   1.491785   1.664215
2         Sum 8.187499 8.680501   8.210674   8.657326</code></pre>
</div>
</div>
<p><strong>Interpretation:</strong> As shown in the table, the Bonferroni confidence intervals for both the “Difference” and the “Sum” are narrower than their T² counterparts, offering a more precise estimate for these specific comparisons.</p>
</div>
</div>
</div>
</section>
<section id="exercise-2-dogs-anesthetics-study-contd" class="level3" data-number="8.2">
<h3 data-number="8.2" class="anchored" data-anchor-id="exercise-2-dogs-anesthetics-study-contd"><span class="header-section-number">8.2</span> Exercise 2: Dogs Anesthetics Study, Cont’d</h3>
<p>In the Dogs Anesthetics study, we have tested the main effects and the interaction effect with the contrast matrix to test that all the three differences (the Halothane effect, the CO2 effect, and the interaction effect) in the mean responses have mean zero. This is equivalent to testing the null hypothesis that all four anesthetics induce the same mean times between heartbeats. In fact, this problem can be formulated by comparing any possible pair of mean difference with zero.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>dogdat <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"dogs.dat"</span>,</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">col.names=</span><span class="fu">c</span>(<span class="st">"dog"</span>, <span class="st">"HighCO2"</span>, <span class="st">"LowCO2"</span>, </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"HighCO2H"</span>, <span class="st">"LowCO2H"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"HighCO2"</span>, <span class="st">"LowCO2"</span>, </span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">"HighCO2H"</span>, <span class="st">"LowCO2H"</span>), as.numeric))</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dogdat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["dog"],"name":[1],"type":["int"],"align":["right"]},{"label":["HighCO2"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["LowCO2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["HighCO2H"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["LowCO2H"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"426","3":"609","4":"556","5":"600","_rn_":"1"},{"1":"2","2":"253","3":"236","4":"392","5":"395","_rn_":"2"},{"1":"3","2":"359","3":"433","4":"349","5":"357","_rn_":"3"},{"1":"4","2":"432","3":"431","4":"522","5":"600","_rn_":"4"},{"1":"5","2":"405","3":"426","4":"513","5":"513","_rn_":"5"},{"1":"6","2":"324","3":"438","4":"507","5":"539","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<ol type="1">
<li>In <a href="#sec-LinearCombinations" class="quarto-xref">Section&nbsp;7</a>, we have used contrasts to test the hypothesis. Please justify why the hypothesis formulated via contrast is equivalent to test if all four anesthetics treatments induce the same mean times between heartbeats.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="View Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-38-contents" aria-controls="callout-38" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-38" class="callout-38-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We will use the same notation as defined in <a href="#sec-LinearCombinations" class="quarto-xref">Section&nbsp;7</a>: <span class="math inline">\boldsymbol{\mu}=(\mu_1, \mu_2, \mu_3, \mu_4)^\top</span> represents the mean times between heartbeats under the four treatments: high CO2 pressure + no Halothane, low CO2 pressure + no Halothane, high CO2 pressure + Halothane, low CO2 pressure + Halothane.</p>
<p>From the null hypothesis in <a href="#sec-LinearCombinations" class="quarto-xref">Section&nbsp;7</a>, we have <span class="math display">
\begin{aligned}
\mu_3 + \mu_4 &amp;= \mu_1 + \mu_2, \\
\mu_1 + \mu_3 &amp;= \mu_2 + \mu_4,\\
\mu_1 - \mu_2 &amp;=\mu_3 - \mu_4.
\end{aligned}
</span> Thus, after some algebra, we obtain that the above is true if and only if <span class="math inline">\mu_1=\mu_2=\mu_3=\mu_4</span>.</p>
<p>Moreover, this constraint gives three independent/unique differences as other differences are just linear combinations of these three independent differences.</p>
<p>So, the null hypothesis in <a href="#sec-LinearCombinations" class="quarto-xref">Section&nbsp;7</a> is also equivalent to test if all the tree independent/unique differences are zero.</p>
</div>
</div>
</div>
<ol start="2" type="1">
<li>Write down the <strong>null hypothesis (<span class="math inline">H_0</span>)</strong> and the <strong>alternative hypothesis (<span class="math inline">H_1</span>)</strong> using population means only.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="View Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-39-contents" aria-controls="callout-39" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-39" class="callout-39-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p><strong>Null Hypothesis (<span class="math inline">H_0</span>)</strong>: The true mean times between heartbeats for each anesthetic is the same: <span class="math display">
H_0: \mu_1=\mu_2=\mu_3=\mu_4
</span></p></li>
<li><p><strong>Alternative Hypothesis (<span class="math inline">H_1</span>)</strong>: At least one mean is not the same as one of the other means.</p></li>
</ul>
</div>
</div>
</div>
<ol start="3" type="1">
<li>Use box plots to compare the distributions of the values for the differences in mean times between heartbeats.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="View Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-40-contents" aria-controls="callout-40" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-40" class="callout-40-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">=</span> dogdat</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>diff1 <span class="ot">&lt;-</span> dat<span class="sc">$</span>HighCO2<span class="sc">-</span>dat<span class="sc">$</span>LowCO2 </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>diff2 <span class="ot">&lt;-</span> dat<span class="sc">$</span>HighCO2H<span class="sc">-</span>dat<span class="sc">$</span>LowCO2</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>diff3 <span class="ot">&lt;-</span> dat<span class="sc">$</span>LowCO2H<span class="sc">-</span>dat<span class="sc">$</span>LowCO2</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["dog"],"name":[1],"type":["int"],"align":["right"]},{"label":["HighCO2"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["LowCO2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["HighCO2H"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["LowCO2H"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["diff1"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["diff2"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["diff3"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"426","3":"609","4":"556","5":"600","6":"-183","7":"-53","8":"-9","_rn_":"1"},{"1":"2","2":"253","3":"236","4":"392","5":"395","6":"17","7":"156","8":"159","_rn_":"2"},{"1":"3","2":"359","3":"433","4":"349","5":"357","6":"-74","7":"-84","8":"-76","_rn_":"3"},{"1":"4","2":"432","3":"431","4":"522","5":"600","6":"1","7":"91","8":"169","_rn_":"4"},{"1":"5","2":"405","3":"426","4":"513","5":"513","6":"-21","7":"87","8":"87","_rn_":"5"},{"1":"6","2":"324","3":"438","4":"507","5":"539","6":"-114","7":"69","8":"101","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(dat[, <span class="dv">6</span><span class="sc">:</span><span class="dv">8</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-Inference_for_Means_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<ol start="4" type="1">
<li>Check Assumptions.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="View Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-41-contents" aria-controls="callout-41" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-41" class="callout-41-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),<span class="at">pch=</span><span class="dv">1</span>)     </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">6</span><span class="sc">:</span><span class="dv">8</span>){</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqnorm</span>(dat[,i],  <span class="at">main=</span><span class="st">"Normal Q-Q Plot"</span>) </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqline</span>(dat[,i], <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(dat[,<span class="dv">6</span><span class="sc">:</span><span class="dv">8</span>],<span class="dv">2</span>,shapiro.test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$diff1

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.8493, p-value = 0.006534


$diff2

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.90513, p-value = 0.06029


$diff3

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.8558, p-value = 0.008349</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>mvShapiroTest<span class="sc">::</span><span class="fu">mvShapiro.Test</span>(<span class="fu">as.matrix</span>(dat[,<span class="dv">6</span><span class="sc">:</span><span class="dv">8</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Generalized Shapiro-Wilk test for Multivariate Normality by
    Villasenor-Alva and Gonzalez-Estrada

data:  as.matrix(dat[, 6:8])
MVW = 0.88078, p-value = 0.001033</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-Inference_for_Means_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Because the p-value is quite small (0.001033) the Shapiro-Wilk test for multivariate normality rejects the null hypothesis that the joint distribution of the three differences is multivariate normal distribution.</li>
<li>The Shapiro-Wilk tests for univariate normality indicate that the distributions of the first and third sets of differences are not normal distributions. The normal Q-Q plots indicate that those distributions are skewed to the left.</li>
</ul>
</div>
</div>
</div>
<ol start="5" type="1">
<li>Perform the Hotelling <span class="math inline">T^2</span> test for the null hypothesis.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="View Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-42-contents" aria-controls="callout-42" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-42" class="callout-42-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">HotellingsT2Test</span>(dat[,<span class="dv">6</span><span class="sc">:</span><span class="dv">8</span>], <span class="at">mu=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Hotelling's one sample T2-test

data:  dat[, 6:8]
T.2 = 34.375, df1 = 3, df2 = 16, p-value = 3.318e-07
alternative hypothesis: true location is not equal to c(0,0,0)</code></pre>
</div>
</div>
</div>
</div>
</div>
<ol start="6" type="1">
<li>To examine which mean is significant, we can investigate the simultaneous 95% confidence intervals for all six possible pairs of population mean differences: <span class="math inline">\mu_1-\mu_2, \mu_1-\mu_3,\mu_1-\mu_4, \mu_2-\mu_3, \mu_2-\mu_4, \mu_3-\mu_4</span>.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled" title="View Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-43-contents" aria-controls="callout-43" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-43" class="callout-43-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>TB.conf.int <span class="ot">&lt;-</span> <span class="cf">function</span>(X, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>{ </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert X to a matrix, if it is not a matrix already, from</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># vectors or data frames.</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(X)</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set n to the number of observations, p to the number of variables.</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X)</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(X)</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Stop if arguments are invalid.</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(X))</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Data must be numeric"</span>)</span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (n <span class="sc">&lt;</span> p)</span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Must have at least as many observations as variables"</span>)</span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(level) <span class="sc">||</span> <span class="fu">length</span>(level) <span class="sc">!=</span> <span class="dv">1</span> <span class="sc">||</span> level <span class="sc">&lt;=</span> <span class="dv">0</span> <span class="sc">||</span> level <span class="sc">&gt;=</span> <span class="dv">1</span>)</span>
<span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb85-24"><a href="#cb85-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Confidence level must be between 0 and 1"</span>)</span>
<span id="cb85-25"><a href="#cb85-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb85-26"><a href="#cb85-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-27"><a href="#cb85-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a matrix A in which each column represents</span></span>
<span id="cb85-28"><a href="#cb85-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># a difference between two pairs of means</span></span>
<span id="cb85-29"><a href="#cb85-29" aria-hidden="true" tabindex="-1"></a>  np <span class="ot">&lt;-</span> p <span class="sc">*</span> (p <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb85-30"><a href="#cb85-30" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>), <span class="at">ncol =</span> np, <span class="at">nrow =</span> p)</span>
<span id="cb85-31"><a href="#cb85-31" aria-hidden="true" tabindex="-1"></a>  nc <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb85-32"><a href="#cb85-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(p <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb85-33"><a href="#cb85-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(p <span class="sc">-</span> i)) {</span>
<span id="cb85-34"><a href="#cb85-34" aria-hidden="true" tabindex="-1"></a>      A[i, nc <span class="sc">+</span> j] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb85-35"><a href="#cb85-35" aria-hidden="true" tabindex="-1"></a>      A[i <span class="sc">+</span> j, nc <span class="sc">+</span> j] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb85-36"><a href="#cb85-36" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb85-37"><a href="#cb85-37" aria-hidden="true" tabindex="-1"></a>    nc <span class="ot">&lt;-</span> nc <span class="sc">+</span> (p <span class="sc">-</span> i)</span>
<span id="cb85-38"><a href="#cb85-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb85-39"><a href="#cb85-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-40"><a href="#cb85-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a matrix that will hold the confidence intervals.</span></span>
<span id="cb85-41"><a href="#cb85-41" aria-hidden="true" tabindex="-1"></a>  CI <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">2</span>, <span class="fu">ncol</span>(A))</span>
<span id="cb85-42"><a href="#cb85-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(CI) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"lower"</span>, <span class="st">"upper"</span>)</span>
<span id="cb85-43"><a href="#cb85-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(CI) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(A)</span>
<span id="cb85-44"><a href="#cb85-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-45"><a href="#cb85-45" aria-hidden="true" tabindex="-1"></a>  CIB <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">2</span>, <span class="fu">ncol</span>(A))</span>
<span id="cb85-46"><a href="#cb85-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(CIB) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"lower"</span>, <span class="st">"upper"</span>)</span>
<span id="cb85-47"><a href="#cb85-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(CIB) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(A)</span>
<span id="cb85-48"><a href="#cb85-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-49"><a href="#cb85-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find F distribution quantile for T-squared confidence intervals.</span></span>
<span id="cb85-50"><a href="#cb85-50" aria-hidden="true" tabindex="-1"></a>  F <span class="ot">&lt;-</span> <span class="fu">qf</span>(level, p, n <span class="sc">-</span> p)</span>
<span id="cb85-51"><a href="#cb85-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-52"><a href="#cb85-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find t distribution percentile for Bonferroni confidence intervals</span></span>
<span id="cb85-53"><a href="#cb85-53" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> level) <span class="sc">/</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">ncol</span>(A)</span>
<span id="cb85-54"><a href="#cb85-54" aria-hidden="true" tabindex="-1"></a>  levelB <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> alpha</span>
<span id="cb85-55"><a href="#cb85-55" aria-hidden="true" tabindex="-1"></a>  tB <span class="ot">&lt;-</span> <span class="fu">qt</span>(levelB, n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb85-56"><a href="#cb85-56" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> level) <span class="sc">/</span> <span class="dv">2</span>, n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb85-57"><a href="#cb85-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-58"><a href="#cb85-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute the sample covariance matrix of the original variables.</span></span>
<span id="cb85-59"><a href="#cb85-59" aria-hidden="true" tabindex="-1"></a>  C <span class="ot">&lt;-</span> <span class="fu">cov</span>(X)</span>
<span id="cb85-60"><a href="#cb85-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-61"><a href="#cb85-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find the confidence intervals for the specified linear combinations.</span></span>
<span id="cb85-62"><a href="#cb85-62" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(A))</span>
<span id="cb85-63"><a href="#cb85-63" aria-hidden="true" tabindex="-1"></a>  { </span>
<span id="cb85-64"><a href="#cb85-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find the sample mean and variance of this linear combination.</span></span>
<span id="cb85-65"><a href="#cb85-65" aria-hidden="true" tabindex="-1"></a>    m <span class="ot">&lt;-</span> <span class="fu">mean</span>(X <span class="sc">%*%</span> A[, i])</span>
<span id="cb85-66"><a href="#cb85-66" aria-hidden="true" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="fu">t</span>(A[, i]) <span class="sc">%*%</span> C <span class="sc">%*%</span> A[, i]</span>
<span id="cb85-67"><a href="#cb85-67" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb85-68"><a href="#cb85-68" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find the confidence interval for this difference.</span></span>
<span id="cb85-69"><a href="#cb85-69" aria-hidden="true" tabindex="-1"></a>    CI[<span class="dv">1</span>, i] <span class="ot">&lt;-</span> m <span class="sc">-</span> <span class="fu">sqrt</span>((p <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n <span class="sc">/</span> (n <span class="sc">-</span> p)) <span class="sc">*</span> F <span class="sc">*</span> v)</span>
<span id="cb85-70"><a href="#cb85-70" aria-hidden="true" tabindex="-1"></a>    CI[<span class="dv">2</span>, i] <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="fu">sqrt</span>((p <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n <span class="sc">/</span> (n <span class="sc">-</span> p)) <span class="sc">*</span> F <span class="sc">*</span> v)</span>
<span id="cb85-71"><a href="#cb85-71" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb85-72"><a href="#cb85-72" aria-hidden="true" tabindex="-1"></a>    CIB[<span class="dv">1</span>, i] <span class="ot">&lt;-</span> m <span class="sc">-</span> tB <span class="sc">*</span> <span class="fu">sqrt</span>(v <span class="sc">/</span> n)</span>
<span id="cb85-73"><a href="#cb85-73" aria-hidden="true" tabindex="-1"></a>    CIB[<span class="dv">2</span>, i] <span class="ot">&lt;-</span> m <span class="sc">+</span> tB <span class="sc">*</span> <span class="fu">sqrt</span>(v <span class="sc">/</span> n)</span>
<span id="cb85-74"><a href="#cb85-74" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb85-75"><a href="#cb85-75" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb85-76"><a href="#cb85-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-77"><a href="#cb85-77" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print the confidence intervals.</span></span>
<span id="cb85-78"><a href="#cb85-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">" T-squared CIs: </span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb85-79"><a href="#cb85-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(CI)</span>
<span id="cb85-80"><a href="#cb85-80" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-81"><a href="#cb85-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st"> Bonferroni CIs: </span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb85-82"><a href="#cb85-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(CIB)</span>
<span id="cb85-83"><a href="#cb85-83" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb85-84"><a href="#cb85-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-85"><a href="#cb85-85" aria-hidden="true" tabindex="-1"></a><span class="fu">TB.conf.int</span>(dat[, <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> T-squared CIs: 

           [,1]      [,2]       [,3]       [,4]       [,5]      [,6]
lower -89.46963 -165.0961 -183.66206 -131.61501 -158.56850 -69.54636
upper  16.62753  -57.0092  -85.70637  -17.64815  -37.95781  22.28320


 Bonferroni CIs: 

            [,1]       [,2]       [,3]       [,4]       [,5]      [,6]
lower -77.460347 -152.86156 -172.57431 -118.71494 -144.91641 -59.15204
upper   4.618242  -69.24371  -96.79411  -30.54822  -51.60991  11.88889</code></pre>
</div>
</div>
<p><strong>Interpretation</strong></p>
<ul>
<li><p>Both the <span class="math inline">T^2</span> CIs and Bonferroni CIs yields the same conclusions as whenever one interval contains zero, the other also contains zero; and whenever one interval excludes zero, the other also excludes zero.</p></li>
<li><p>The CIs for <span class="math inline">\mu_1-\mu_2</span> and <span class="math inline">\mu_3-\mu_4</span> contains zeros, indicating</p>
<ul>
<li>that there is no significant difference in mean times between heartbeats for using high or low CO2 pressure regardless of whether halothane is used or not;</li>
<li>and that there appears to be no significant effect of high or low pressure of CO2 on mean heart rates, after controlling for the presence or absence of halothane.<br>
</li>
</ul></li>
<li><p>All of the other confidence intervals do not contain zero indicating that mean heart rates tend to be slower (mean time between heartbeats is longer) when halothane is used than when halothane is not used, regardless of the CO2 pressure level.</p></li>
<li><p>Both sets of intervals provide at least 95% simultaneous coverage of the six differences in population means for difference between heartbeats, but the Bonferroni intervals are shorter than the T-squared intervals.</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="exercise-3-baseball-player-data" class="level3" data-number="8.3">
<h3 data-number="8.3" class="anchored" data-anchor-id="exercise-3-baseball-player-data"><span class="header-section-number">8.3</span> Exercise 3: Baseball Player Data</h3>
<p><strong>Background</strong></p>
<p>A sports science journal from the 1950s established a “classic” physical standard for professional baseball players, claiming the ideal physique had a mean height of <strong>72.5 inches</strong> and a mean weight of <strong>209 pounds</strong>. The data is from the <code>Lahman::People</code> dataset.</p>
<p>Your task is to determine if the average physique of modern players has significantly changed from this historical benchmark using a Hotelling’s T² test with a significance level of <span class="math inline">\alpha = 0.05</span>. In the analysis, we assume that the random vector follows a multivariate distribution and carry out the analysis, although it actually fails the multivariate Shapiro-Wilk test.</p>
<p><strong>1. State the Hypotheses</strong></p>
<p>Write the <strong>null hypothesis (<span class="math inline">H_0</span>)</strong> and the <strong>alternative hypothesis (<span class="math inline">H_1</span>)</strong> for this test using proper mathematical notation. Let <span class="math inline">\boldsymbol{\mu}</span> represent the true mean vector of <code>[height, weight]</code> for modern players.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="View Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-44-contents" aria-controls="callout-44" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-44" class="callout-44-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The hypotheses are formulated as:</p>
<ul>
<li><p><strong>Null Hypothesis (<span class="math inline">H_0</span>)</strong>: The true mean vector of modern players is equal to the historical standard. <span class="math display">H_0: \boldsymbol{\mu} = \begin{bmatrix} 72.5 \\ 209 \end{bmatrix}</span></p></li>
<li><p><strong>Alternative Hypothesis (<span class="math inline">H_1</span>)</strong>: The true mean vector of modern players is not equal to the historical standard. <span class="math display">H_1: \boldsymbol{\mu} \neq \begin{bmatrix} 72.5 \\ 209 \end{bmatrix}</span></p></li>
</ul>
</div>
</div>
</div>
<p><strong>2. Prepare the Data</strong></p>
<p>Load the necessary R packages. From the <code>Lahman::People</code> dataset, create a final data frame that contains only the <code>height</code> and <code>weight</code> columns for players who debuted in the year 2010 or later, with any missing values removed.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="View Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-45-contents" aria-controls="callout-45" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-45" class="callout-45-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Lahman)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the final data frame for analysis</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>player_data <span class="ot">&lt;-</span> Lahman<span class="sc">::</span>People <span class="sc">%&gt;%</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(debut<span class="sc">&gt;</span><span class="dv">2010</span>) <span class="sc">%&gt;%</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(height) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(weight)) <span class="sc">%&gt;%</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(height, weight)<span class="sc">%&gt;%</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(height, weight), as.numeric))</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> player_data</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">nrow</span>(df)</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">ncol</span>(df)</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["height"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["weight"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"74","2":"235","_rn_":"1"},{"1":"74","2":"220","_rn_":"2"},{"1":"74","2":"185","_rn_":"3"},{"1":"74","2":"190","_rn_":"4"},{"1":"73","2":"225","_rn_":"5"},{"1":"75","2":"235","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>GGally<span class="sc">::</span><span class="fu">ggpairs</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-Inference_for_Means_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p><strong>3. Check Key Assumptions</strong></p>
<p>Create and examine histograms for both the <code>height</code> and <code>weight</code> distributions in your sample. Do they appear approximately normal?</p>
<div class="callout callout-style-default callout-tip callout-titled" title="View Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-46-contents" aria-controls="callout-46" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-46" class="callout-46-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>R Code: Normality Check</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Q-Q plot</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through the column names and create a plot for each</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col_name <span class="cf">in</span> <span class="fu">colnames</span>(df)) {</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqnorm</span>(df[[col_name]], <span class="at">main =</span> col_name)</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqline</span>(df[[col_name]], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute Shapiro-Wilk statistic to test normality for each variable</span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(<span class="fu">colnames</span>(df), <span class="cf">function</span>(x) {</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>               <span class="fu">shapiro.test</span>(df[[x]]) } )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          height                        weight                       
statistic 0.9834675                     0.9929459                    
p.value   1.309451e-19                  6.188722e-12                 
method    "Shapiro-Wilk normality test" "Shapiro-Wilk normality test"
data.name "df[[x]]"                     "df[[x]]"                    </code></pre>
</div>
<details class="code-fold">
<summary>R Code: Normality Check</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Perform multivariate normality test</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>mvShapiroTest<span class="sc">::</span><span class="fu">mvShapiro.Test</span>(<span class="fu">as.matrix</span>(df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Generalized Shapiro-Wilk test for Multivariate Normality by
    Villasenor-Alva and Gonzalez-Estrada

data:  as.matrix(df)
MVW = 0.99687, p-value = 1.045e-10</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-Inference_for_Means_files/figure-html/check-assumptions-callout-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation:</strong> Both distributions are mound-shaped and reasonably symmetric, supporting the assumption of approximate normality.</p>
</div>
</div>
</div>
<p><strong>4. Perform the Statistical Test</strong></p>
<p>Run a one-sample Hotelling’s <span class="math inline">T^2</span> test on your prepared data using the historical standard as your hypothesized mean vector.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="View Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-47-contents" aria-controls="callout-47" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-47" class="callout-47-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>R Code: Hotelling’s T<span class="math inline">^2</span> Test</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the hypothesized mean vector from the 1950s standard</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">72.5</span>, <span class="fl">209.0</span>)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the test</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>test_result <span class="ot">&lt;-</span> DescTools<span class="sc">::</span><span class="fu">HotellingsT2Test</span>(<span class="at">x =</span> df, <span class="at">mu =</span> mu0)</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(test_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Hotelling's one sample T2-test

data:  df
T.2 = 589.64, df1 = 2, df2 = 3432, p-value &lt; 2.2e-16
alternative hypothesis: true location is not equal to c(72.5,209)</code></pre>
</div>
</div>
</div>
</div>
</div>
<p><strong>5. Interpret the Results</strong></p>
<p>What is the p-value from your test? Based on this and <span class="math inline">\alpha = 0.05</span>, do you reject or fail to reject the null hypothesis? State your conclusion in the context of the problem.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="View Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-48-contents" aria-controls="callout-48" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-48" class="callout-48-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The p-value is exceptionally small and far below the significance level of <span class="math inline">\alpha = 0.05</span>.</p>
<p><strong>Conclusion:</strong> We <strong>strongly reject the null hypothesis</strong>. There is overwhelming statistical evidence to conclude that the average physique (the mean vector of height and weight) of modern baseball players is significantly different from the historical standard of 72 inches and 190 pounds.</p>
</div>
</div>
</div>
<p><strong>6. Draw Conclusions Based on Confidence Region</strong></p>
<p>Check if the hypothesized mean is in the 95% confidence ellipse. Explain how it supports your conclusion.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="View Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-49-contents" aria-controls="callout-49" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
View Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-49" class="callout-49-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>R Code: Visualization</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the mean of our modern player sample</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>xbar <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(df)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>S <span class="ot">=</span> <span class="fu">cov</span>(df)</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>T2 <span class="ot">=</span> n<span class="sc">*</span><span class="fu">t</span>(xbar <span class="sc">-</span> mu0) <span class="sc">%*%</span><span class="fu">solve</span>(S)<span class="sc">%*%</span>(xbar <span class="sc">-</span> mu0)</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>scaledT2 <span class="ot">=</span> (n<span class="sc">-</span>p)<span class="sc">/</span>(p<span class="sc">*</span>(n<span class="dv">-1</span>)) <span class="sc">*</span> T2 </span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate points for the 95% confidence ellipse</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>Fvalue <span class="ot">&lt;-</span> <span class="fu">qf</span>(<span class="dv">1</span> <span class="sc">-</span> alpha, p, n <span class="sc">-</span> p)</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"scaled T2 statistic is"</span>,scaledT2, <span class="st">", F critical value is"</span>, Fvalue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>scaled T2 statistic is 589.6427 , F critical value is 2.998349</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this is the covariance of xbar</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>Sigma_ell <span class="ot">&lt;-</span> S <span class="sc">/</span> n</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(Sigma_ell)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> eig<span class="sc">$</span>vectors <span class="sc">%*%</span> <span class="fu">diag</span>(<span class="fu">sqrt</span>(eig<span class="sc">$</span>values)) <span class="sc">*</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> p <span class="sc">/</span> (n <span class="sc">-</span> p) <span class="sc">*</span> Fvalue)</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span> <span class="sc">*</span> pi, <span class="at">length.out =</span> <span class="dv">400</span>)</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>pts <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">matrix</span>(xbar, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="fu">length</span>(theta)) <span class="sc">+</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>A <span class="sc">%*%</span> <span class="fu">rbind</span>(<span class="fu">cos</span>(theta), <span class="fu">sin</span>(theta)))</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>df_ell <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pts)</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_ell) <span class="ot">&lt;-</span> <span class="fu">names</span>(df)</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>center <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">height =</span> xbar[<span class="dv">1</span>], <span class="at">weight =</span> xbar[<span class="dv">2</span>])</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_path</span>(<span class="at">data =</span> df_ell, <span class="fu">aes</span>(height, weight)) <span class="sc">+</span></span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(</span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a><span class="at">data =</span> center,</span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a><span class="fu">aes</span>(height, weight),</span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a><span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a><span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb97-23"><a href="#cb97-23" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb97-24"><a href="#cb97-24" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Height Difference"</span>, <span class="at">y =</span> <span class="st">"Weight Difference"</span>)</span>
<span id="cb97-25"><a href="#cb97-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-26"><a href="#cb97-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04-Inference_for_Means_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation:</strong> This result confirms the test result. The historical standard is far outside the confidence ellipse (the 95% confidence region for the true mean of modern players), confirming that modern players are, on average, both taller and heavier. At this point we do not know which one contributes to the difference, which can be answered using simultaneous confidence intervals.</p>
<div class="cell">
<details class="code-fold">
<summary>Simultaneous T2 CIs</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>cval_T2 <span class="ot">=</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span>p<span class="sc">/</span>(n<span class="sc">-</span>p) <span class="sc">*</span> Fvalue) </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>se_ii <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(S)<span class="sc">/</span>n)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>ci_T2 <span class="ot">=</span> <span class="fu">tibble</span>(</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="at">Component =</span> <span class="fu">names</span>(df),</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="at">Estimate =</span> xbar,</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="at">Lower =</span> Estimate <span class="sc">-</span> cval_T2 <span class="sc">*</span> se_ii,</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="at">Upper =</span> Estimate <span class="sc">+</span> cval_T2 <span class="sc">*</span> se_ii</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ci_T2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  Component Estimate Lower Upper
  &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 height        73.7  73.6  73.8
2 weight       209.  208.  210. </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Simultaneous Bonferroni CIs</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>cval_Bon <span class="ot">=</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="fl">-0.05</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>m), n<span class="dv">-1</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>ci_Bon <span class="ot">=</span> <span class="fu">tibble</span>(</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="at">Component =</span> <span class="fu">names</span>(df),</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="at">Estimate =</span> xbar,</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="at">Lower =</span> Estimate <span class="sc">-</span> cval_Bon <span class="sc">*</span> se_ii,</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a><span class="at">Upper =</span> Estimate <span class="sc">+</span> cval_Bon <span class="sc">*</span> se_ii</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ci_Bon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  Component Estimate Lower Upper
  &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 height        73.7  73.6  73.8
2 weight       209.  208.  210. </code></pre>
</div>
</div>
<p>Based on simultaneous CIs (T2 or Bonferroni), the results indicates that there is a significantly individual difference in height and weight at <span class="math inline">\alpha=0.05</span>.</p>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>